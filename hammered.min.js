function contentLoaded(t,e){var r=!1,i=!0,n=t.document,o=n.documentElement,a=n.addEventListener?"addEventListener":"attachEvent",s=n.addEventListener?"removeEventListener":"detachEvent",h=n.addEventListener?"":"on",c=function(i){("readystatechange"!=i.type||"complete"==n.readyState)&&(("load"==i.type?t:n)[s](h+i.type,c,!1),!r&&(r=!0)&&e.call(t,i.type||i))},l=function(){try{o.doScroll("left")}catch(t){return setTimeout(l,50),void 0}c("poll")};if("complete"==n.readyState)e.call(t,"lazy");else{if(n.createEventObject&&o.doScroll){try{i=!t.frameElement}catch(u){}i&&l()}n[a](h+"DOMContentLoaded",c,!1),n[a](h+"readystatechange",c,!1),t[a](h+"load",c,!1)}}!function(t,e){"use strict";var r="",i="?",n="function",o="undefined",a="object",s="major",h="model",c="name",l="type",u="vendor",p="version",m="architecture",d="console",E="mobile",f="tablet",y={has:function(t,e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()}},g={rgx:function(){for(var t,r,i,s,h,c,l,u=0,p=arguments;u<p.length;u+=2){var m=p[u],d=p[u+1];if(typeof t===o){t={};for(s in d)h=d[s],typeof h===a?t[h[0]]=e:t[h]=e}for(r=i=0;r<m.length;r++)if(c=m[r].exec(this.getUA())){for(s=0;s<d.length;s++)l=c[++i],h=d[s],typeof h===a&&h.length>0?2==h.length?t[h[0]]=typeof h[1]==n?h[1].call(this,l):h[1]:3==h.length?t[h[0]]=typeof h[1]!==n||h[1].exec&&h[1].test?l?l.replace(h[1],h[2]):e:l?h[1].call(this,l,h[2]):e:4==h.length&&(t[h[0]]=l?h[3].call(this,l.replace(h[1],h[2])):e):t[h]=l?l:e;break}if(c)break}return t},str:function(t,r){for(var n in r)if(typeof r[n]===a&&r[n].length>0){for(var o=0;o<r[n].length;o++)if(y.has(r[n][o],t))return n===i?e:n}else if(y.has(r[n],t))return n===i?e:n;return t}},v={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},T={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[c,p,s],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[c,"Opera"],p,s],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[c,p,s],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[c,"IE"],p,s],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[c,"Yandex"],p,s],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[c,/_/g," "],p,s],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[c,p,s],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[c,"Dolphin"],p,s],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[c,"Chrome"],p,s],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[p,s,[c,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[p,s,c],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[c,[s,g.str,v.browser.oldsafari.major],[p,g.str,v.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[c,p,s],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[c,"Netscape"],p,s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[c,p,s]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/(ia64(?=;)|68k(?=\))|arm(?=v\d+;)|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[m,y.lowerize]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[h,u,[l,f]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,h,[l,f]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[h,u,[l,E]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,h,[l,E]],[/\((bb10);\s(\w+)/i],[[u,"BlackBerry"],h,[l,E]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i],[[u,"Asus"],h,[l,f]],[/(sony)\s(tablet\s[ps])/i],[u,h,[l,f]],[/(nintendo)\s([wids3u]+)/i],[u,h,[l,d]],[/((playstation)\s[3portablevi]+)/i],[[u,"Sony"],h,[l,d]],[/(sprint\s(\w+))/i],[[u,g.str,v.device.sprint.vendor],[h,g.str,v.device.sprint.model],[l,E]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[h,/_/g," "],[l,E]],[/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i,/(mot)[\s-]?(\w+)*/i],[[u,"Motorola"],h,[l,E]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[[u,"Motorola"],h,[l,f]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i],[[u,"Samsung"],h,[l,f]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],h,[l,E]],[/(sie)-(\w+)*/i],[[u,"Siemens"],h,[l,E]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],h,[l,E]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[[u,"Acer"],h,[l,f]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],h,[l,f]],[/((nexus\s4))/i,/((nexus\s5))/i,/(lg)[e;\s-\/]+(\w+)*/i],[[u,"LG"],h,[l,E]],[/(mobile|tablet);.+rv\:.+gecko\//i],[l,u,h]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,p],[/rv\:([\w\.]+).*(gecko)/i],[p,c]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[p,g.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[p,g.str,v.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[c,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[c,"Symbian"],p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],p],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[c,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],p],[/(sunos)\s?([\w\.]+\d)*/i],[[c,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[c,p],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[c,"iOS"],[p,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[c,[p,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[c,p]]},x=function(i){var n=i||(t&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:r);return this instanceof x?(this.getBrowser=function(){return g.rgx.apply(this,T.browser)},this.getCPU=function(){return g.rgx.apply(this,T.cpu)},this.getDevice=function(){return g.rgx.apply(this,T.device)},this.getEngine=function(){return g.rgx.apply(this,T.engine)},this.getOS=function(){return g.rgx.apply(this,T.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(t){return n=t,this},this.setUA(n),e):new x(i).getResult()};if(typeof exports!==o)typeof module!==o&&module.exports&&(exports=module.exports=x),exports.UAParser=x;else if(t.UAParser=x,typeof define===n&&define.amd&&define(function(){return x}),typeof t.jQuery!==o){var R=t.jQuery,w=new x;R.ua=w.getResult(),R.ua.get=function(){return w.getUA()},R.ua.set=function(t){w.setUA(t);var e=w.getResult();for(var r in e)R.ua[r]=e[r]}}}(this);var performanceProfile={cubeLength:300,cubeY:150,canvasWidth:300,cameraZ:400,cameraY:150,textureMappingQuality:4},parser=new UAParser,ua=parser.getResult();window.Typed32Array||(!function(t){"use strict";function e(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return null===t?"null":"object"}}function r(t){return Object.prototype.toString.call(t).replace(/^\[object *|\]$/g,"")}function i(t){return"function"==typeof t}function n(t){if(null===t||t===z)throw TypeError();return Object(t)}function o(t){return t>>0}function a(t){return t>>>0}function s(t){function e(e){Object.defineProperty(t,e,{get:function(){return t._getter(e)},set:function(r){t._setter(e,r)},enumerable:!0,configurable:!1})}if(t.length>V)throw RangeError("Array too large for polyfill");var r;for(r=0;r<t.length;r+=1)e(r)}function h(t,e){var r=32-e;return t<<r>>r}function c(t,e){var r=32-e;return t<<r>>>r}function l(t){return[255&t]}function u(t){return h(t[0],8)}function p(t){return[255&t]}function m(t){return c(t[0],8)}function d(t){return t=F(Number(t)),[0>t?0:t>255?255:255&t]}function E(t){return[255&t>>8,255&t]}function f(t){return h(t[0]<<8|t[1],16)}function y(t){return[255&t>>8,255&t]}function g(t){return c(t[0]<<8|t[1],16)}function v(t){return[255&t>>24,255&t>>16,255&t>>8,255&t]}function T(t){return h(t[0]<<24|t[1]<<16|t[2]<<8|t[3],32)}function x(t){return[255&t>>24,255&t>>16,255&t>>8,255&t]}function R(t){return c(t[0]<<24|t[1]<<16|t[2]<<8|t[3],32)}function w(t,e,r){function i(t){var e=P(t),r=t-e;return.5>r?e:r>.5?e+1:e%2?e+1:e}var n,o,a,s,h,c,l,u=(1<<e-1)-1;for(t!==t?(o=(1<<e)-1,a=D(2,r-1),n=0):1/0===t||t===-1/0?(o=(1<<e)-1,a=0,n=0>t?1:0):0===t?(o=0,a=0,n=1/t===-1/0?1:0):(n=0>t,t=C(t),t<D(2,1-u)?(o=0,a=i(t/D(2,1-u-r))):(o=j(P(A(t)/O),1023),a=i(t/D(2,o)*D(2,r)),a/D(2,r)<2||(o+=1,a=1),o>u?(o=(1<<e)-1,a=0):(o+=u,a-=D(2,r)))),h=[],s=r;s;s-=1)h.push(a%2?1:0),a=P(a/2);for(s=e;s;s-=1)h.push(o%2?1:0),o=P(o/2);for(h.push(n?1:0),h.reverse(),c=h.join(""),l=[];c.length;)l.push(parseInt(c.substring(0,8),2)),c=c.substring(8);return l}function H(t,e,r){var i,n,o,a,s,h,c,l,u=[];for(i=t.length;i;i-=1)for(o=t[i-1],n=8;n;n-=1)u.push(o%2?1:0),o>>=1;return u.reverse(),a=u.join(""),s=(1<<e-1)-1,h=parseInt(a.substring(0,1),2)?-1:1,c=parseInt(a.substring(1,1+e),2),l=parseInt(a.substring(1+e),2),c===(1<<e)-1?0!==l?0/0:1/0*h:c>0?h*D(2,c-s)*(1+l/D(2,r)):0!==l?h*D(2,-(s-1))*(l/D(2,r)):0>h?-0:0}function b(t){return H(t,11,52)}function M(t){return w(t,11,52)}function _(t){return H(t,8,23)}function S(t){return w(t,8,23)}var z=void 0,V=1e5,O=Math.LN2,C=Math.abs,P=Math.floor,A=Math.log,L=Math.max,j=Math.min,D=Math.pow,F=Math.round;!function(){var t=Object.defineProperty,e=!function(){try{return Object.defineProperty({},"x",{})}catch(t){return!1}}();(!t||e)&&(Object.defineProperty=function(e,r,i){if(t)try{return t(e,r,i)}catch(n){}if(e!==Object(e))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in i&&Object.prototype.__defineGetter__.call(e,r,i.get),Object.prototype.__defineSetter__&&"set"in i&&Object.prototype.__defineSetter__.call(e,r,i.set),"value"in i&&(e[r]=i.value),e})}(),function(){function h(t){if(t=o(t),0>t)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:t}),Object.defineProperty(this,"_bytes",{value:Array(t)});for(var e=0;t>e;e+=1)this._bytes[e]=0}function c(){if(!arguments.length||"object"!=typeof arguments[0])return function(t){if(t=o(t),0>t)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:t}),Object.defineProperty(this,"byteLength",{value:t*this.BYTES_PER_ELEMENT}),Object.defineProperty(this,"buffer",{value:new h(this.byteLength)}),Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(arguments.length>=1&&"object"===e(arguments[0])&&arguments[0]instanceof c)return function(t){if(this.constructor!==t.constructor)throw TypeError();var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new h(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var r=0;r<this.length;r+=1)this._setter(r,t._getter(r))}.apply(this,arguments);if(!(arguments.length<1||"object"!==e(arguments[0])||arguments[0]instanceof c||arguments[0]instanceof h||"ArrayBuffer"===r(arguments[0])))return function(t){var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new h(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var r=0;r<this.length;r+=1){var i=t[r];this._setter(r,Number(i))}}.apply(this,arguments);if(arguments.length>=1&&"object"===e(arguments[0])&&(arguments[0]instanceof h||"ArrayBuffer"===r(arguments[0])))return function(t,e,r){if(e=a(e),e>t.byteLength)throw RangeError("byteOffset out of range");if(e%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(r===z){var i=t.byteLength-e;if(i%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");r=i/this.BYTES_PER_ELEMENT}else r=a(r),i=r*this.BYTES_PER_ELEMENT;if(e+i>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:i}),Object.defineProperty(this,"byteOffset",{value:e}),Object.defineProperty(this,"length",{value:r})}.apply(this,arguments);throw TypeError()}function w(t,e,r){var i=function(){Object.defineProperty(this,"constructor",{value:i}),c.apply(this,arguments),s(this)};"__proto__"in i?i.__proto__=c:(i.from=c.from,i.of=c.of),i.BYTES_PER_ELEMENT=t;var n=function(){};return n.prototype=H,i.prototype=new n,Object.defineProperty(i.prototype,"BYTES_PER_ELEMENT",{value:t}),Object.defineProperty(i.prototype,"_pack",{value:e}),Object.defineProperty(i.prototype,"_unpack",{value:r}),i}t.ArrayBuffer=t.ArrayBuffer||h,Object.defineProperty(c,"from",{value:function(t){return new this(t)}}),Object.defineProperty(c,"of",{value:function(){return new this(arguments)}});var H={};c.prototype=H,Object.defineProperty(c.prototype,"_getter",{value:function(t){if(arguments.length<1)throw SyntaxError("Not enough arguments");if(t=a(t),t>=this.length)return z;var e,r,i=[];for(e=0,r=this.byteOffset+t*this.BYTES_PER_ELEMENT;e<this.BYTES_PER_ELEMENT;e+=1,r+=1)i.push(this.buffer._bytes[r]);return this._unpack(i)}}),Object.defineProperty(c.prototype,"get",{value:c.prototype._getter}),Object.defineProperty(c.prototype,"_setter",{value:function(t,e){if(arguments.length<2)throw SyntaxError("Not enough arguments");if(t=a(t),t<this.length){var r,i,n=this._pack(e);for(r=0,i=this.byteOffset+t*this.BYTES_PER_ELEMENT;r<this.BYTES_PER_ELEMENT;r+=1,i+=1)this.buffer._bytes[i]=n[r]}}}),Object.defineProperty(c.prototype,"constructor",{value:c}),Object.defineProperty(c.prototype,"copyWithin",{value:function(t,e){var r=arguments[2],i=n(this),s=i.length,h=a(s);h=L(h,0);var c,l=o(t);c=0>l?L(h+l,0):j(l,h);var u,p=o(e);u=0>p?L(h+p,0):j(p,h);var m;m=r===z?h:o(r);var d;d=0>m?L(h+m,0):j(m,h);var E,f=j(d-u,h-c);for(c>u&&u+f>c?(E=-1,u=u+f-1,c=c+f-1):E=1;f>0;)i._setter(c,i._getter(u)),u+=E,c+=E,f-=1;return i}}),Object.defineProperty(c.prototype,"every",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();for(var n=arguments[1],o=0;r>o;o++)if(!t.call(n,e._getter(o),o,e))return!1;return!0}}),Object.defineProperty(c.prototype,"fill",{value:function(t){var e=arguments[1],r=arguments[2],i=n(this),s=i.length,h=a(s);h=L(h,0);var c,l=o(e);c=0>l?L(h+l,0):j(l,h);var u;u=r===z?h:o(r);var p;for(p=0>u?L(h+u,0):j(u,h);p>c;)i._setter(c,t),c+=1;return i}}),Object.defineProperty(c.prototype,"filter",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();for(var n=[],o=arguments[1],s=0;r>s;s++){var h=e._getter(s);t.call(o,h,s,e)&&n.push(h)}return new this.constructor(n)}}),Object.defineProperty(c.prototype,"find",{value:function(t){var e=n(this),r=e.length,o=a(r);if(!i(t))throw TypeError();for(var s=arguments.length>1?arguments[1]:z,h=0;o>h;){var c=e._getter(h),l=t.call(s,c,h,e);if(Boolean(l))return c;++h}return z}}),Object.defineProperty(c.prototype,"findIndex",{value:function(t){var e=n(this),r=e.length,o=a(r);if(!i(t))throw TypeError();for(var s=arguments.length>1?arguments[1]:z,h=0;o>h;){var c=e._getter(h),l=t.call(s,c,h,e);if(Boolean(l))return h;++h}return-1}}),Object.defineProperty(c.prototype,"forEach",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();for(var n=arguments[1],o=0;r>o;o++)t.call(n,e._getter(o),o,e)}}),Object.defineProperty(c.prototype,"indexOf",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(0===r)return-1;var i=0;if(arguments.length>0&&(i=Number(arguments[1]),i!==i?i=0:0!==i&&i!==1/0&&i!==-(1/0)&&(i=(i>0||-1)*P(C(i)))),i>=r)return-1;for(var n=0>i?L(r-C(i),0):i;r>n;n++)if(e._getter(n)===t)return n;return-1}}),Object.defineProperty(c.prototype,"join",{value:function(t){if(this===z||null===this)throw TypeError();for(var e=Object(this),r=a(e.length),i=Array(r),n=0;r>n;++n)i[n]=e._getter(n);return i.join(t===z?",":t)}}),Object.defineProperty(c.prototype,"lastIndexOf",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(0===r)return-1;var i=r;arguments.length>1&&(i=Number(arguments[1]),i!==i?i=0:0!==i&&i!==1/0&&i!==-(1/0)&&(i=(i>0||-1)*P(C(i))));for(var n=0>i?r-C(i):j(i,r-1);n>=0;n--)if(e._getter(n)===t)return n;return-1}}),Object.defineProperty(c.prototype,"map",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();var n=[];n.length=r;for(var o=arguments[1],s=0;r>s;s++)n[s]=t.call(o,e._getter(s),s,e);return new this.constructor(n)}}),Object.defineProperty(c.prototype,"reduce",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();if(0===r&&1===arguments.length)throw TypeError();var n,o=0;for(n=arguments.length<2?e._getter(o++):arguments[1];r>o;)n=t.call(z,n,e._getter(o),o,e),o++;return n}}),Object.defineProperty(c.prototype,"reduceRight",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();if(0===r&&1===arguments.length)throw TypeError();var n,o=r-1;for(n=arguments.length<2?e._getter(o--):arguments[1];o>=0;)n=t.call(z,n,e._getter(o),o,e),o--;return n}}),Object.defineProperty(c.prototype,"reverse",{value:function(){if(this===z||null===this)throw TypeError();for(var t=Object(this),e=a(t.length),r=P(e/2),i=0,n=e-1;r>i;++i,--n){var o=t._getter(i);t._setter(i,t._getter(n)),t._setter(n,o)}return t}}),Object.defineProperty(c.prototype,"set",{value:function(){if(arguments.length<1)throw SyntaxError("Not enough arguments");var t,e,r,i,n,o,s,h,c,l;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(t=arguments[0],r=a(arguments[1]),r+t.length>this.length)throw RangeError("Offset plus length of array is out of range");if(h=this.byteOffset+r*this.BYTES_PER_ELEMENT,c=t.length*this.BYTES_PER_ELEMENT,t.buffer===this.buffer){for(l=[],n=0,o=t.byteOffset;c>n;n+=1,o+=1)l[n]=t.buffer._bytes[o];for(n=0,s=h;c>n;n+=1,s+=1)this.buffer._bytes[s]=l[n]}else for(n=0,o=t.byteOffset,s=h;c>n;n+=1,o+=1,s+=1)this.buffer._bytes[s]=t.buffer._bytes[o]}else{if("object"!=typeof arguments[0]||void 0===arguments[0].length)throw TypeError("Unexpected argument type(s)");if(e=arguments[0],i=a(e.length),r=a(arguments[1]),r+i>this.length)throw RangeError("Offset plus length of array is out of range");for(n=0;i>n;n+=1)o=e[n],this._setter(r+n,Number(o))}}}),Object.defineProperty(c.prototype,"slice",{value:function(t,e){for(var r=n(this),i=r.length,s=a(i),h=o(t),c=0>h?L(s+h,0):j(h,s),l=e===z?s:o(e),u=0>l?L(s+l,0):j(l,s),p=u-c,m=r.constructor,d=new m(p),E=0;u>c;){var f=r._getter(c);d._setter(E,f),++c,++E}return d}}),Object.defineProperty(c.prototype,"some",{value:function(t){if(this===z||null===this)throw TypeError();var e=Object(this),r=a(e.length);if(!i(t))throw TypeError();for(var n=arguments[1],o=0;r>o;o++)if(t.call(n,e._getter(o),o,e))return!0;return!1}}),Object.defineProperty(c.prototype,"sort",{value:function(t){if(this===z||null===this)throw TypeError();for(var e=Object(this),r=a(e.length),i=Array(r),n=0;r>n;++n)i[n]=e._getter(n);for(t?i.sort(t):i.sort(),n=0;r>n;++n)e._setter(n,i[n]);return e}}),Object.defineProperty(c.prototype,"subarray",{value:function(t,e){function r(t,e,r){return e>t?e:t>r?r:t}t=o(t),e=o(e),arguments.length<1&&(t=0),arguments.length<2&&(e=this.length),0>t&&(t=this.length+t),0>e&&(e=this.length+e),t=r(t,0,this.length),e=r(e,0,this.length);var i=e-t;return 0>i&&(i=0),new this.constructor(this.buffer,this.byteOffset+t*this.BYTES_PER_ELEMENT,i)}});var V=w(1,l,u),O=w(1,p,m),A=w(1,d,m),D=w(2,E,f),F=w(2,y,g),N=w(4,v,T),B=w(4,x,R),U=w(4,S,_),k=w(8,M,b);t.Int8Array=t.Int8Array||V,t.Uint8Array=t.Uint8Array||O,t.Uint8ClampedArray=t.Uint8ClampedArray||A,t.Int16Array=t.Int16Array||D,t.Uint16Array=t.Uint16Array||F,t.Int32Array=t.Int32Array||N,t.Uint32Array=t.Uint32Array||B,t.Float32Array=t.Float32Array||U,t.Float64Array=t.Float64Array||k}(),function(){function e(t,e){return i(t.get)?t.get(e):t[e]}function n(t,e,i){if(!(t instanceof ArrayBuffer||"ArrayBuffer"===r(t)))throw TypeError();if(e=a(e),e>t.byteLength)throw RangeError("byteOffset out of range");if(i=i===z?t.byteLength-e:a(i),e+i>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:i}),Object.defineProperty(this,"byteOffset",{value:e})}function o(t){return function(r,i){if(r=a(r),r+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");r+=this.byteOffset;for(var n=new Uint8Array(this.buffer,r,t.BYTES_PER_ELEMENT),o=[],s=0;s<t.BYTES_PER_ELEMENT;s+=1)o.push(e(n,s));return Boolean(i)===Boolean(h)&&o.reverse(),e(new t(new Uint8Array(o).buffer),0)}}function s(t){return function(r,i,n){if(r=a(r),r+t.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var o,s,c=new t([i]),l=new Uint8Array(c.buffer),u=[];for(o=0;o<t.BYTES_PER_ELEMENT;o+=1)u.push(e(l,o));Boolean(n)===Boolean(h)&&u.reverse(),s=new Uint8Array(this.buffer,r,t.BYTES_PER_ELEMENT),s.set(u)}}var h=function(){var t=new Uint16Array([4660]),r=new Uint8Array(t.buffer);return 18===e(r,0)}();Object.defineProperty(n.prototype,"getUint8",{value:o(Uint8Array)}),Object.defineProperty(n.prototype,"getInt8",{value:o(Int8Array)}),Object.defineProperty(n.prototype,"getUint16",{value:o(Uint16Array)}),Object.defineProperty(n.prototype,"getInt16",{value:o(Int16Array)}),Object.defineProperty(n.prototype,"getUint32",{value:o(Uint32Array)}),Object.defineProperty(n.prototype,"getInt32",{value:o(Int32Array)}),Object.defineProperty(n.prototype,"getFloat32",{value:o(Float32Array)}),Object.defineProperty(n.prototype,"getFloat64",{value:o(Float64Array)}),Object.defineProperty(n.prototype,"setUint8",{value:s(Uint8Array)}),Object.defineProperty(n.prototype,"setInt8",{value:s(Int8Array)}),Object.defineProperty(n.prototype,"setUint16",{value:s(Uint16Array)}),Object.defineProperty(n.prototype,"setInt16",{value:s(Int16Array)}),Object.defineProperty(n.prototype,"setUint32",{value:s(Uint32Array)}),Object.defineProperty(n.prototype,"setInt32",{value:s(Int32Array)}),Object.defineProperty(n.prototype,"setFloat32",{value:s(Float32Array)}),Object.defineProperty(n.prototype,"setFloat64",{value:s(Float64Array)}),t.DataView=t.DataView||n}()}(this),performanceProfile.textureMappingQuality=2);var THREE={REVISION:"65"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(t,e){if(Object.keys)for(var r=Object.keys(e),i=0,n=r.length;n>i;i++){var o=r[i];Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}else for(o in r={}.hasOwnProperty,e)r.call(e,o)&&(t[o]=e[o]);return t},function(){for(var t=0,e=["ms","moz","webkit","o"],r=0;r<e.length&&!self.requestAnimationFrame;++r)self.requestAnimationFrame=self[e[r]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[e[r]+"CancelAnimationFrame"]||self[e[r]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(e){var r=Date.now(),i=Math.max(0,16-(r-t)),n=self.setTimeout(function(){e(r+i)},i);return t=r+i,n}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(t){self.clearTimeout(t)})}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(t){return void 0!==t&&this.set(t),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(t){return t instanceof THREE.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setHex:function(t){return t=Math.floor(t),this.r=(255&t>>16)/255,this.g=(255&t>>8)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(t,e,r){if(0===e)this.r=this.g=this.b=r;else{var i=function(t,e,r){return 0>r&&(r+=1),r>1&&(r-=1),1/6>r?t+6*(e-t)*r:.5>r?e:2/3>r?t+6*(e-t)*(2/3-r):t},e=r>.5?r+e-r*e:r*(1+e),r=2*r-e;this.r=i(r,e,t+1/3),this.g=i(r,e,t),this.b=i(r,e,t-1/3)}return this},setStyle:function(t){return/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(t)?(t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(t),this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this):/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(t)?(t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(t),this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this):/^\#([0-9a-f]{6})$/i.test(t)?(t=/^\#([0-9a-f]{6})$/i.exec(t),this.setHex(parseInt(t[1],16)),this):/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(t)?(t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t),this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this):/^(\w+)$/i.test(t)?(this.setHex(THREE.ColorKeywords[t]),this):void 0},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t){return this.r=t.r*t.r,this.g=t.g*t.g,this.b=t.b*t.b,this},copyLinearToGamma:function(t){return this.r=Math.sqrt(t.r),this.g=Math.sqrt(t.g),this.b=Math.sqrt(t.b),this},convertGammaToLinear:function(){var t=this.r,e=this.g,r=this.b;return this.r=t*t,this.g=e*e,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,t=t||{h:0,s:0,l:0},r=this.r,i=this.g,n=this.b,o=Math.max(r,i,n),a=Math.min(r,i,n),s=(a+o)/2;if(a===o)a=e=0;else{var h=o-a,a=s>.5?h/(2-o-a):h/(o+a);switch(o){case r:e=(i-n)/h+(n>i?6:0);break;case i:e=(n-r)/h+2;break;case n:e=(r-i)/h+4}e/=6}return t.h=e,t.s=a,t.l=s,t},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(t,e,r){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=r,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t){return this.r=t[0],this.g=t[1],this.b=t[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={},THREE.Quaternion=function(t,e,r,i){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==i?i:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(t){this._x=t,this._updateEuler()},get y(){return this._y},set y(t){this._y=t,this._updateEuler()},get z(){return this._z},set z(t){this._z=t,this._updateEuler()},get w(){return this._w},set w(t){this._w=t,this._updateEuler()},set:function(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._updateEuler(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this._updateEuler(),this},setFromEuler:function(t,e){if(!1==t instanceof THREE.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");
	var r=Math.cos(t._x/2),i=Math.cos(t._y/2),n=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2);return"XYZ"===t.order?(this._x=o*i*n+r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n-o*a*s):"YXZ"===t.order?(this._x=o*i*n+r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n+o*a*s):"ZXY"===t.order?(this._x=o*i*n-r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n-o*a*s):"ZYX"===t.order?(this._x=o*i*n-r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n+o*a*s):"YZX"===t.order?(this._x=o*i*n+r*a*s,this._y=r*a*n+o*i*s,this._z=r*i*s-o*a*n,this._w=r*i*n-o*a*s):"XZY"===t.order&&(this._x=o*i*n-r*a*s,this._y=r*a*n-o*i*s,this._z=r*i*s+o*a*n,this._w=r*i*n+o*a*s),!1!==e&&this._updateEuler(),this},setFromAxisAngle:function(t,e){var r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._updateEuler(),this},setFromRotationMatrix:function(t){var e=t.elements,r=e[0],t=e[4],i=e[8],n=e[1],o=e[5],a=e[9],s=e[2],h=e[6],e=e[10],c=r+o+e;return c>0?(r=.5/Math.sqrt(c+1),this._w=.25/r,this._x=(h-a)*r,this._y=(i-s)*r,this._z=(n-t)*r):r>o&&r>e?(r=2*Math.sqrt(1+r-o-e),this._w=(h-a)/r,this._x=.25*r,this._y=(t+n)/r,this._z=(i+s)/r):o>e?(r=2*Math.sqrt(1+o-r-e),this._w=(i-s)/r,this._x=(t+n)/r,this._y=.25*r,this._z=(a+h)/r):(r=2*Math.sqrt(1+e-r-o),this._w=(n-t)/r,this._x=(i+s)/r,this._y=(a+h)/r,this._z=.25*r),this._updateEuler(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._updateEuler(),this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this},multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var r=t._x,i=t._y,n=t._z,o=t._w,a=e._x,s=e._y,h=e._z,c=e._w;return this._x=r*c+o*a+i*h-n*s,this._y=i*c+o*s+n*a-r*h,this._z=n*c+o*h+r*s-i*a,this._w=o*c-r*a-i*s-n*h,this._updateEuler(),this},multiplyVector3:function(t){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,e){var r=this._x,i=this._y,n=this._z,o=this._w,a=o*t._w+r*t._x+i*t._y+n*t._z;if(0>a?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=r,this._y=i,this._z=n,this;var s=Math.acos(a),h=Math.sqrt(1-a*a);return.001>Math.abs(h)?(this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(i+this._y),this._z=.5*(n+this._z),this):(a=Math.sin((1-e)*s)/h,s=Math.sin(e*s)/h,this._w=o*a+this._w*s,this._x=r*a+this._x*s,this._y=i*a+this._y*s,this._z=n*a+this._z*s,this._updateEuler(),this)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],this._w=t[3],this._updateEuler(),this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(t,e,r,i){return r.copy(t).slerp(e,i)},THREE.Vector2=function(t,e){this.x=t||0,this.y=e||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t):this.y=this.x=0,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,t=this.y-t.y;return e*e+t*t},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t){return this.x=t[0],this.y=t[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyMatrix3:function(t){var e=this.x,r=this.y,i=this.z,t=t.elements;return this.x=t[0]*e+t[3]*r+t[6]*i,this.y=t[1]*e+t[4]*r+t[7]*i,this.z=t[2]*e+t[5]*r+t[8]*i,this},applyMatrix4:function(t){var e=this.x,r=this.y,i=this.z,t=t.elements;return this.x=t[0]*e+t[4]*r+t[8]*i+t[12],this.y=t[1]*e+t[5]*r+t[9]*i+t[13],this.z=t[2]*e+t[6]*r+t[10]*i+t[14],this},applyProjection:function(t){var e=this.x,r=this.y,i=this.z,t=t.elements,n=1/(t[3]*e+t[7]*r+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*r+t[8]*i+t[12])*n,this.y=(t[1]*e+t[5]*r+t[9]*i+t[13])*n,this.z=(t[2]*e+t[6]*r+t[10]*i+t[14])*n,this},applyQuaternion:function(t){var e=this.x,r=this.y,i=this.z,n=t.x,o=t.y,a=t.z,t=t.w,s=t*e+o*i-a*r,h=t*r+a*e-n*i,c=t*i+n*r-o*e,e=-n*e-o*r-a*i;return this.x=s*t+e*-n+h*-a-c*-o,this.y=h*t+e*-o+c*-n-s*-a,this.z=c*t+e*-a+s*-o-h*-n,this},transformDirection:function(t){var e=this.x,r=this.y,i=this.z,t=t.elements;return this.x=t[0]*e+t[4]*r+t[8]*i,this.y=t[1]*e+t[5]*r+t[9]*i,this.z=t[2]*e+t[6]*r+t[10]*i,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t,this.z*=t):this.z=this.y=this.x=0,this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},cross:function(t,e){if(void 0!==e)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var r=this.x,i=this.y,n=this.z;return this.x=i*t.z-n*t.y,this.y=n*t.x-r*t.z,this.z=r*t.y-i*t.x,this},crossVectors:function(t,e){var r=t.x,i=t.y,n=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-n*a,this.y=n*o-r*s,this.z=r*a-i*o,this},angleTo:function(t){return t=this.dot(t)/(this.length()*t.length()),Math.acos(THREE.Math.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y,t=this.z-t.z;return e*e+r*r+t*t},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(t){return console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code."),this.setFromMatrixColumn(t,e)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),r=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),t=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=r,this.z=t,this},setFromMatrixColumn:function(t,e){var r=4*t,i=e.elements;return this.x=i[r],this.y=i[r+1],this.z=i[r+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var t=new THREE.Quaternion;return function(e){return!1==e instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code."),this.applyQuaternion(t.setFromEuler(e)),this}}(),applyAxisAngle:function(){var t=new THREE.Quaternion;return function(e,r){return this.applyQuaternion(t.setFromAxisAngle(e,r)),this}}(),projectOnVector:function(){var t=new THREE.Vector3;return function(e){return t.copy(e).normalize(),e=this.dot(t),this.copy(t).multiplyScalar(e)}}(),projectOnPlane:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new THREE.Vector3;return function(e){return t.copy(this).projectOnVector(e).multiplyScalar(2),this.subVectors(t,this)}}()}),THREE.Vector4=function(t,e,r,i){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==i?i:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},sub:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,i=this.z,n=this.w,t=t.elements;return this.x=t[0]*e+t[4]*r+t[8]*i+t[12]*n,this.y=t[1]*e+t[5]*r+t[9]*i+t[13]*n,this.z=t[2]*e+t[6]*r+t[10]*i+t[14]*n,this.w=t[3]*e+t[7]*r+t[11]*i+t[15]*n,this},divideScalar:function(t){return 0!==t?(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.z=this.y=this.x=0,this.w=1),this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,r,i,t=t.elements,n=t[0];i=t[4];var o=t[8],a=t[1],s=t[5],h=t[9];r=t[2],e=t[6];var c=t[10];return.01>Math.abs(i-a)&&.01>Math.abs(o-r)&&.01>Math.abs(h-e)?.1>Math.abs(i+a)&&.1>Math.abs(o+r)&&.1>Math.abs(h+e)&&.1>Math.abs(n+s+c-3)?(this.set(1,0,0,0),this):(t=Math.PI,n=(n+1)/2,s=(s+1)/2,c=(c+1)/2,i=(i+a)/4,o=(o+r)/4,h=(h+e)/4,n>s&&n>c?.01>n?(e=0,i=r=.707106781):(e=Math.sqrt(n),r=i/e,i=o/e):s>c?.01>s?(e=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),e=i/r,i=h/r):.01>c?(r=e=.707106781,i=0):(i=Math.sqrt(c),e=o/i,r=h/i),this.set(e,r,i,t),this):(t=Math.sqrt((e-h)*(e-h)+(o-r)*(o-r)+(a-i)*(a-i)),.001>Math.abs(t)&&(t=1),this.x=(e-h)/t,this.y=(o-r)/t,this.z=(a-i)/t,this.w=Math.acos((n+s+c-1)/2),this)},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this.z<t.z?this.z=t.z:this.z>e.z&&(this.z=e.z),this.w<t.w?this.w=t.w:this.w>e.w&&(this.w=e.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t){return this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(t,e,r,i){this._x=t||0,this._y=e||0,this._z=r||0,this._order=i||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(t){this._x=t,this._updateQuaternion()},get y(){return this._y},set y(t){this._y=t,this._updateQuaternion()},get z(){return this._z},set z(t){this._z=t,this._updateQuaternion()},get order(){return this._order},set order(t){this._order=t,this._updateQuaternion()},set:function(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._order=i||this._order,this._updateQuaternion(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._updateQuaternion(),this},setFromRotationMatrix:function(t,e){function r(t){return Math.min(Math.max(t,-1),1)}var i=t.elements,n=i[0],o=i[4],a=i[8],s=i[1],h=i[5],c=i[9],l=i[2],u=i[6],i=i[10],e=e||this._order;return"XYZ"===e?(this._y=Math.asin(r(a)),.99999>Math.abs(a)?(this._x=Math.atan2(-c,i),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(u,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c)),.99999>Math.abs(c)?(this._y=Math.atan2(a,i),this._z=Math.atan2(s,h)):(this._y=Math.atan2(-l,n),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(u)),.99999>Math.abs(u)?(this._y=Math.atan2(-l,i),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(s,n))):"ZYX"===e?(this._y=Math.asin(-r(l)),.99999>Math.abs(l)?(this._x=Math.atan2(u,i),this._z=Math.atan2(s,n)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"===e?(this._z=Math.asin(r(s)),.99999>Math.abs(s)?(this._x=Math.atan2(-c,h),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(a,i))):"XZY"===e?(this._z=Math.asin(-r(o)),.99999>Math.abs(o)?(this._x=Math.atan2(u,h),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,i),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+e),this._order=e,this._updateQuaternion(),this},setFromQuaternion:function(t,e,r){function i(t){return Math.min(Math.max(t,-1),1)}var n=t.x*t.x,o=t.y*t.y,a=t.z*t.z,s=t.w*t.w,e=e||this._order;return"XYZ"===e?(this._x=Math.atan2(2*(t.x*t.w-t.y*t.z),s-n-o+a),this._y=Math.asin(i(2*(t.x*t.z+t.y*t.w))),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),s+n-o-a)):"YXZ"===e?(this._x=Math.asin(i(2*(t.x*t.w-t.y*t.z))),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),s-n-o+a),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),s-n+o-a)):"ZXY"===e?(this._x=Math.asin(i(2*(t.x*t.w+t.y*t.z))),this._y=Math.atan2(2*(t.y*t.w-t.z*t.x),s-n-o+a),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),s-n+o-a)):"ZYX"===e?(this._x=Math.atan2(2*(t.x*t.w+t.z*t.y),s-n-o+a),this._y=Math.asin(i(2*(t.y*t.w-t.x*t.z))),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),s+n-o-a)):"YZX"===e?(this._x=Math.atan2(2*(t.x*t.w-t.z*t.y),s-n+o-a),this._y=Math.atan2(2*(t.y*t.w-t.x*t.z),s+n-o-a),this._z=Math.asin(i(2*(t.x*t.y+t.z*t.w)))):"XZY"===e?(this._x=Math.atan2(2*(t.x*t.w+t.y*t.z),s-n+o-a),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),s+n-o-a),this._z=Math.asin(i(2*(t.z*t.w-t.x*t.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+e),this._order=e,!1!==r&&this._updateQuaternion(),this},reorder:function(){var t=new THREE.Quaternion;return function(e){t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._updateQuaternion(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Matrix3=function(t,e,r,i,n,o,a,s,h){this.elements=new Float32Array(9),this.set(void 0!==t?t:1,e||0,r||0,i||0,void 0!==n?n:1,o||0,a||0,s||0,void 0!==h?h:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,e,r,i,n,o,a,s,h){var c=this.elements;return c[0]=t,c[3]=e,c[6]=r,c[1]=i,c[4]=n,c[7]=o,c[2]=a,c[5]=s,c[8]=h,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){return t=t.elements,this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var r=0,i=e.length;i>r;r+=3)t.x=e[r],t.y=e[r+1],t.z=e[r+2],t.applyMatrix3(this),e[r]=t.x,e[r+1]=t.y,e[r+2]=t.z;return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],i=t[2],n=t[3],o=t[4],a=t[5],s=t[6],h=t[7],t=t[8];return e*o*t-e*a*h-r*n*t+r*a*s+i*n*h-i*o*s},getInverse:function(t,e){var r=t.elements,i=this.elements;if(i[0]=r[10]*r[5]-r[6]*r[9],i[1]=-r[10]*r[1]+r[2]*r[9],i[2]=r[6]*r[1]-r[2]*r[5],i[3]=-r[10]*r[4]+r[6]*r[8],i[4]=r[10]*r[0]-r[2]*r[8],i[5]=-r[6]*r[0]+r[2]*r[4],i[6]=r[9]*r[4]-r[5]*r[8],i[7]=-r[9]*r[0]+r[1]*r[8],i[8]=r[5]*r[0]-r[1]*r[4],r=r[0]*i[0]+r[1]*i[3]+r[2]*i[6],0===r){if(e)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},clone:function(){var t=this.elements;return new THREE.Matrix3(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])}},THREE.Matrix4=function(t,e,r,i,n,o,a,s,h,c,l,u,p,m,d,E){var f=this.elements=new Float32Array(16);f[0]=void 0!==t?t:1,f[4]=e||0,f[8]=r||0,f[12]=i||0,f[1]=n||0,f[5]=void 0!==o?o:1,f[9]=a||0,f[13]=s||0,f[2]=h||0,f[6]=c||0,f[10]=void 0!==l?l:1,f[14]=u||0,f[3]=p||0,f[7]=m||0,f[11]=d||0,f[15]=void 0!==E?E:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,e,r,i,n,o,a,s,h,c,l,u,p,m,d,E){var f=this.elements;return f[0]=t,f[4]=e,f[8]=r,f[12]=i,f[1]=n,f[5]=o,f[9]=a,f[13]=s,f[2]=h,f[6]=c,f[10]=l,f[14]=u,f[3]=p,f[7]=m,f[11]=d,f[15]=E,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var e=this.elements,t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractRotation:function(){var t=new THREE.Vector3;return function(e){var r=this.elements,e=e.elements,i=1/t.set(e[0],e[1],e[2]).length(),n=1/t.set(e[4],e[5],e[6]).length(),o=1/t.set(e[8],e[9],e[10]).length();return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[8]=e[8]*o,r[9]=e[9]*o,r[10]=e[10]*o,this}}(),makeRotationFromEuler:function(t){!1==t instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var e=this.elements,r=t.x,i=t.y,n=t.z,o=Math.cos(r),r=Math.sin(r),a=Math.cos(i),i=Math.sin(i),s=Math.cos(n),n=Math.sin(n);if("XYZ"===t.order){var t=o*s,h=o*n,c=r*s,l=r*n;e[0]=a*s,e[4]=-a*n,e[8]=i,e[1]=h+c*i,e[5]=t-l*i,e[9]=-r*a,e[2]=l-t*i,e[6]=c+h*i,e[10]=o*a}else"YXZ"===t.order?(t=a*s,h=a*n,c=i*s,l=i*n,e[0]=t+l*r,e[4]=c*r-h,e[8]=o*i,e[1]=o*n,e[5]=o*s,e[9]=-r,e[2]=h*r-c,e[6]=l+t*r,e[10]=o*a):"ZXY"===t.order?(t=a*s,h=a*n,c=i*s,l=i*n,e[0]=t-l*r,e[4]=-o*n,e[8]=c+h*r,e[1]=h+c*r,e[5]=o*s,e[9]=l-t*r,e[2]=-o*i,e[6]=r,e[10]=o*a):"ZYX"===t.order?(t=o*s,h=o*n,c=r*s,l=r*n,e[0]=a*s,e[4]=c*i-h,e[8]=t*i+l,e[1]=a*n,e[5]=l*i+t,e[9]=h*i-c,e[2]=-i,e[6]=r*a,e[10]=o*a):"YZX"===t.order?(t=o*a,h=o*i,c=r*a,l=r*i,e[0]=a*s,e[4]=l-t*n,e[8]=c*n+h,e[1]=n,e[5]=o*s,e[9]=-r*s,e[2]=-i*s,e[6]=h*n+c,e[10]=t-l*n):"XZY"===t.order&&(t=o*a,h=o*i,c=r*a,l=r*i,e[0]=a*s,e[4]=-n,e[8]=i*s,e[1]=t*n+l,e[5]=o*s,e[9]=h*n-c,e[2]=c*n-h,e[6]=r*s,e[10]=l*n+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var e=this.elements,r=t.x,i=t.y,n=t.z,o=t.w,a=r+r,s=i+i,h=n+n,t=r*a,c=r*s,r=r*h,l=i*s,i=i*h,n=n*h,a=o*a,s=o*s,o=o*h;return e[0]=1-(l+n),e[4]=c-o,e[8]=r+s,e[1]=c+o,e[5]=1-(t+n),e[9]=i-a,e[2]=r-s,e[6]=i+a,e[10]=1-(t+l),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new THREE.Vector3,e=new THREE.Vector3,r=new THREE.Vector3;return function(i,n,o){var a=this.elements;return r.subVectors(i,n).normalize(),0===r.length()&&(r.z=1),t.crossVectors(o,r).normalize(),0===t.length()&&(r.x+=1e-4,t.crossVectors(o,r).normalize()),e.crossVectors(r,t),a[0]=t.x,a[4]=e.x,a[8]=r.x,a[1]=t.y,a[5]=e.y,a[9]=r.y,a[2]=t.z,a[6]=e.z,a[10]=r.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var r=t.elements,i=e.elements,n=this.elements,o=r[0],a=r[4],s=r[8],h=r[12],c=r[1],l=r[5],u=r[9],p=r[13],m=r[2],d=r[6],E=r[10],f=r[14],y=r[3],g=r[7],v=r[11],r=r[15],T=i[0],x=i[4],R=i[8],w=i[12],H=i[1],b=i[5],M=i[9],_=i[13],S=i[2],z=i[6],V=i[10],O=i[14],C=i[3],P=i[7],A=i[11],i=i[15];return n[0]=o*T+a*H+s*S+h*C,n[4]=o*x+a*b+s*z+h*P,n[8]=o*R+a*M+s*V+h*A,n[12]=o*w+a*_+s*O+h*i,n[1]=c*T+l*H+u*S+p*C,n[5]=c*x+l*b+u*z+p*P,n[9]=c*R+l*M+u*V+p*A,n[13]=c*w+l*_+u*O+p*i,n[2]=m*T+d*H+E*S+f*C,n[6]=m*x+d*b+E*z+f*P,n[10]=m*R+d*M+E*V+f*A,n[14]=m*w+d*_+E*O+f*i,n[3]=y*T+g*H+v*S+r*C,n[7]=y*x+g*b+v*z+r*P,n[11]=y*R+g*M+v*V+r*A,n[15]=y*w+g*_+v*O+r*i,this},multiplyToArray:function(t,e,r){var i=this.elements;return this.multiplyMatrices(t,e),r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){var t=new THREE.Vector3;return function(e){for(var r=0,i=e.length;i>r;r+=3)t.x=e[r],t.y=e[r+1],t.z=e[r+2],t.applyProjection(this),e[r]=t.x,e[r+1]=t.y,e[r+2]=t.z;return e}}(),rotateAxis:function(t){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,e=t[0],r=t[4],i=t[8],n=t[12],o=t[1],a=t[5],s=t[9],h=t[13],c=t[2],l=t[6],u=t[10],p=t[14];return t[3]*(+n*s*l-i*h*l-n*a*u+r*h*u+i*a*p-r*s*p)+t[7]*(+e*s*p-e*h*u+n*o*u-i*o*p+i*h*c-n*s*c)+t[11]*(+e*h*l-e*a*p-n*o*l+r*o*p+n*a*c-r*h*c)+t[15]*(-i*a*c-e*s*l+e*a*u+i*o*l-r*o*u+r*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},flattenToArrayOffset:function(t,e){var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},getPosition:function(){var t=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var e=this.elements;return t.set(e[12],e[13],e[14])}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var r=this.elements,i=t.elements,n=i[0],o=i[4],a=i[8],s=i[12],h=i[1],c=i[5],l=i[9],u=i[13],p=i[2],m=i[6],d=i[10],E=i[14],f=i[3],y=i[7],g=i[11],i=i[15];if(r[0]=l*E*y-u*d*y+u*m*g-c*E*g-l*m*i+c*d*i,r[4]=s*d*y-a*E*y-s*m*g+o*E*g+a*m*i-o*d*i,r[8]=a*u*y-s*l*y+s*c*g-o*u*g-a*c*i+o*l*i,r[12]=s*l*m-a*u*m-s*c*d+o*u*d+a*c*E-o*l*E,r[1]=u*d*f-l*E*f-u*p*g+h*E*g+l*p*i-h*d*i,r[5]=a*E*f-s*d*f+s*p*g-n*E*g-a*p*i+n*d*i,r[9]=s*l*f-a*u*f-s*h*g+n*u*g+a*h*i-n*l*i,r[13]=a*u*p-s*l*p+s*h*d-n*u*d-a*h*E+n*l*E,r[2]=c*E*f-u*m*f+u*p*y-h*E*y-c*p*i+h*m*i,r[6]=s*m*f-o*E*f-s*p*y+n*E*y+o*p*i-n*m*i,r[10]=o*u*f-s*c*f+s*h*y-n*u*y-o*h*i+n*c*i,r[14]=s*c*p-o*u*p-s*h*m+n*u*m+o*h*E-n*c*E,r[3]=l*m*f-c*d*f-l*p*y+h*d*y+c*p*g-h*m*g,r[7]=o*d*f-a*m*f+a*p*y-n*d*y-o*p*g+n*m*g,r[11]=a*c*f-o*l*f-a*h*y+n*l*y+o*h*g-n*c*g,r[15]=o*l*p-a*c*p+a*h*m-n*l*m-o*h*d+n*c*d,r=n*r[0]+h*r[4]+p*r[8]+f*r[12],0==r){if(e)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/r),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")
},scale:function(t){var e=this.elements,r=t.x,i=t.y,t=t.z;return e[0]*=r,e[4]*=i,e[8]*=t,e[1]*=r,e[5]*=i,e[9]*=t,e[2]*=r,e[6]*=i,e[10]*=t,e[3]*=r,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],Math.max(t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10])))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e),i=Math.sin(e),n=1-r,o=t.x,a=t.y,s=t.z,h=n*o,c=n*a;return this.set(h*o+r,h*a-i*s,h*s+i*a,0,h*a+i*s,c*a+r,c*s-i*o,0,h*s-i*a,c*s+i*o,n*s*s+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},compose:function(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this},decompose:function(){var t=new THREE.Vector3,e=new THREE.Matrix4;return function(r,i,n){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),h=t.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a),r.x=o[12],r.y=o[13],r.z=o[14],e.elements.set(this.elements);var r=1/a,o=1/s,c=1/h;return e.elements[0]*=r,e.elements[1]*=r,e.elements[2]*=r,e.elements[4]*=o,e.elements[5]*=o,e.elements[6]*=o,e.elements[8]*=c,e.elements[9]*=c,e.elements[10]*=c,i.setFromRotationMatrix(e),n.x=a,n.y=s,n.z=h,this}}(),makeFrustum:function(t,e,r,i,n,o){var a=this.elements;return a[0]=2*n/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*n/(i-r),a[9]=(i+r)/(i-r),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+n)/(o-n),a[14]=-2*o*n/(o-n),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,r,i){var t=r*Math.tan(THREE.Math.degToRad(.5*t)),n=-t;return this.makeFrustum(n*e,t*e,n,t,r,i)},makeOrthographic:function(t,e,r,i,n,o){var a=this.elements,s=e-t,h=r-i,c=o-n;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-((e+t)/s),a[1]=0,a[5]=2/h,a[9]=0,a[13]=-((r+i)/h),a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-((o+n)/c),a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){var t=this.elements;return new THREE.Matrix4(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])}},THREE.Ray=function(t,e){this.origin=void 0!==t?t:new THREE.Vector3,this.direction=void 0!==e?e:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new THREE.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var t=new THREE.Vector3;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var r=e||new THREE.Vector3;r.subVectors(t,this.origin);var i=r.dot(this.direction);return 0>i?r.copy(this.origin):r.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){var r=t.subVectors(e,this.origin).dot(this.direction);return 0>r?this.origin.distanceTo(e):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceTo(e))}}(),distanceSqToSegment:function(t,e,r,i){var n,o,a=t.clone().add(e).multiplyScalar(.5),s=e.clone().sub(t).normalize(),h=.5*t.distanceTo(e),c=this.origin.clone().sub(a),t=-this.direction.dot(s),e=c.dot(this.direction),l=-c.dot(s),u=c.lengthSq(),p=Math.abs(1-t*t);return 0>p?(n=t>0?-h:h,c=Math.max(0,-(t*n+e)),t=-c*c+n*(n+2*l)+u):(c=t*l-e,n=t*e-l,o=h*p,0>c?n>-o?n>o?(c=Math.max(0,-(t*h+e)),n=c>0?h:Math.min(Math.max(-h,-l),h),t=-c*c+n*(n+2*l)+u):(c=0,n=Math.min(Math.max(-h,-l),h),t=n*(n+2*l)+u):(c=Math.max(0,-(-t*h+e)),n=c>0?-h:Math.min(Math.max(-h,-l),h),t=-c*c+n*(n+2*l)+u):-o>n?(n=-h,c=Math.max(0,-(t*n+e)),t=-c*c+n*(n+2*l)+u):n>o?(n=h,c=Math.max(0,-(t*n+e)),t=-c*c+n*(n+2*l)+u):(h=1/p,c*=h,n*=h,t=c*(c+t*n+2*e)+n*(t*c+n+2*l)+u)),r&&r.copy(this.direction.clone().multiplyScalar(c).add(this.origin)),i&&i.copy(s.clone().multiplyScalar(n).add(a)),t},isIntersectionSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},isIntersectionPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e?!0:!1},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0==e?0==t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,0>t?null:t)},intersectPlane:function(t,e){var r=this.distanceToPlane(t);return null===r?null:this.at(r,e)},isIntersectionBox:function(){var t=new THREE.Vector3;return function(e){return null!==this.intersectBox(e,t)}}(),intersectBox:function(t,e){var r,i,n,o,a;i=1/this.direction.x,o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return 0>i?(r=(t.max.x-s.x)*i,i*=t.min.x-s.x):(r=(t.min.x-s.x)*i,i*=t.max.x-s.x),0>o?(n=(t.max.y-s.y)*o,o*=t.min.y-s.y):(n=(t.min.y-s.y)*o,o*=t.max.y-s.y),r>o||n>i?null:((n>r||r!==r)&&(r=n),(i>o||i!==i)&&(i=o),0>a?(n=(t.max.z-s.z)*a,a*=t.min.z-s.z):(n=(t.min.z-s.z)*a,a*=t.max.z-s.z),r>a||n>i?null:((n>r||r!==r)&&(r=n),(i>a||i!==i)&&(i=a),0>i?null:this.at(0>r?i:r,e)))},intersectTriangle:function(){var t=new THREE.Vector3,e=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3;return function(n,o,a,s,h){if(e.subVectors(o,n),r.subVectors(a,n),i.crossVectors(e,r),o=this.direction.dot(i),o>0){if(s)return null;s=1}else{if(o>=0)return null;s=-1,o=-o}return t.subVectors(this.origin,n),n=s*this.direction.dot(r.crossVectors(t,r)),0>n?null:(a=s*this.direction.dot(e.cross(t)),0>a||n+a>o?null:(n=-s*t.dot(i),0>n?null:this.at(n/o,h)))}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Box2=function(t,e){this.min=void 0!==t?t:new THREE.Vector2(1/0,1/0),this.max=void 0!==e?e:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){if(0<t.length){var e=t[0];this.min.copy(e),this.max.copy(e);for(var r=1,i=t.length;i>r;r++)e=t[r],e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector2;return function(e,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y?!1:!0},containsBox:function(t){return this.min.x>t.min.x||t.max.x>this.max.x||this.min.y>t.min.y||t.max.y>this.max.y?!1:!0},getParameter:function(t,e){return(e||new THREE.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y?!1:!0},clampPoint:function(t,e){return(e||new THREE.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector2;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(t,e){this.min=void 0!==t?t:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},addPoint:function(t){t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y),t.z<this.min.z?this.min.z=t.z:t.z>this.max.z&&(this.max.z=t.z)},setFromPoints:function(t){if(0<t.length){var e=t[0];this.min.copy(e),this.max.copy(e);for(var e=1,r=t.length;r>e;e++)this.addPoint(t[e])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var t=new THREE.Vector3;return function(e,r){var i=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new THREE.Vector3;return function(e){var r=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse(function(e){if(void 0!==e.geometry&&void 0!==e.geometry.vertices)for(var i=e.geometry.vertices,n=0,o=i.length;o>n;n++)t.copy(i[n]),t.applyMatrix4(e.matrixWorld),r.expandByPoint(t)}),this}}(),copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z?!1:!0},containsBox:function(t){return this.min.x>t.min.x||t.max.x>this.max.x||this.min.y>t.min.y||t.max.y>this.max.y||this.min.z>t.min.z||t.max.z>this.max.z?!1:!0},getParameter:function(t,e){return(e||new THREE.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(t){return t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z?!1:!0},clampPoint:function(t,e){return(e||new THREE.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new THREE.Vector3;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new THREE.Vector3;return function(e){return e=e||new THREE.Sphere,e.center=this.center(),e.radius=.5*this.size(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(e){return t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(t),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Sphere=function(t,e){this.center=void 0!==t?t:new THREE.Vector3,this.radius=void 0!==e?e:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new THREE.Box3;return function(e,r){var i=this.center;void 0!==r?i.copy(r):t.setFromPoints(e).center(i);for(var n=0,o=0,a=e.length;a>o;o++)n=Math.max(n,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(n),this}}(),copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},clampPoint:function(t,e){var r=this.center.distanceToSquared(t),i=e||new THREE.Vector3;return i.copy(t),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return t=t||new THREE.Box3,t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Plane=function(t,e){this.normal=void 0!==t?t:new THREE.Vector3(1,0,0),this.constant=void 0!==e?e:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,i){return this.normal.set(t,e,r),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(r,i,n){return i=t.subVectors(n,i).cross(e.subVectors(r,i)).normalize(),this.setFromNormalAndCoplanarPoint(i,r),this}}(),copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var r=this.distanceToPoint(t);return(e||new THREE.Vector3).copy(this.normal).multiplyScalar(r)},isIntersectionLine:function(t){var e=this.distanceToPoint(t.start),t=this.distanceToPoint(t.end);return 0>e&&t>0||0>t&&e>0},intersectLine:function(){var t=new THREE.Vector3;return function(e,r){var i=r||new THREE.Vector3,n=e.delta(t),o=this.normal.dot(n);return 0!=o?(o=-(e.start.dot(this.normal)+this.constant)/o,0>o||o>1?void 0:i.copy(n).multiplyScalar(o).add(e.start)):0==this.distanceToPoint(e.start)?i.copy(e.start):void 0}}(),coplanarPoint:function(t){return(t||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new THREE.Vector3,e=new THREE.Vector3,r=new THREE.Matrix3;return function(i,n){var o=n||r.getNormalMatrix(i),o=t.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(e);return a.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(o,a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Frustum=function(t,e,r,i,n,o){this.planes=[void 0!==t?t:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==o?o:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(t,e,r,i,n,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(o),this},copy:function(t){for(var e=this.planes,r=0;6>r;r++)e[r].copy(t.planes[r]);return this},setFromMatrix:function(t){var e=this.planes,r=t.elements,t=r[0],i=r[1],n=r[2],o=r[3],a=r[4],s=r[5],h=r[6],c=r[7],l=r[8],u=r[9],p=r[10],m=r[11],d=r[12],E=r[13],f=r[14],r=r[15];return e[0].setComponents(o-t,c-a,m-l,r-d).normalize(),e[1].setComponents(o+t,c+a,m+l,r+d).normalize(),e[2].setComponents(o+i,c+s,m+u,r+E).normalize(),e[3].setComponents(o-i,c-s,m-u,r-E).normalize(),e[4].setComponents(o-n,c-h,m-p,r-f).normalize(),e[5].setComponents(o+n,c+h,m+p,r+f).normalize(),this},intersectsObject:function(){var t=new THREE.Sphere;return function(e){var r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere),t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,r=t.center,t=-t.radius,i=0;6>i;i++)if(e[i].distanceToPoint(r)<t)return!1;return!0},intersectsBox:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(r){for(var i=this.planes,n=0;6>n;n++){var o=i[n];t.x=0<o.normal.x?r.min.x:r.max.x,e.x=0<o.normal.x?r.max.x:r.min.x,t.y=0<o.normal.y?r.min.y:r.max.y,e.y=0<o.normal.y?r.max.y:r.min.y,t.z=0<o.normal.z?r.min.z:r.max.z,e.z=0<o.normal.z?r.max.z:r.min.z;var a=o.distanceToPoint(t),o=o.distanceToPoint(e);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,r=0;6>r;r++)if(0>e[r].distanceToPoint(t))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Math={PI2:2*Math.PI,generateUUID:function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=Array(36),i=0;return function(){for(var n=0;36>n;n++)8==n||13==n||18==n||23==n?r[n]="-":14==n?r[n]="4":(2>=i&&(i=0|33554432+16777216*Math.random()),t=15&i,i>>=4,r[n]=e[19==n?8|3&t:t]);return r.join("")}}(),clamp:function(t,e,r){return e>t?e:t>r?r:t},clampBottom:function(t,e){return e>t?e:t},mapLinear:function(t,e,r,i,n){return i+(t-e)*(n-i)/(r-e)},smoothstep:function(t,e,r){return t>e?r>t?(t=(t-e)/(r-e),t*t*(3-2*t)):1:0},smootherstep:function(t,e,r){return t>e?r>t?(t=(t-e)/(r-e),t*t*t*(t*(6*t-15)+10)):1:0},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},sign:function(t){return 0>t?-1:t>0?1:0},degToRad:function(){var t=Math.PI/180;return function(e){return e*t}}(),radToDeg:function(){var t=180/Math.PI;return function(e){return e*t}}()},THREE.Triangle=function(t,e,r){this.a=void 0!==t?t:new THREE.Vector3,this.b=void 0!==e?e:new THREE.Vector3,this.c=void 0!==r?r:new THREE.Vector3},THREE.Triangle.normal=function(){var t=new THREE.Vector3;return function(e,r,i,n){return n=n||new THREE.Vector3,n.subVectors(i,r),t.subVectors(e,r),n.cross(t),e=n.lengthSq(),e>0?n.multiplyScalar(1/Math.sqrt(e)):n.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var t=new THREE.Vector3,e=new THREE.Vector3,r=new THREE.Vector3;return function(i,n,o,a,s){t.subVectors(a,n),e.subVectors(o,n),r.subVectors(i,n);var i=t.dot(t),n=t.dot(e),o=t.dot(r),h=e.dot(e),a=e.dot(r),c=i*h-n*n,s=s||new THREE.Vector3;return 0==c?s.set(-2,-1,-1):(c=1/c,h=(h*o-n*a)*c,i=(i*a-n*o)*c,s.set(1-h-i,i,h))}}(),THREE.Triangle.containsPoint=function(){var t=new THREE.Vector3;return function(e,r,i,n){return e=THREE.Triangle.barycoordFromPoint(e,r,i,n,t),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return THREE.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return THREE.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return THREE.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(t){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),t},THREE.UV=function(t,e){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(t,e)},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(t){t.addEventListener=THREE.EventDispatcher.prototype.addEventListener,t.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,t.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)?!0:!1},removeEventListener:function(t,e){if(void 0!==this._listeners){var r=this._listeners[t];if(void 0!==r){var i=r.indexOf(e);-1!==i&&r.splice(i,1)}}},dispatchEvent:function(){var t=[];return function(e){if(void 0!==this._listeners){var r=this._listeners[e.type];if(void 0!==r){e.target=this;for(var i=r.length,n=0;i>n;n++)t[n]=r[n];for(n=0;i>n;n++)t[n].call(this,e)}}}}()},function(t){t.Raycaster=function(e,r,i,n){this.ray=new t.Ray(e,r),this.near=i||0,this.far=n||1/0};var e=new t.Sphere,r=new t.Ray;new t.Plane,new t.Vector3;var i=new t.Vector3,n=new t.Matrix4,o=function(t,e){return t.distance-e.distance},a=new t.Vector3,s=new t.Vector3,h=new t.Vector3,c=function(o,l,u){if(o instanceof t.Sprite){i.setFromMatrixPosition(o.matrixWorld);var p=l.ray.distanceToPoint(i);if(p>o.scale.x)return u;u.push({distance:p,point:o.position,face:null,object:o})}else if(o instanceof t.LOD)i.setFromMatrixPosition(o.matrixWorld),p=l.ray.origin.distanceTo(i),c(o.getObjectForDistance(p),l,u);else if(o instanceof t.Mesh){var m=o.geometry;if(null===m.boundingSphere&&m.computeBoundingSphere(),e.copy(m.boundingSphere),e.applyMatrix4(o.matrixWorld),!1===l.ray.isIntersectionSphere(e))return u;if(n.getInverse(o.matrixWorld),r.copy(l.ray).applyMatrix4(n),null!==m.boundingBox&&!1===r.isIntersectionBox(m.boundingBox))return u;if(m instanceof t.BufferGeometry){var d=o.material;if(void 0===d||!1===m.dynamic)return u;var E,f,y=l.precision;if(void 0!==m.attributes.index)for(var g=m.offsets,v=m.attributes.index.array,T=m.attributes.position.array,x=m.offsets.length,R=m.attributes.index.array.length/3,R=0;x>R;++R)for(var p=g[R].start,w=g[R].index,m=p,H=p+g[R].count;H>m;m+=3)p=w+v[m],E=w+v[m+1],f=w+v[m+2],a.set(T[3*p],T[3*p+1],T[3*p+2]),s.set(T[3*E],T[3*E+1],T[3*E+2]),h.set(T[3*f],T[3*f+1],T[3*f+2]),E=d.side===t.BackSide?r.intersectTriangle(h,s,a,!0):r.intersectTriangle(a,s,h,d.side!==t.DoubleSide),null!==E&&(E.applyMatrix4(o.matrixWorld),p=l.ray.origin.distanceTo(E),y>p||p<l.near||p>l.far||u.push({distance:p,point:E,face:null,faceIndex:null,object:o}));else for(T=m.attributes.position.array,R=m.attributes.position.array.length,m=0;R>m;m+=3)p=m,E=m+1,f=m+2,a.set(T[3*p],T[3*p+1],T[3*p+2]),s.set(T[3*E],T[3*E+1],T[3*E+2]),h.set(T[3*f],T[3*f+1],T[3*f+2]),E=d.side===t.BackSide?r.intersectTriangle(h,s,a,!0):r.intersectTriangle(a,s,h,d.side!==t.DoubleSide),null!==E&&(E.applyMatrix4(o.matrixWorld),p=l.ray.origin.distanceTo(E),y>p||p<l.near||p>l.far||u.push({distance:p,point:E,face:null,faceIndex:null,object:o}))}else if(m instanceof t.Geometry)for(v=o.material instanceof t.MeshFaceMaterial,T=!0===v?o.material.materials:null,y=l.precision,g=m.vertices,x=0,R=m.faces.length;R>x;x++)if(w=m.faces[x],d=!0===v?T[w.materialIndex]:o.material,void 0!==d){if(p=g[w.a],E=g[w.b],f=g[w.c],!0===d.morphTargets){var H=m.morphTargets,b=o.morphTargetInfluences;a.set(0,0,0),s.set(0,0,0),h.set(0,0,0);for(var M=0,_=H.length;_>M;M++){var S=b[M];if(0!==S){var z=H[M].vertices;a.x+=(z[w.a].x-p.x)*S,a.y+=(z[w.a].y-p.y)*S,a.z+=(z[w.a].z-p.z)*S,s.x+=(z[w.b].x-E.x)*S,s.y+=(z[w.b].y-E.y)*S,s.z+=(z[w.b].z-E.z)*S,h.x+=(z[w.c].x-f.x)*S,h.y+=(z[w.c].y-f.y)*S,h.z+=(z[w.c].z-f.z)*S}}a.add(p),s.add(E),h.add(f),p=a,E=s,f=h}E=d.side===t.BackSide?r.intersectTriangle(f,E,p,!0):r.intersectTriangle(p,E,f,d.side!==t.DoubleSide),null!==E&&(E.applyMatrix4(o.matrixWorld),p=l.ray.origin.distanceTo(E),y>p||p<l.near||p>l.far||u.push({distance:p,point:E,face:w,faceIndex:x,object:o}))}}else if(o instanceof t.Line){if(y=l.linePrecision,d=y*y,m=o.geometry,null===m.boundingSphere&&m.computeBoundingSphere(),e.copy(m.boundingSphere),e.applyMatrix4(o.matrixWorld),!1===l.ray.isIntersectionSphere(e))return u;if(n.getInverse(o.matrixWorld),r.copy(l.ray).applyMatrix4(n),m instanceof t.Geometry)for(g=m.vertices,y=g.length,E=new t.Vector3,f=new t.Vector3,R=o.type===t.LineStrip?1:2,m=0;y-1>m;m+=R)r.distanceSqToSegment(g[m],g[m+1],f,E)>d||(p=r.origin.distanceTo(f),p<l.near||p>l.far||u.push({distance:p,point:E.clone().applyMatrix4(o.matrixWorld),face:null,faceIndex:null,object:o}))}},l=function(t,e,r){for(var t=t.getDescendants(),i=0,n=t.length;n>i;i++)c(t[i],e,r)};t.Raycaster.prototype.precision=1e-4,t.Raycaster.prototype.linePrecision=1,t.Raycaster.prototype.set=function(t,e){this.ray.set(t,e)},t.Raycaster.prototype.intersectObject=function(t,e){var r=[];return!0===e&&l(t,this,r),c(t,this,r),r.sort(o),r},t.Raycaster.prototype.intersectObjects=function(t,e){for(var r=[],i=0,n=t.length;n>i;i++)c(t[i],this,r),!0===e&&l(t[i],this,r);return r.sort(o),r}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this._rotation=new THREE.Euler,this._quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this._rotation._quaternion=this.quaternion,this._quaternion._euler=this.rotation,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(t){this._rotation=t,this._rotation._quaternion=this._quaternion,this._quaternion._euler=this._rotation,this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(t){this._quaternion=t,this._quaternion._euler=this._rotation,this._rotation._quaternion=this._quaternion,this._quaternion._updateEuler()},get eulerOrder(){return console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order},set eulerOrder(t){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order=t},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(t){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new THREE.Quaternion;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new THREE.Vector3;return function(e,r){return t.copy(e),t.applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this}}(),translate:function(t,e){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(e,t)},translateX:function(){var t=new THREE.Vector3(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new THREE.Vector3(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new THREE.Vector3(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new THREE.Matrix4;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new THREE.Matrix4;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(t===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(t instanceof THREE.Object3D){void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t);for(var e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof THREE.Scene&&e.__addObject(t)}},remove:function(t){var e=this.children.indexOf(t);if(-1!==e){for(t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(e,1),e=this;void 0!==e.parent;)e=e.parent;void 0!==e&&e instanceof THREE.Scene&&e.__removeObject(t)}},traverse:function(t){t(this);for(var e=0,r=this.children.length;r>e;e++)this.children[e].traverse(t)},getObjectById:function(t,e){for(var r=0,i=this.children.length;i>r;r++){var n=this.children[r];if(n.id===t||!0===e&&(n=n.getObjectById(t,e),void 0!==n))return n}},getObjectByName:function(t,e){for(var r=0,i=this.children.length;i>r;r++){var n=this.children[r];if(n.name===t||!0===e&&(n=n.getObjectByName(t,e),void 0!==n))return n}},getChildByName:function(t,e){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t,e)},getDescendants:function(t){void 0===t&&(t=[]),Array.prototype.push.apply(t,this.children);for(var e=0,r=this.children.length;r>e;e++)this.children[e].getDescendants(t);return t},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),(!0===this.matrixWorldNeedsUpdate||!0===t)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);
	for(var e=0,r=this.children.length;r>e;e++)this.children[e].updateMatrixWorld(t)},clone:function(t,e){if(void 0===t&&(t=new THREE.Object3D),void 0===e&&(e=!0),t.name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.quaternion.copy(this.quaternion),t.scale.copy(this.scale),t.renderDepth=this.renderDepth,t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData)),!0===e)for(var r=0;r<this.children.length;r++)t.add(this.children[r].clone());return t}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Projector=function(){function t(){if(a===y){var t=new THREE.RenderableVertex;return f.push(t),y++,a++,t}return f[a++]}function e(t,e){return t.z!==e.z?e.z-t.z:t.id!==e.id?t.id-e.id:0}function r(t,e){var r=0,i=1,n=t.z+t.w,o=e.z+e.w,a=-t.z+t.w,s=-e.z+e.w;return 0>n||0>o||0>a||0>s?0>n&&0>o||0>a&&0>s?!1:(0>n?r=Math.max(r,n/(n-o)):0>o&&(i=Math.min(i,n/(n-o))),0>a?r=Math.max(r,a/(a-s)):0>s&&(i=Math.min(i,a/(a-s))),r>i?!1:(t.lerp(e,r),e.lerp(t,1-i),!0)):!0}var i,n,o,a,s,h,c,l,u,p,m,d=[],E=0,f=[],y=0,g=[],v=0,T=[],x=0,R=[],w=0,H={objects:[],sprites:[],lights:[],elements:[]},b=new THREE.Vector3,M=new THREE.Vector3,_=new THREE.Vector3,S=new THREE.Vector3,z=new THREE.Vector4,V=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),O=new THREE.Box3,C=Array(3),P=new THREE.Matrix4,A=new THREE.Matrix4,L=new THREE.Matrix4,j=new THREE.Matrix3,D=new THREE.Matrix3,F=new THREE.Vector3,N=new THREE.Frustum,B=new THREE.Vector4,U=new THREE.Vector4;this.projectVector=function(t,e){return e.matrixWorldInverse.getInverse(e.matrixWorld),A.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),t.applyProjection(A)};var k=new THREE.Matrix4;this.unprojectVector=function(t,e){return k.getInverse(e.projectionMatrix),A.multiplyMatrices(e.matrixWorld,k),t.applyProjection(A)},this.pickingRay=function(t,e){t.z=-1;var r=new THREE.Vector3(t.x,t.y,1);return this.unprojectVector(t,e),this.unprojectVector(r,e),r.sub(t).normalize(),new THREE.Raycaster(t,r)};var I=function(t){if(n===E){var e=new THREE.RenderableObject;d.push(e),E++,n++,i=e}else i=d[n++];return i.id=t.id,i.object=t,null!==t.renderDepth?i.z=t.renderDepth:(S.setFromMatrixPosition(t.matrixWorld),S.applyProjection(A),i.z=S.z),i},q=function(t){var e=t.positionWorld,r=t.positionScreen;e.copy(t.position).applyMatrix4(m),r.copy(e).applyMatrix4(A),e=1/r.w,r.x*=e,r.y*=e,r.z*=e,t.visible=!(-1>r.x||1<r.x||-1>r.y||1<r.y||-1>r.z||1<r.z)},G=function(t){if(!1!==t.visible){t instanceof THREE.Light?H.lights.push(t):t instanceof THREE.Mesh||t instanceof THREE.Line?(!1===t.frustumCulled||!0===N.intersectsObject(t))&&H.objects.push(I(t)):t instanceof THREE.Sprite&&H.sprites.push(I(t));for(var e=0,r=t.children.length;r>e;e++)G(t.children[e])}};this.projectScene=function(i,d,E,y){var S,k,I,W,Y,X,Q,Z,J,$=!1;p=l=h=0,H.elements.length=0,!0===i.autoUpdate&&i.updateMatrixWorld(),void 0===d.parent&&d.updateMatrixWorld(),P.copy(d.matrixWorldInverse.getInverse(d.matrixWorld)),A.multiplyMatrices(d.projectionMatrix,P),D.getNormalMatrix(P),N.setFromMatrix(A),n=0,H.objects.length=0,H.sprites.length=0,H.lights.length=0,G(i),!0===E&&H.objects.sort(e);for(var E=0,K=H.objects.length;K>E;E++)if(i=H.objects[E].object,m=i.matrixWorld,a=0,i instanceof THREE.Mesh){S=i.geometry,k=S.vertices,I=S.faces,Y=S.faceVertexUvs,j.getNormalMatrix(m),Z=i.material instanceof THREE.MeshFaceMaterial,J=!0===Z?i.material:null;for(var te=0,ee=k.length;ee>te;te++)o=t(),o.position.copy(k[te]),q(o);for(te=0,ee=I.length;ee>te;te++){k=I[te];var re=!0===Z?J.materials[k.materialIndex]:i.material;if(void 0!==re){var ie=re.side;if(W=f[k.a],X=f[k.b],Q=f[k.c],!0===re.morphTargets){var $=S.morphTargets,ne=i.morphTargetInfluences,oe=W.position,ae=X.position,se=Q.position;b.set(0,0,0),M.set(0,0,0),_.set(0,0,0);for(var he=0,ce=$.length;ce>he;he++){var le=ne[he];if(0!==le){var ue=$[he].vertices;b.x+=(ue[k.a].x-oe.x)*le,b.y+=(ue[k.a].y-oe.y)*le,b.z+=(ue[k.a].z-oe.z)*le,M.x+=(ue[k.b].x-ae.x)*le,M.y+=(ue[k.b].y-ae.y)*le,M.z+=(ue[k.b].z-ae.z)*le,_.x+=(ue[k.c].x-se.x)*le,_.y+=(ue[k.c].y-se.y)*le,_.z+=(ue[k.c].z-se.z)*le}}W.position.add(b),X.position.add(M),Q.position.add(_),q(W),q(X),q(Q)}if(C[0]=W.positionScreen,C[1]=X.positionScreen,C[2]=Q.positionScreen,(!0===W.visible||!0===X.visible||!0===Q.visible||V.isIntersectionBox(O.setFromPoints(C)))&&($=0>(Q.positionScreen.x-W.positionScreen.x)*(X.positionScreen.y-W.positionScreen.y)-(Q.positionScreen.y-W.positionScreen.y)*(X.positionScreen.x-W.positionScreen.x),ie===THREE.DoubleSide||$===(ie===THREE.FrontSide))){for(h===v?(ne=new THREE.RenderableFace3,g.push(ne),v++,h++,s=ne):s=g[h++],s.id=i.id,s.v1.copy(W),s.v2.copy(X),s.v3.copy(Q),s.normalModel.copy(k.normal),!1===$&&(ie===THREE.BackSide||ie===THREE.DoubleSide)&&s.normalModel.negate(),s.normalModel.applyMatrix3(j).normalize(),s.normalModelView.copy(s.normalModel).applyMatrix3(D),s.centroidModel.copy(k.centroid).applyMatrix4(m),W=k.vertexNormals,X=0,Q=Math.min(W.length,3);Q>X;X++)ne=s.vertexNormalsModel[X],ne.copy(W[X]),!1===$&&(ie===THREE.BackSide||ie===THREE.DoubleSide)&&ne.negate(),ne.applyMatrix3(j).normalize(),s.vertexNormalsModelView[X].copy(ne).applyMatrix3(D);for(s.vertexNormalsLength=W.length,X=0,ie=Math.min(Y.length,3);ie>X;X++)if(W=Y[X][te],void 0!==W)for(Q=0,$=W.length;$>Q;Q++)s.uvs[X][Q]=W[Q];s.color=k.color,s.material=re,F.copy(s.centroidModel).applyProjection(A),s.z=F.z,H.elements.push(s)}}}}else if(i instanceof THREE.Line)for(L.multiplyMatrices(A,m),k=i.geometry.vertices,W=t(),W.positionScreen.copy(k[0]).applyMatrix4(L),S=i.type===THREE.LinePieces?2:1,te=1,ee=k.length;ee>te;te++)W=t(),W.positionScreen.copy(k[te]).applyMatrix4(L),(te+1)%S>0||(X=f[a-2],B.copy(W.positionScreen),U.copy(X.positionScreen),!0===r(B,U)&&(B.multiplyScalar(1/B.w),U.multiplyScalar(1/U.w),l===x?(I=new THREE.RenderableLine,T.push(I),x++,l++,c=I):c=T[l++],c.id=i.id,c.v1.positionScreen.copy(B),c.v2.positionScreen.copy(U),c.z=Math.max(B.z,U.z),c.material=i.material,i.material.vertexColors===THREE.VertexColors&&(c.vertexColors[0].copy(i.geometry.colors[te]),c.vertexColors[1].copy(i.geometry.colors[te-1])),H.elements.push(c)));for(E=0,K=H.sprites.length;K>E;E++)i=H.sprites[E].object,m=i.matrixWorld,z.set(m.elements[12],m.elements[13],m.elements[14],1),z.applyMatrix4(A),S=1/z.w,z.z*=S,-1<=z.z&&1>=z.z&&(p===w?(I=new THREE.RenderableSprite,R.push(I),w++,p++,u=I):u=R[p++],u.id=i.id,u.x=z.x*S,u.y=z.y*S,u.z=z.z,u.object=i,u.rotation=i.rotation,u.scale.x=i.scale.x*Math.abs(u.x-(z.x+d.projectionMatrix.elements[0])/(z.w+d.projectionMatrix.elements[12])),u.scale.y=i.scale.y*Math.abs(u.y-(z.y+d.projectionMatrix.elements[5])/(z.w+d.projectionMatrix.elements[13])),u.material=i.material,H.elements.push(u));return!0===y&&H.elements.sort(e),H}},THREE.Face3=function(t,e,r,i,n,o){this.a=t,this.b=e,this.c=r,this.normal=i instanceof THREE.Vector3?i:new THREE.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=n instanceof THREE.Color?n:new THREE.Color,this.vertexColors=n instanceof Array?n:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var t=new THREE.Face3(this.a,this.b,this.c);t.normal.copy(this.normal),t.color.copy(this.color),t.centroid.copy(this.centroid),t.materialIndex=this.materialIndex;var e,r;for(e=0,r=this.vertexNormals.length;r>e;e++)t.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,r=this.vertexColors.length;r>e;e++)t.vertexColors[e]=this.vertexColors[e].clone();for(e=0,r=this.vertexTangents.length;r>e;e++)t.vertexTangents[e]=this.vertexTangents[e].clone();return t}},THREE.Face4=function(t,e,r,i,n,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(t,e,r,n,o,a)},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.dynamic=!0,this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(t){for(var e=(new THREE.Matrix3).getNormalMatrix(t),r=0,i=this.vertices.length;i>r;r++)this.vertices[r].applyMatrix4(t);for(r=0,i=this.faces.length;i>r;r++){var n=this.faces[r];n.normal.applyMatrix3(e).normalize();for(var o=0,a=n.vertexNormals.length;a>o;o++)n.vertexNormals[o].applyMatrix3(e).normalize();n.centroid.applyMatrix4(t)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var t,e,r;for(t=0,e=this.faces.length;e>t;t++)r=this.faces[t],r.centroid.set(0,0,0),r.centroid.add(this.vertices[r.a]),r.centroid.add(this.vertices[r.b]),r.centroid.add(this.vertices[r.c]),r.centroid.divideScalar(3)},computeFaceNormals:function(){for(var t=new THREE.Vector3,e=new THREE.Vector3,r=0,i=this.faces.length;i>r;r++){var n=this.faces[r],o=this.vertices[n.a],a=this.vertices[n.b];t.subVectors(this.vertices[n.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),n.normal.copy(t)}},computeVertexNormals:function(t){var e,r,i;for(i=Array(this.vertices.length),e=0,r=this.vertices.length;r>e;e++)i[e]=new THREE.Vector3;if(t){var n,o,a,s=new THREE.Vector3,h=new THREE.Vector3;for(new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,t=0,e=this.faces.length;e>t;t++)r=this.faces[t],n=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c],s.subVectors(a,o),h.subVectors(n,o),s.cross(h),i[r.a].add(s),i[r.b].add(s),i[r.c].add(s)}else for(t=0,e=this.faces.length;e>t;t++)r=this.faces[t],i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal);for(e=0,r=this.vertices.length;r>e;e++)i[e].normalize();for(t=0,e=this.faces.length;e>t;t++)r=this.faces[t],r.vertexNormals[0]=i[r.a].clone(),r.vertexNormals[1]=i[r.b].clone(),r.vertexNormals[2]=i[r.c].clone()},computeMorphNormals:function(){var t,e,r,i,n;for(r=0,i=this.faces.length;i>r;r++)for(n=this.faces[r],n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),t=0,e=n.vertexNormals.length;e>t;t++)n.__originalVertexNormals[t]?n.__originalVertexNormals[t].copy(n.vertexNormals[t]):n.__originalVertexNormals[t]=n.vertexNormals[t].clone();var o=new THREE.Geometry;for(o.faces=this.faces,t=0,e=this.morphTargets.length;e>t;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],n=this.morphNormals[t].faceNormals;var a,s,h=this.morphNormals[t].vertexNormals;for(r=0,i=this.faces.length;i>r;r++)a=new THREE.Vector3,s={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},n.push(a),h.push(s)}for(h=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,i=this.faces.length;i>r;r++)n=this.faces[r],a=h.faceNormals[r],s=h.vertexNormals[r],a.copy(n.normal),s.a.copy(n.vertexNormals[0]),s.b.copy(n.vertexNormals[1]),s.c.copy(n.vertexNormals[2])}for(r=0,i=this.faces.length;i>r;r++)n=this.faces[r],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeTangents:function(){var t,e,r,i,n,o,a,s,h,c,l,u,p,m,d,E,f,y=[],g=[];r=new THREE.Vector3;var v=new THREE.Vector3,T=new THREE.Vector3,x=new THREE.Vector3,R=new THREE.Vector3;for(t=0,e=this.vertices.length;e>t;t++)y[t]=new THREE.Vector3,g[t]=new THREE.Vector3;for(t=0,e=this.faces.length;e>t;t++)n=this.faces[t],o=this.faceVertexUvs[0][t],i=n.a,f=n.b,n=n.c,a=this.vertices[i],s=this.vertices[f],h=this.vertices[n],c=o[0],l=o[1],u=o[2],o=s.x-a.x,p=h.x-a.x,m=s.y-a.y,d=h.y-a.y,s=s.z-a.z,a=h.z-a.z,h=l.x-c.x,E=u.x-c.x,l=l.y-c.y,c=u.y-c.y,u=1/(h*c-E*l),r.set((c*o-l*p)*u,(c*m-l*d)*u,(c*s-l*a)*u),v.set((h*p-E*o)*u,(h*d-E*m)*u,(h*a-E*s)*u),y[i].add(r),y[f].add(r),y[n].add(r),g[i].add(v),g[f].add(v),g[n].add(v);for(v=["a","b","c","d"],t=0,e=this.faces.length;e>t;t++)for(n=this.faces[t],r=0;r<Math.min(n.vertexNormals.length,3);r++)R.copy(n.vertexNormals[r]),i=n[v[r]],f=y[i],T.copy(f),T.sub(R.multiplyScalar(R.dot(f))).normalize(),x.crossVectors(n.vertexNormals[r],f),i=x.dot(g[i]),i=0>i?-1:1,n.vertexTangents[r]=new THREE.Vector4(T.x,T.y,T.z,i);this.hasTangents=!0},computeLineDistances:function(){for(var t=0,e=this.vertices,r=0,i=e.length;i>r;r++)r>0&&(t+=e[r].distanceTo(e[r-1])),this.lineDistances[r]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var t,e,r,i={},n=[],o=[],a=Math.pow(10,4);for(e=0,r=this.vertices.length;r>e;e++)t=this.vertices[e],t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a),void 0===i[t]?(i[t]=e,n.push(this.vertices[e]),o[e]=n.length-1):o[e]=o[i[t]];for(i=[],e=0,r=this.faces.length;r>e;e++)for(a=this.faces[e],a.a=o[a.a],a.b=o[a.b],a.c=o[a.c],a=[a.a,a.b,a.c],t=0;3>t;t++)if(a[t]==a[(t+1)%3]){i.push(e);break}for(e=i.length-1;e>=0;e--)for(a=i[e],this.faces.splice(a,1),o=0,r=this.faceVertexUvs.length;r>o;o++)this.faceVertexUvs[o].splice(a,1);return e=this.vertices.length-n.length,this.vertices=n,e},clone:function(){for(var t=new THREE.Geometry,e=this.vertices,r=0,i=e.length;i>r;r++)t.vertices.push(e[r].clone());for(e=this.faces,r=0,i=e.length;i>r;r++)t.faces.push(e[r].clone());for(e=this.faceVertexUvs[0],r=0,i=e.length;i>r;r++){for(var n=e[r],o=[],a=0,s=n.length;s>a;a++)o.push(new THREE.Vector2(n[a].x,n[a].y));t.faceVertexUvs[0].push(o)}return t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.attributes={},this.dynamic=!0,this.offsets=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(t,e,r,i){this.attributes[t]={itemSize:i,array:new e(r*i)}},applyMatrix:function(t){var e,r;this.attributes.position&&(e=this.attributes.position.array),this.attributes.normal&&(r=this.attributes.normal.array),void 0!==e&&(t.multiplyVector3Array(e),this.verticesNeedUpdate=!0),void 0!==r&&((new THREE.Matrix3).getNormalMatrix(t).multiplyVector3Array(r),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.attributes.position.array;if(t){var e,r,i,n=this.boundingBox;3<=t.length&&(n.min.x=n.max.x=t[0],n.min.y=n.max.y=t[1],n.min.z=n.max.z=t[2]);for(var o=3,a=t.length;a>o;o+=3)e=t[o],r=t[o+1],i=t[o+2],e<n.min.x?n.min.x=e:e>n.max.x&&(n.max.x=e),r<n.min.y?n.min.y=r:r>n.max.y&&(n.max.y=r),i<n.min.z?n.min.z=i:i>n.max.z&&(n.max.z=i)}(void 0===t||0===t.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){var t=new THREE.Box3,e=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var r=this.attributes.position.array;if(r){t.makeEmpty();for(var i=this.boundingSphere.center,n=0,o=r.length;o>n;n+=3)e.set(r[n],r[n+1],r[n+2]),t.addPoint(e);t.center(i);for(var a=0,n=0,o=r.length;o>n;n+=3)e.set(r[n],r[n+1],r[n+2]),a=Math.max(a,i.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(a)}}}(),computeVertexNormals:function(){if(this.attributes.position){var t,e,r,i;if(t=this.attributes.position.array.length,void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(t)};else for(t=0,e=this.attributes.normal.array.length;e>t;t++)this.attributes.normal.array[t]=0;var n,o,a,s,h,c,l=this.attributes.position.array,u=this.attributes.normal.array,p=new THREE.Vector3,m=new THREE.Vector3,d=new THREE.Vector3,E=new THREE.Vector3,f=new THREE.Vector3;if(this.attributes.index){var y=this.attributes.index.array,g=this.offsets;for(r=0,i=g.length;i>r;++r){e=g[r].start,n=g[r].count;var v=g[r].index;for(t=e,e+=n;e>t;t+=3)n=v+y[t],o=v+y[t+1],a=v+y[t+2],s=l[3*n],h=l[3*n+1],c=l[3*n+2],p.set(s,h,c),s=l[3*o],h=l[3*o+1],c=l[3*o+2],m.set(s,h,c),s=l[3*a],h=l[3*a+1],c=l[3*a+2],d.set(s,h,c),E.subVectors(d,m),f.subVectors(p,m),E.cross(f),u[3*n]+=E.x,u[3*n+1]+=E.y,u[3*n+2]+=E.z,u[3*o]+=E.x,u[3*o+1]+=E.y,u[3*o+2]+=E.z,u[3*a]+=E.x,u[3*a+1]+=E.y,u[3*a+2]+=E.z}}else for(t=0,e=l.length;e>t;t+=9)s=l[t],h=l[t+1],c=l[t+2],p.set(s,h,c),s=l[t+3],h=l[t+4],c=l[t+5],m.set(s,h,c),s=l[t+6],h=l[t+7],c=l[t+8],d.set(s,h,c),E.subVectors(d,m),f.subVectors(p,m),E.cross(f),u[t]=E.x,u[t+1]=E.y,u[t+2]=E.z,u[t+3]=E.x,u[t+4]=E.y,u[t+5]=E.z,u[t+6]=E.x,u[t+7]=E.y,u[t+8]=E.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var t,e,r,i=this.attributes.normal.array,n=0,o=i.length;o>n;n+=3)t=i[n],e=i[n+1],r=i[n+2],t=1/Math.sqrt(t*t+e*e+r*r),i[n]*=t,i[n+1]*=t,i[n+2]*=t},computeTangents:function(){function t(t){N.x=i[3*t],N.y=i[3*t+1],N.z=i[3*t+2],B.copy(N),L=s[t],D.copy(L),D.sub(N.multiplyScalar(N.dot(L))).normalize(),F.crossVectors(B,L),j=F.dot(h[t]),A=0>j?-1:1,a[4*t]=D.x,a[4*t+1]=D.y,a[4*t+2]=D.z,a[4*t+3]=A}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var e=this.attributes.index.array,r=this.attributes.position.array,i=this.attributes.normal.array,n=this.attributes.uv.array,o=r.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={itemSize:4,array:new Float32Array(4*o)});for(var a=this.attributes.tangent.array,s=[],h=[],c=0;o>c;c++)s[c]=new THREE.Vector3,h[c]=new THREE.Vector3;var l,u,p,m,d,E,f,y,g,v,T,x,R,w,H,b,M,_,S,z,V,O,o=new THREE.Vector3,c=new THREE.Vector3,C=this.offsets;for(_=0,S=C.length;S>_;++_){M=C[_].start,z=C[_].count;var P=C[_].index;for(b=M,M+=z;M>b;b+=3)z=P+e[b],V=P+e[b+1],O=P+e[b+2],l=r[3*z],u=r[3*z+1],p=r[3*z+2],m=r[3*V],d=r[3*V+1],E=r[3*V+2],f=r[3*O],y=r[3*O+1],g=r[3*O+2],v=n[2*z],T=n[2*z+1],x=n[2*V],R=n[2*V+1],w=n[2*O],H=n[2*O+1],m-=l,l=f-l,d-=u,u=y-u,E-=p,p=g-p,x-=v,v=w-v,R-=T,T=H-T,H=1/(x*T-v*R),o.set((T*m-R*l)*H,(T*d-R*u)*H,(T*E-R*p)*H),c.set((x*l-v*m)*H,(x*u-v*d)*H,(x*p-v*E)*H),s[z].add(o),s[V].add(o),s[O].add(o),h[z].add(c),h[V].add(c),h[O].add(c)}var A,L,j,D=new THREE.Vector3,F=new THREE.Vector3,N=new THREE.Vector3,B=new THREE.Vector3;for(_=0,S=C.length;S>_;++_)for(M=C[_].start,z=C[_].count,P=C[_].index,b=M,M+=z;M>b;b+=3)z=P+e[b],V=P+e[b+1],O=P+e[b+2],t(z),t(V),t(O);this.tangentsNeedUpdate=this.hasTangents=!0}},clone:function(){var t,e=new THREE.BufferGeometry,r=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];for(t in this.attributes){for(var i=this.attributes[t],n=i.array,o={itemSize:i.itemSize,numItems:i.numItems,array:null},i=0,a=r.length;a>i;i++){var s=r[i];if(n instanceof s){o.array=new s(n);break}}e.attributes[t]=o}for(i=0,a=this.offsets.length;a>i;i++)r=this.offsets[i],e.offsets.push({start:r.start,index:r.index,count:r.count});return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var t=new THREE.Matrix4;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),THREE.Camera.prototype.clone=function(t){return void 0===t&&(t=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,t),t.matrixWorldInverse.copy(this.matrixWorldInverse),t.projectionMatrix.copy(this.projectionMatrix),t},THREE.OrthographicCamera=function(t,e,r,i,n,o){THREE.Camera.call(this),this.left=t,this.right=e,this.top=r,this.bottom=i,this.near=void 0!==n?n:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var t=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,t),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t},THREE.PerspectiveCamera=function(t,e,r,i){THREE.Camera.call(this),this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==r?r:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*THREE.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(t,e,r,i,n,o){this.fullWidth=t,this.fullHeight=e,this.x=r,this.y=i,this.width=n,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var t=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,r=-e,i=t*r,t=Math.abs(t*e-i),r=Math.abs(e-r);this.projectionMatrix.makeFrustum(i+this.x*t/this.fullWidth,i+(this.x+this.width)*t/this.fullWidth,e-(this.y+this.height)*r/this.fullHeight,e-this.y*r/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var t=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,t),t.fov=this.fov,t.aspect=this.aspect,t.near=this.near,t.far=this.far,t},THREE.Light=function(t){THREE.Object3D.call(this),this.color=new THREE.Color(t)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(t){return void 0===t&&(t=new THREE.Light),THREE.Object3D.prototype.clone.call(this,t),t.color.copy(this.color),t},THREE.Loader=function(t){this.statusDomElement=(this.showStatus=t)?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var t=document.createElement("div");return t.style.position="absolute",t.style.right="0px",t.style.top="0px",t.style.fontSize="0.8em",t.style.textAlign="left",t.style.background="rgba(0,0,0,0.25)",t.style.color="#fff",t.style.width="120px",t.style.padding="0.5em 0.5em 0.5em 0.5em",t.style.zIndex=1e3,t.innerHTML="Loading ...",t},updateProgress:function(t){var e="Loaded ",e=t.total?e+((100*t.loaded/t.total).toFixed(0)+"%"):e+((t.loaded/1e3).toFixed(2)+" KB");this.statusDomElement.innerHTML=e},extractUrlBase:function(t){return t=t.split("/"),t.pop(),(1>t.length?".":t.join("/"))+"/"},initMaterials:function(t,e){for(var r=[],i=0;i<t.length;++i)r[i]=THREE.Loader.prototype.createMaterial(t[i],e);return r},needsTangents:function(t){for(var e=0,r=t.length;r>e;e++)if(t[e]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(t,e){function r(t){return t=Math.log(t)/Math.LN2,Math.floor(t)==t}function i(t){return t=Math.log(t)/Math.LN2,Math.pow(2,Math.round(t))}function n(t,n,o,s,h,c,l){var u=/\.dds$/i.test(o),p=e+"/"+o;if(u){var m=THREE.ImageUtils.loadCompressedTexture(p);t[n]=m}else m=document.createElement("canvas"),t[n]=new THREE.Texture(m);if(t[n].sourceFile=o,s&&(t[n].repeat.set(s[0],s[1]),1!==s[0]&&(t[n].wrapS=THREE.RepeatWrapping),1!==s[1]&&(t[n].wrapT=THREE.RepeatWrapping)),h&&t[n].offset.set(h[0],h[1]),c&&(o={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==o[c[0]]&&(t[n].wrapS=o[c[0]]),void 0!==o[c[1]]&&(t[n].wrapT=o[c[1]])),l&&(t[n].anisotropy=l),!u){var d=t[n],t=new Image;t.onload=function(){if(r(this.width)&&r(this.height))d.image=this;else{var t=i(this.width),e=i(this.height);d.image.width=t,d.image.height=e,d.image.getContext("2d").drawImage(this,0,0,t,e)}d.needsUpdate=!0},void 0!==a.crossOrigin&&(t.crossOrigin=a.crossOrigin),t.src=p}}function o(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]}var a=this,s="MeshLambertMaterial",h={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(t.shading){var c=t.shading.toLowerCase();"phong"===c?s="MeshPhongMaterial":"basic"===c&&(s="MeshBasicMaterial")}return void 0!==t.blending&&void 0!==THREE[t.blending]&&(h.blending=THREE[t.blending]),(void 0!==t.transparent||1>t.opacity)&&(h.transparent=t.transparent),void 0!==t.depthTest&&(h.depthTest=t.depthTest),void 0!==t.depthWrite&&(h.depthWrite=t.depthWrite),void 0!==t.visible&&(h.visible=t.visible),void 0!==t.flipSided&&(h.side=THREE.BackSide),void 0!==t.doubleSided&&(h.side=THREE.DoubleSide),void 0!==t.wireframe&&(h.wireframe=t.wireframe),void 0!==t.vertexColors&&("face"===t.vertexColors?h.vertexColors=THREE.FaceColors:t.vertexColors&&(h.vertexColors=THREE.VertexColors)),t.colorDiffuse?h.color=o(t.colorDiffuse):t.DbgColor&&(h.color=t.DbgColor),t.colorSpecular&&(h.specular=o(t.colorSpecular)),t.colorAmbient&&(h.ambient=o(t.colorAmbient)),t.transparency&&(h.opacity=t.transparency),t.specularCoef&&(h.shininess=t.specularCoef),t.mapDiffuse&&e&&n(h,"map",t.mapDiffuse,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy),t.mapLight&&e&&n(h,"lightMap",t.mapLight,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy),t.mapBump&&e&&n(h,"bumpMap",t.mapBump,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy),t.mapNormal&&e&&n(h,"normalMap",t.mapNormal,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy),t.mapSpecular&&e&&n(h,"specularMap",t.mapSpecular,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy),t.mapBumpScale&&(h.bumpScale=t.mapBumpScale),t.mapNormal?(s=THREE.ShaderLib.normalmap,c=THREE.UniformsUtils.clone(s.uniforms),c.tNormal.value=h.normalMap,t.mapNormalFactor&&c.uNormalScale.value.set(t.mapNormalFactor,t.mapNormalFactor),h.map&&(c.tDiffuse.value=h.map,c.enableDiffuse.value=!0),h.specularMap&&(c.tSpecular.value=h.specularMap,c.enableSpecular.value=!0),h.lightMap&&(c.tAO.value=h.lightMap,c.enableAO.value=!0),c.diffuse.value.setHex(h.color),c.specular.value.setHex(h.specular),c.ambient.value.setHex(h.ambient),c.shininess.value=h.shininess,void 0!==h.opacity&&(c.opacity.value=h.opacity),s=new THREE.ShaderMaterial({fragmentShader:s.fragmentShader,vertexShader:s.vertexShader,uniforms:c,lights:!0,fog:!0}),h.transparent&&(s.transparent=!0)):s=new THREE[s](h),void 0!==t.DbgName&&(s.name=t.DbgName),s}},THREE.XHRLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(t,e,r,i){var n=this,o=new XMLHttpRequest;void 0!==e&&o.addEventListener("load",function(r){e(r.target.responseText),n.manager.itemEnd(t)},!1),void 0!==r&&o.addEventListener("progress",function(t){r(t)},!1),void 0!==i&&o.addEventListener("error",function(t){i(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.open("GET",t,!0),o.send(null),n.manager.itemStart(t)},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.ImageLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(t,e,r,i){var n=this,o=document.createElement("img");return void 0!==e&&o.addEventListener("load",function(){n.manager.itemEnd(t),e(this)},!1),void 0!==r&&o.addEventListener("progress",function(t){r(t)},!1),void 0!==i&&o.addEventListener("error",function(t){i(t)},!1),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.src=t,n.manager.itemStart(t),o},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.JSONLoader=function(t){THREE.Loader.call(this,t),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(t,e,r){r=r&&"string"==typeof r?r:this.extractUrlBase(t),this.onLoadStart(),this.loadAjaxJSON(this,t,e,r)},THREE.JSONLoader.prototype.loadAjaxJSON=function(t,e,r,i,n){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),s=t.parse(s,i);r(s.geometry,s.materials)}else console.warn("THREE.JSONLoader: ["+e+"] seems to be unreachable or file there is empty");t.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+e+"] ["+o.status+"]");else o.readyState===o.LOADING?n&&(0===a&&(a=o.getResponseHeader("Content-Length")),n({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==n&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",e,!0),o.withCredentials=this.withCredentials,o.send(null)},THREE.JSONLoader.prototype.parse=function(t,e){var r,i,n,o,a,s,h,c,l,u,p,m,d,E,f=new THREE.Geometry,y=void 0!==t.scale?1/t.scale:1,g=t.faces;l=t.vertices;var v=t.normals,T=t.colors,x=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&x++;for(r=0;x>r;r++)f.faceVertexUvs[r]=[]}for(o=0,a=l.length;a>o;)s=new THREE.Vector3,s.x=l[o++]*y,s.y=l[o++]*y,s.z=l[o++]*y,f.vertices.push(s);for(o=0,a=g.length;a>o;)if(l=g[o++],u=1&l,n=2&l,r=8&l,h=16&l,p=32&l,s=64&l,l&=128,u){if(u=new THREE.Face3,u.a=g[o],u.b=g[o+1],u.c=g[o+3],m=new THREE.Face3,m.a=g[o+1],m.b=g[o+2],m.c=g[o+3],o+=4,n&&(n=g[o++],u.materialIndex=n,m.materialIndex=n),n=f.faces.length,r)for(r=0;x>r;r++)for(d=t.uvs[r],f.faceVertexUvs[r][n]=[],f.faceVertexUvs[r][n+1]=[],i=0;4>i;i++)c=g[o++],E=d[2*c],c=d[2*c+1],E=new THREE.Vector2(E,c),2!==i&&f.faceVertexUvs[r][n].push(E),0!==i&&f.faceVertexUvs[r][n+1].push(E);if(h&&(h=3*g[o++],u.normal.set(v[h++],v[h++],v[h]),m.normal.copy(u.normal)),p)for(r=0;4>r;r++)h=3*g[o++],p=new THREE.Vector3(v[h++],v[h++],v[h]),2!==r&&u.vertexNormals.push(p),0!==r&&m.vertexNormals.push(p);if(s&&(s=g[o++],s=T[s],u.color.setHex(s),m.color.setHex(s)),l)for(r=0;4>r;r++)s=g[o++],s=T[s],2!==r&&u.vertexColors.push(new THREE.Color(s)),0!==r&&m.vertexColors.push(new THREE.Color(s));f.faces.push(u),f.faces.push(m)}else{if(u=new THREE.Face3,u.a=g[o++],u.b=g[o++],u.c=g[o++],n&&(n=g[o++],u.materialIndex=n),n=f.faces.length,r)for(r=0;x>r;r++)for(d=t.uvs[r],f.faceVertexUvs[r][n]=[],i=0;3>i;i++)c=g[o++],E=d[2*c],c=d[2*c+1],E=new THREE.Vector2(E,c),f.faceVertexUvs[r][n].push(E);if(h&&(h=3*g[o++],u.normal.set(v[h++],v[h++],v[h])),p)for(r=0;3>r;r++)h=3*g[o++],p=new THREE.Vector3(v[h++],v[h++],v[h]),u.vertexNormals.push(p);if(s&&(s=g[o++],u.color.setHex(T[s])),l)for(r=0;3>r;r++)s=g[o++],u.vertexColors.push(new THREE.Color(T[s]));f.faces.push(u)}if(t.skinWeights)for(o=0,a=t.skinWeights.length;a>o;o+=2)g=t.skinWeights[o],v=t.skinWeights[o+1],f.skinWeights.push(new THREE.Vector4(g,v,0,0));if(t.skinIndices)for(o=0,a=t.skinIndices.length;a>o;o+=2)g=t.skinIndices[o],v=t.skinIndices[o+1],f.skinIndices.push(new THREE.Vector4(g,v,0,0));if(f.bones=t.bones,f.animation=t.animation,f.animations=t.animations,void 0!==t.morphTargets)for(o=0,a=t.morphTargets.length;a>o;o++)for(f.morphTargets[o]={},f.morphTargets[o].name=t.morphTargets[o].name,f.morphTargets[o].vertices=[],T=f.morphTargets[o].vertices,x=t.morphTargets[o].vertices,g=0,v=x.length;v>g;g+=3)l=new THREE.Vector3,l.x=x[g]*y,l.y=x[g+1]*y,l.z=x[g+2]*y,T.push(l);
	if(void 0!==t.morphColors)for(o=0,a=t.morphColors.length;a>o;o++)for(f.morphColors[o]={},f.morphColors[o].name=t.morphColors[o].name,f.morphColors[o].colors=[],v=f.morphColors[o].colors,T=t.morphColors[o].colors,y=0,g=T.length;g>y;y+=3)x=new THREE.Color(16755200),x.setRGB(T[y],T[y+1],T[y+2]),v.push(x);return f.computeCentroids(),f.computeFaceNormals(),f.computeBoundingSphere(),void 0===t.materials?{geometry:f}:(y=this.initMaterials(t.materials,e),this.needsTangents(y)&&f.computeTangents(),{geometry:f,materials:y})},THREE.LoadingManager=function(t,e,r){var i=this,n=0,o=0;this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(){o++},this.itemEnd=function(t){n++,void 0!==i.onProgress&&i.onProgress(t,n,o),n===o&&void 0!==i.onLoad&&i.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(t,e){var r=this,i=new THREE.XHRLoader;i.setCrossOrigin(this.crossOrigin),i.load(t,function(t){e(r.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e,r=new THREE.BufferGeometry,i=t.attributes,n=t.offsets,t=t.boundingSphere;for(e in i){var o=i[e];r.attributes[e]={itemSize:o.itemSize,array:new self[o.type](o.array)}}return void 0!==n&&(r.offsets=JSON.parse(JSON.stringify(n))),void 0!==t&&(r.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==t.center?t.center:[0,0,0]),t.radius)),r}},THREE.GeometryLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(t,e){var r=this,i=new THREE.XHRLoader;i.setCrossOrigin(this.crossOrigin),i.load(t,function(t){e(r.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(){}},THREE.MaterialLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(t,e){var r=this,i=new THREE.XHRLoader;i.setCrossOrigin(this.crossOrigin),i.load(t,function(t){e(r.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=new THREE[t.type];if(void 0!==t.color&&e.color.setHex(t.color),void 0!==t.ambient&&e.ambient.setHex(t.ambient),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.materials)for(var r=0,i=t.materials.length;i>r;r++)e.materials.push(this.parse(t.materials[r]));return e}},THREE.ObjectLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(t,e){var r=this,i=new THREE.XHRLoader(r.manager);i.setCrossOrigin(this.crossOrigin),i.load(t,function(t){e(r.parse(JSON.parse(t)))})},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=this.parseGeometries(t.geometries),r=this.parseMaterials(t.materials);return this.parseObject(t.object,e,r)},parseGeometries:function(t){var e={};if(void 0!==t)for(var r=new THREE.JSONLoader,i=new THREE.BufferGeometryLoader,n=0,o=t.length;o>n;n++){var a,s=t[n];switch(s.type){case"PlaneGeometry":a=new THREE.PlaneGeometry(s.width,s.height,s.widthSegments,s.heightSegments);break;case"CircleGeometry":a=new THREE.CircleGeometry(s.radius,s.segments);break;case"CubeGeometry":a=new THREE.CubeGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CylinderGeometry":a=new THREE.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded);break;case"SphereGeometry":a=new THREE.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"TorusGeometry":a=new THREE.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new THREE.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=i.parse(s.data);break;case"Geometry":a=r.parse(s.data).geometry}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t){var e={};if(void 0!==t)for(var r=new THREE.MaterialLoader,i=0,n=t.length;n>i;i++){var o=t[i],a=r.parse(o);a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),e[o.uuid]=a}return e},parseObject:function(){var t=new THREE.Matrix4;return function(e,r,i){var n;switch(e.type){case"Scene":n=new THREE.Scene;break;case"PerspectiveCamera":n=new THREE.PerspectiveCamera(e.fov,e.aspect,e.near,e.far);break;case"OrthographicCamera":n=new THREE.OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":n=new THREE.AmbientLight(e.color);break;case"DirectionalLight":n=new THREE.DirectionalLight(e.color,e.intensity);break;case"PointLight":n=new THREE.PointLight(e.color,e.intensity,e.distance);break;case"SpotLight":n=new THREE.SpotLight(e.color,e.intensity,e.distance,e.angle,e.exponent);break;case"HemisphereLight":n=new THREE.HemisphereLight(e.color,e.groundColor,e.intensity);break;case"Mesh":n=r[e.geometry];var o=i[e.material];void 0===n&&console.error("THREE.ObjectLoader: Undefined geometry "+e.geometry),void 0===o&&console.error("THREE.ObjectLoader: Undefined material "+e.material),n=new THREE.Mesh(n,o);break;case"Sprite":o=i[e.material],void 0===o&&console.error("THREE.ObjectLoader: Undefined material "+e.material),n=new THREE.Sprite(o);break;default:n=new THREE.Object3D}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.children)for(var a in e.children)n.add(this.parseObject(e.children[a],r,i));return n}}()},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlers={},this.hierarchyHandlers={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(t,e){var r=this,i=new THREE.XHRLoader(r.manager);i.setCrossOrigin(this.crossOrigin),i.load(t,function(i){r.parse(JSON.parse(i),e,t)})},setCrossOrigin:function(t){this.crossOrigin=t},addGeometryHandler:function(t,e){this.geometryHandlers[t]={loaderClass:e}},addHierarchyHandler:function(t,e){this.hierarchyHandlers[t]={loaderClass:e}},parse:function(t,e,r){function i(t,e){return"relativeToHTML"==e?t:H+"/"+t}function n(){o(x.scene,M.objects)}function o(t,e){var r,n,a,h,c,l;for(l in e){var d=x.objects[l],E=e[l];if(void 0===d){if(E.type&&E.type in w.hierarchyHandlers){if(void 0===E.loading){r={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var y,g={};for(y in E)y in r||(g[y]=E[y]);p=x.materials[E.material],E.loading=!0,r=w.hierarchyHandlers[E.type].loaderObject,r.options?r.load(i(E.url,M.urlBaseType),s(l,t,p,E)):r.load(i(E.url,M.urlBaseType),s(l,t,p,E),g)}}else if(void 0!==E.geometry){if(u=x.geometries[E.geometry]){if(d=!1,p=x.materials[E.material],d=p instanceof THREE.ShaderMaterial,n=E.position,a=E.rotation,h=E.scale,r=E.matrix,c=E.quaternion,E.material||(p=new THREE.MeshFaceMaterial(x.face_materials[E.geometry])),p instanceof THREE.MeshFaceMaterial&&0===p.materials.length&&(p=new THREE.MeshFaceMaterial(x.face_materials[E.geometry])),p instanceof THREE.MeshFaceMaterial)for(g=0;g<p.materials.length;g++)d=d||p.materials[g]instanceof THREE.ShaderMaterial;d&&u.computeTangents(),E.skin?d=new THREE.SkinnedMesh(u,p):E.morph?(d=new THREE.MorphAnimMesh(u,p),void 0!==E.duration&&(d.duration=E.duration),void 0!==E.time&&(d.time=E.time),void 0!==E.mirroredLoop&&(d.mirroredLoop=E.mirroredLoop),p.morphNormals&&u.computeMorphNormals()):d=new THREE.Mesh(u,p),d.name=l,r?(d.matrixAutoUpdate=!1,d.matrix.set(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])):(d.position.fromArray(n),c?d.quaternion.fromArray(c):d.rotation.fromArray(a),d.scale.fromArray(h)),d.visible=E.visible,d.castShadow=E.castShadow,d.receiveShadow=E.receiveShadow,t.add(d),x.objects[l]=d}}else if("AmbientLight"===E.type||"PointLight"===E.type||"DirectionalLight"===E.type||"SpotLight"===E.type||"HemisphereLight"===E.type||"AreaLight"===E.type){switch(g=E.color,r=E.intensity,n=E.distance,a=E.position,h=E.rotation,E.type){case"AmbientLight":f=new THREE.AmbientLight(g);break;case"PointLight":f=new THREE.PointLight(g,r,n),f.position.fromArray(a);break;case"DirectionalLight":f=new THREE.DirectionalLight(g,r),f.position.fromArray(E.direction);break;case"SpotLight":f=new THREE.SpotLight(g,r,n,1),f.angle=E.angle,f.position.fromArray(a),f.target.set(a[0],a[1]-n,a[2]),f.target.applyEuler(new THREE.Euler(h[0],h[1],h[2],"XYZ"));break;case"HemisphereLight":f=new THREE.DirectionalLight(g,r,n),f.target.set(a[0],a[1]-n,a[2]),f.target.applyEuler(new THREE.Euler(h[0],h[1],h[2],"XYZ"));break;case"AreaLight":f=new THREE.AreaLight(g,r),f.position.fromArray(a),f.width=E.size,f.height=E.size_y}t.add(f),f.name=l,x.lights[l]=f,x.objects[l]=f}else"PerspectiveCamera"===E.type||"OrthographicCamera"===E.type?(n=E.position,a=E.rotation,c=E.quaternion,"PerspectiveCamera"===E.type?m=new THREE.PerspectiveCamera(E.fov,E.aspect,E.near,E.far):"OrthographicCamera"===E.type&&(m=new THREE.OrthographicCamera(E.left,E.right,E.top,E.bottom,E.near,E.far)),m.name=l,m.position.fromArray(n),void 0!==c?m.quaternion.fromArray(c):void 0!==a&&m.rotation.fromArray(a),t.add(m),x.cameras[l]=m,x.objects[l]=m):(n=E.position,a=E.rotation,h=E.scale,c=E.quaternion,d=new THREE.Object3D,d.name=l,d.position.fromArray(n),c?d.quaternion.fromArray(c):d.rotation.fromArray(a),d.scale.fromArray(h),d.visible=void 0!==E.visible?E.visible:!1,t.add(d),x.objects[l]=d,x.empties[l]=d);if(d){if(void 0!==E.userData)for(var v in E.userData)d.userData[v]=E.userData[v];if(void 0!==E.groups)for(g=0;g<E.groups.length;g++)r=E.groups[g],void 0===x.groups[r]&&(x.groups[r]=[]),x.groups[r].push(l)}}void 0!==d&&void 0!==E.children&&o(d,E.children)}}function a(t){return function(e,r){e.name=t,x.geometries[t]=e,x.face_materials[t]=r,n(),y-=1,w.onLoadComplete(),c()}}function s(t,e,r,i){return function(o){var o=o.content?o.content:o.dae?o.scene:o,a=i.rotation,s=i.quaternion,h=i.scale;o.position.fromArray(i.position),s?o.quaternion.fromArray(s):o.rotation.fromArray(a),o.scale.fromArray(h),r&&o.traverse(function(t){t.material=r});var l=void 0!==i.visible?i.visible:!0;o.traverse(function(t){t.visible=l}),e.add(o),o.name=t,x.objects[t]=o,n(),y-=1,w.onLoadComplete(),c()}}function h(t){return function(e,r){e.name=t,x.geometries[t]=e,x.face_materials[t]=r}}function c(){if(w.callbackProgress({totalModels:v,totalTextures:T,loadedModels:v-y,loadedTextures:T-g},x),w.onLoadProgress(),0===y&&0===g){for(var t=0;t<b.length;t++){var r=b[t],i=x.objects[r.targetName];i?r.object.target=i:(r.object.target=new THREE.Object3D,x.scene.add(r.object.target)),r.object.target.userData.targetInverse=r.object}e(x)}}function l(t,e){if(e(t),void 0!==t.children)for(var r in t.children)l(t.children[r],e)}var u,p,m,d,E,f,y,g,v,T,x,R,w=this,H=THREE.Loader.prototype.extractUrlBase(r),b=[],M=t;for(R in this.geometryHandlers)t=this.geometryHandlers[R].loaderClass,this.geometryHandlers[R].loaderObject=new t;for(R in this.hierarchyHandlers)t=this.hierarchyHandlers[R].loaderClass,this.hierarchyHandlers[R].loaderObject=new t;g=y=0,x={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},M.transform&&(R=M.transform.position,t=M.transform.rotation,r=M.transform.scale,R&&x.scene.position.fromArray(R),t&&x.scene.rotation.fromArray(t),r&&x.scene.scale.fromArray(r),R||t||r)&&(x.scene.updateMatrix(),x.scene.updateMatrixWorld()),R=function(t){return function(){g-=t,c(),w.onLoadComplete()}};for(var _ in M.fogs)t=M.fogs[_],"linear"===t.type?d=new THREE.Fog(0,t.near,t.far):"exp2"===t.type&&(d=new THREE.FogExp2(0,t.density)),t=t.color,d.color.setRGB(t[0],t[1],t[2]),x.fogs[_]=d;for(var S in M.geometries)d=M.geometries[S],d.type in this.geometryHandlers&&(y+=1,w.onLoadStart());for(var z in M.objects)l(M.objects[z],function(t){t.type&&t.type in w.hierarchyHandlers&&(y+=1,w.onLoadStart())});v=y;for(S in M.geometries)if(d=M.geometries[S],"cube"===d.type)u=new THREE.CubeGeometry(d.width,d.height,d.depth,d.widthSegments,d.heightSegments,d.depthSegments),u.name=S,x.geometries[S]=u;else if("plane"===d.type)u=new THREE.PlaneGeometry(d.width,d.height,d.widthSegments,d.heightSegments),u.name=S,x.geometries[S]=u;else if("sphere"===d.type)u=new THREE.SphereGeometry(d.radius,d.widthSegments,d.heightSegments),u.name=S,x.geometries[S]=u;else if("cylinder"===d.type)u=new THREE.CylinderGeometry(d.topRad,d.botRad,d.height,d.radSegs,d.heightSegs),u.name=S,x.geometries[S]=u;else if("torus"===d.type)u=new THREE.TorusGeometry(d.radius,d.tube,d.segmentsR,d.segmentsT),u.name=S,x.geometries[S]=u;else if("icosahedron"===d.type)u=new THREE.IcosahedronGeometry(d.radius,d.subdivisions),u.name=S,x.geometries[S]=u;else if(d.type in this.geometryHandlers){z={};for(E in d)"type"!==E&&"url"!==E&&(z[E]=d[E]);this.geometryHandlers[d.type].loaderObject.load(i(d.url,M.urlBaseType),a(S),z)}else"embedded"===d.type&&(z=M.embeds[d.id],z.metadata=M.metadata,z&&(z=this.geometryHandlers.ascii.loaderObject.parse(z,""),h(S)(z.geometry,z.materials)));for(var V in M.textures)if(S=M.textures[V],S.url instanceof Array)for(g+=S.url.length,E=0;E<S.url.length;E++)w.onLoadStart();else g+=1,w.onLoadStart();T=g;for(V in M.textures){if(S=M.textures[V],void 0!==S.mapping&&void 0!==THREE[S.mapping]&&(S.mapping=new THREE[S.mapping]),S.url instanceof Array){for(z=S.url.length,d=[],E=0;z>E;E++)d[E]=i(S.url[E],M.urlBaseType);E=(E=/\.dds$/i.test(d[0]))?THREE.ImageUtils.loadCompressedTextureCube(d,S.mapping,R(z)):THREE.ImageUtils.loadTextureCube(d,S.mapping,R(z))}else E=/\.dds$/i.test(S.url),z=i(S.url,M.urlBaseType),d=R(1),E=E?THREE.ImageUtils.loadCompressedTexture(z,S.mapping,d):THREE.ImageUtils.loadTexture(z,S.mapping,d),void 0!==THREE[S.minFilter]&&(E.minFilter=THREE[S.minFilter]),void 0!==THREE[S.magFilter]&&(E.magFilter=THREE[S.magFilter]),S.anisotropy&&(E.anisotropy=S.anisotropy),S.repeat&&(E.repeat.set(S.repeat[0],S.repeat[1]),1!==S.repeat[0]&&(E.wrapS=THREE.RepeatWrapping),1!==S.repeat[1]&&(E.wrapT=THREE.RepeatWrapping)),S.offset&&E.offset.set(S.offset[0],S.offset[1]),S.wrap&&(z={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==z[S.wrap[0]]&&(E.wrapS=z[S.wrap[0]]),void 0!==z[S.wrap[1]]&&(E.wrapT=z[S.wrap[1]]));x.textures[V]=E}var O,C;for(O in M.materials){V=M.materials[O];for(C in V.parameters)"envMap"===C||"map"===C||"lightMap"===C||"bumpMap"===C?V.parameters[C]=x.textures[V.parameters[C]]:"shading"===C?V.parameters[C]="flat"===V.parameters[C]?THREE.FlatShading:THREE.SmoothShading:"side"===C?V.parameters[C]="double"==V.parameters[C]?THREE.DoubleSide:"back"==V.parameters[C]?THREE.BackSide:THREE.FrontSide:"blending"===C?V.parameters[C]=V.parameters[C]in THREE?THREE[V.parameters[C]]:THREE.NormalBlending:"combine"===C?V.parameters[C]=V.parameters[C]in THREE?THREE[V.parameters[C]]:THREE.MultiplyOperation:"vertexColors"===C?"face"==V.parameters[C]?V.parameters[C]=THREE.FaceColors:V.parameters[C]&&(V.parameters[C]=THREE.VertexColors):"wrapRGB"===C&&(R=V.parameters[C],V.parameters[C]=new THREE.Vector3(R[0],R[1],R[2]));void 0!==V.parameters.opacity&&1>V.parameters.opacity&&(V.parameters.transparent=!0),V.parameters.normalMap?(R=THREE.ShaderLib.normalmap,S=THREE.UniformsUtils.clone(R.uniforms),E=V.parameters.color,z=V.parameters.specular,d=V.parameters.ambient,_=V.parameters.shininess,S.tNormal.value=x.textures[V.parameters.normalMap],V.parameters.normalScale&&S.uNormalScale.value.set(V.parameters.normalScale[0],V.parameters.normalScale[1]),V.parameters.map&&(S.tDiffuse.value=V.parameters.map,S.enableDiffuse.value=!0),V.parameters.envMap&&(S.tCube.value=V.parameters.envMap,S.enableReflection.value=!0,S.reflectivity.value=V.parameters.reflectivity),V.parameters.lightMap&&(S.tAO.value=V.parameters.lightMap,S.enableAO.value=!0),V.parameters.specularMap&&(S.tSpecular.value=x.textures[V.parameters.specularMap],S.enableSpecular.value=!0),V.parameters.displacementMap&&(S.tDisplacement.value=x.textures[V.parameters.displacementMap],S.enableDisplacement.value=!0,S.uDisplacementBias.value=V.parameters.displacementBias,S.uDisplacementScale.value=V.parameters.displacementScale),S.diffuse.value.setHex(E),S.specular.value.setHex(z),S.ambient.value.setHex(d),S.shininess.value=_,V.parameters.opacity&&(S.opacity.value=V.parameters.opacity),p=new THREE.ShaderMaterial({fragmentShader:R.fragmentShader,vertexShader:R.vertexShader,uniforms:S,lights:!0,fog:!0})):p=new THREE[V.type](V.parameters),p.name=O,x.materials[O]=p}for(O in M.materials)if(V=M.materials[O],V.parameters.materials){for(C=[],E=0;E<V.parameters.materials.length;E++)C.push(x.materials[V.parameters.materials[E]]);x.materials[O].materials=C}n(),x.cameras&&M.defaults.camera&&(x.currentCamera=x.cameras[M.defaults.camera]),x.fogs&&M.defaults.fog&&(x.scene.fog=x.fogs[M.defaults.fog]),w.callbackSync(x),c()}},THREE.TextureLoader=function(t){this.manager=void 0!==t?t:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(t,e){var r=new THREE.ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin),r.load(t,function(t){t=new THREE.Texture(t),t.needsUpdate=!0,void 0!==e&&e(t)})},setCrossOrigin:function(t){this.crossOrigin=t}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthWrite=this.depthTest=!0,this.polygonOffset=!1,this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.needsUpdate=this.visible=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(t){if(void 0!==t)for(var e in t){var r=t[e];if(void 0===r)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if(e in this){var i=this[e];i instanceof THREE.Color?i.set(r):i instanceof THREE.Vector3&&r instanceof THREE.Vector3?i.copy(r):this[e]="overdraw"==e?Number(r):r}}},clone:function(t){return void 0===t&&(t=new THREE.Material),t.name=this.name,t.side=this.side,t.opacity=this.opacity,t.transparent=this.transparent,t.blending=this.blending,t.blendSrc=this.blendSrc,t.blendDst=this.blendDst,t.blendEquation=this.blendEquation,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.polygonOffset=this.polygonOffset,t.polygonOffsetFactor=this.polygonOffsetFactor,t.polygonOffsetUnits=this.polygonOffsetUnits,t.alphaTest=this.alphaTest,t.overdraw=this.overdraw,t.visible=this.visible,t},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=!1,this.fog=!0,this.setValues(t)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var t=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.linewidth=this.linewidth,t.linecap=this.linecap,t.linejoin=this.linejoin,t.vertexColors=this.vertexColors,t.fog=this.fog,t},THREE.MeshBasicMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var t=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t},THREE.MeshLambertMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var t=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshPhongMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.bumpMap=this.lightMap=this.map=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.envMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var t=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.ambient.copy(this.ambient),t.emissive.copy(this.emissive),t.specular.copy(this.specular),t.shininess=this.shininess,t.metal=this.metal,t.perPixel=this.perPixel,t.wrapAround=this.wrapAround,t.wrapRGB.copy(this.wrapRGB),t.map=this.map,t.lightMap=this.lightMap,t.bumpMap=this.bumpMap,t.bumpScale=this.bumpScale,t.normalMap=this.normalMap,t.normalScale.copy(this.normalScale),t.specularMap=this.specularMap,t.envMap=this.envMap,t.combine=this.combine,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,t.fog=this.fog,t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t.wireframeLinecap=this.wireframeLinecap,t.wireframeLinejoin=this.wireframeLinejoin,t.vertexColors=this.vertexColors,t.skinning=this.skinning,t.morphTargets=this.morphTargets,t.morphNormals=this.morphNormals,t},THREE.MeshNormalMaterial=function(t){THREE.Material.call(this,t),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var t=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,t),t.shading=this.shading,t.wireframe=this.wireframe,t.wireframeLinewidth=this.wireframeLinewidth,t},THREE.MeshFaceMaterial=function(t){this.materials=t instanceof Array?t:[]},THREE.MeshFaceMaterial.prototype.clone=function(){for(var t=new THREE.MeshFaceMaterial,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t},THREE.SpriteMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var t=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.map=this.map,t.rotation=this.rotation,t.fog=this.fog,t},THREE.SpriteCanvasMaterial=function(t){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(t)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.clone=function(){var t=new THREE.SpriteCanvasMaterial;return THREE.Material.prototype.clone.call(this,t),t.color.copy(this.color),t.program=this.program,t},THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial,THREE.Texture=function(t,e,r,i,n,o,a,s,h){this.id=THREE.TextureIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.image=t,this.mipmaps=[],this.mapping=void 0!==e?e:new THREE.UVMapping,this.wrapS=void 0!==r?r:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n?n:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==h?h:1,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},clone:function(t){return void 0===t&&(t=new THREE.Texture),t.image=this.image,t.mipmaps=this.mipmaps.slice(0),t.mapping=this.mapping,t.wrapS=this.wrapS,t.wrapT=this.wrapT,t.magFilter=this.magFilter,t.minFilter=this.minFilter,t.anisotropy=this.anisotropy,t.format=this.format,t.type=this.type,t.offset.copy(this.offset),t.repeat.copy(this.repeat),t.generateMipmaps=this.generateMipmaps,t.premultiplyAlpha=this.premultiplyAlpha,t.flipY=this.flipY,t.unpackAlignment=this.unpackAlignment,t},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.DataTexture=function(t,e,r,i,n,o,a,s,h,c,l){THREE.Texture.call(this,null,o,a,s,h,c,i,n,l),this.image={data:t,width:e,height:r}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var t=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,t),t},THREE.Line=function(t,e,r){THREE.Object3D.call(this),this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==r?r:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(t){return void 0===t&&(t=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Mesh=function(t,e){THREE.Object3D.call(this),this.geometry=void 0!==t?t:new THREE.Geometry,this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;e>t;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+t+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(t){return void 0===t&&(t=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Bone=function(t){THREE.Object3D.call(this),this.skin=t,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(t,e){this.matrixAutoUpdate&&(e|=this.updateMatrix()),(e||this.matrixWorldNeedsUpdate)&&(t?this.skinMatrix.multiplyMatrices(t,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);var r,i=this.children.length;for(r=0;i>r;r++)this.children[r].update(this.skinMatrix,e)},THREE.Sprite=function(t){THREE.Object3D.call(this),this.material=void 0!==t?t:new THREE.SpriteMaterial},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(t){return void 0===t&&(t=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,t),t},THREE.Particle=THREE.Sprite,THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0);for(var e=Math.abs(e),r=0;r<this.objects.length&&e>=this.objects[r].distance;r++);this.objects.splice(r,0,{distance:e,object:t}),this.add(t)},THREE.LOD.prototype.getObjectForDistance=function(t){for(var e=1,r=this.objects.length;r>e&&t>=this.objects[e].distance;e++);return this.objects[e-1].object},THREE.LOD.prototype.update=function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(r){if(1<this.objects.length){t.setFromMatrixPosition(r.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),r=t.distanceTo(e),this.objects[0].object.visible=!0;for(var i=1,n=this.objects.length;n>i&&r>=this.objects[i].distance;i++)this.objects[i-1].object.visible=!1,this.objects[i].object.visible=!0;for(;n>i;i++)this.objects[i].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Scene=function(){THREE.Object3D.call(this),this.overrideMaterial=this.fog=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]
},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(t){if(t instanceof THREE.Light)-1===this.__lights.indexOf(t)&&this.__lights.push(t),t.target&&void 0===t.target.parent&&this.add(t.target);else if(!(t instanceof THREE.Camera||t instanceof THREE.Bone)){this.__objectsAdded.push(t);var e=this.__objectsRemoved.indexOf(t);-1!==e&&this.__objectsRemoved.splice(e,1)}for(this.dispatchEvent({type:"objectAdded",object:t}),t.dispatchEvent({type:"addedToScene",scene:this}),e=0;e<t.children.length;e++)this.__addObject(t.children[e])},THREE.Scene.prototype.__removeObject=function(t){if(t instanceof THREE.Light){var e=this.__lights.indexOf(t);if(-1!==e&&this.__lights.splice(e,1),t.shadowCascadeArray)for(e=0;e<t.shadowCascadeArray.length;e++)this.__removeObject(t.shadowCascadeArray[e])}else t instanceof THREE.Camera||(this.__objectsRemoved.push(t),e=this.__objectsAdded.indexOf(t),-1!==e&&this.__objectsAdded.splice(e,1));for(this.dispatchEvent({type:"objectRemoved",object:t}),t.dispatchEvent({type:"removedFromScene",scene:this}),e=0;e<t.children.length;e++)this.__removeObject(t.children[e])},THREE.Scene.prototype.clone=function(t){return void 0===t&&(t=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,t),null!==this.fog&&(t.fog=this.fog.clone()),null!==this.overrideMaterial&&(t.overrideMaterial=this.overrideMaterial.clone()),t.autoUpdate=this.autoUpdate,t.matrixAutoUpdate=this.matrixAutoUpdate,t},THREE.CanvasRenderer=function(t){function e(t,e,r){for(var i=0,n=T.length;n>i;i++){var o=T[i];if(Te.copy(o.color),o instanceof THREE.DirectionalLight){var a=Se.setFromMatrixPosition(o.matrixWorld).normalize(),s=e.dot(a);0>=s||(s*=o.intensity,r.add(Te.multiplyScalar(s)))}else o instanceof THREE.PointLight&&(a=Se.setFromMatrixPosition(o.matrixWorld),s=e.dot(Se.subVectors(a,t).normalize()),0>=s||(s*=0==o.distance?1:1-Math.min(t.distanceTo(a)/o.distance,1),0!=s&&(s*=o.intensity,r.add(Te.multiplyScalar(s)))))}}function r(t,e,r,i){p(e),m(r),d(i),E(t.getStyle()),P.stroke(),He.expandByScalar(2*e)}function i(t){f(t.getStyle()),P.fill()}function n(t){o(t.target)}function o(t){var e=t.wrapS===THREE.RepeatWrapping,r=t.wrapT===THREE.RepeatWrapping,i=t.image,n=document.createElement("canvas");n.width=i.width,n.height=i.height;var o=n.getContext("2d");o.setTransform(1,0,0,-1,0,i.height),o.drawImage(i,0,0),xe[t.id]=P.createPattern(n,!0===e&&!0===r?"repeat":!0===e&&!1===r?"repeat-x":!1===e&&!0===r?"repeat-y":"no-repeat")}function a(t,e,r,i,a,s,h,c,l,u,p,m,d){if(!(d instanceof THREE.DataTexture)){!1===d.hasEventListener("update",n)&&(void 0!==d.image&&0<d.image.width&&o(d),d.addEventListener("update",n));var E=xe[d.id];if(void 0!==E){f(E);var E=d.offset.x/d.repeat.x,y=d.offset.y/d.repeat.y,g=d.image.width*d.repeat.x,d=d.image.height*d.repeat.y,h=(h+E)*g,c=(c+y)*d,r=r-t,i=i-e,a=a-t,s=s-e,l=(l+E)*g-h,u=(u+y)*d-c,p=(p+E)*g-h,m=(m+y)*d-c,d=l*m-p*u;0!==d&&(E=1/d,d=(m*r-u*a)*E,u=(m*i-u*s)*E,r=(l*a-p*r)*E,i=(l*s-p*i)*E,t=t-d*h-r*c,e=e-u*h-i*c,P.save(),P.transform(d,u,r,i,t,e),P.fill(),P.restore())}else f("rgba(0,0,0,1)"),P.fill()}}function s(t,e,r,i,n,o,a,s,h,c,l,u,p){var m,d;m=p.width-1,d=p.height-1,a*=m,s*=d,r-=t,i-=e,n-=t,o-=e,h=h*m-a,c=c*d-s,l=l*m-a,u=u*d-s,d=1/(h*u-l*c),m=(u*r-c*n)*d,c=(u*i-c*o)*d,r=(h*n-l*r)*d,i=(h*o-l*i)*d,t=t-m*a-r*s,e=e-c*a-i*s,P.save(),P.transform(m,c,r,i,t,e),P.clip(),P.drawImage(p,0,0),P.restore()}function h(t,e,r,i){return le[0]=0|255*t.r,le[1]=0|255*t.g,le[2]=0|255*t.b,le[4]=0|255*e.r,le[5]=0|255*e.g,le[6]=0|255*e.b,le[8]=0|255*r.r,le[9]=0|255*r.g,le[10]=0|255*r.b,le[12]=0|255*i.r,le[13]=0|255*i.g,le[14]=0|255*i.b,he.putImageData(ce,0,0),pe.drawImage(se,0,0),ue}function c(t,e,r){var i=e.x-t.x,n=e.y-t.y,o=i*i+n*n;0!==o&&(r/=Math.sqrt(o),i*=r,n*=r,e.x+=i,e.y+=n,t.x-=i,t.y-=n)}function l(t){j!==t&&(j=P.globalAlpha=t)}function u(t){D!==t&&(t===THREE.NormalBlending?P.globalCompositeOperation="source-over":t===THREE.AdditiveBlending?P.globalCompositeOperation="lighter":t===THREE.SubtractiveBlending&&(P.globalCompositeOperation="darker"),D=t)}function p(t){B!==t&&(B=P.lineWidth=t)}function m(t){U!==t&&(U=P.lineCap=t)}function d(t){k!==t&&(k=P.lineJoin=t)}function E(t){F!==t&&(F=P.strokeStyle=t)}function f(t){N!==t&&(N=P.fillStyle=t)}function y(t,e){(I!==t||q!==e)&&(P.setLineDash([t,e]),I=t,q=e)}console.log("THREE.CanvasRenderer",THREE.REVISION);var g,v,T,x,R,w,H,b=THREE.Math.smoothstep,t=t||{},M=this,_=new THREE.Projector,S=void 0!==t.canvas?t.canvas:document.createElement("canvas"),z=S.width,V=S.height,O=Math.floor(z/2),C=Math.floor(V/2),P=S.getContext("2d"),A=new THREE.Color(0),L=0,j=1,D=0,F=null,N=null,B=null,U=null,k=null,I=null,q=0;new THREE.RenderableVertex,new THREE.RenderableVertex;var G,W,Y,X,Q,Z,J,$,K,te,ee,re,ie,ne,oe,ae,se,he,ce,le,ue,pe,me=new THREE.Color,de=new THREE.Color,Ee=new THREE.Color,fe=new THREE.Color,ye=new THREE.Color,ge=new THREE.Color,ve=new THREE.Color,Te=new THREE.Color,xe={},Re=new THREE.Box2,we=new THREE.Box2,He=new THREE.Box2,be=new THREE.Color,Me=new THREE.Color,_e=new THREE.Color,Se=new THREE.Vector3,ze=16;se=document.createElement("canvas"),se.width=se.height=2,he=se.getContext("2d"),he.fillStyle="rgba(0,0,0,1)",he.fillRect(0,0,2,2),ce=he.getImageData(0,0,2,2),le=ce.data,ue=document.createElement("canvas"),ue.width=ue.height=ze,pe=ue.getContext("2d"),pe.translate(-ze/2,-ze/2),pe.scale(ze,ze),ze--,void 0===P.setLineDash&&(P.setLineDash=void 0!==P.mozDash?function(t){P.mozDash=null!==t[0]?t:null}:function(){}),this.domElement=S,this.devicePixelRatio=void 0!==t.devicePixelRatio?t.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.sortElements=this.sortObjects=this.autoClear=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(t,e,r){z=t*this.devicePixelRatio,V=e*this.devicePixelRatio,O=Math.floor(z/2),C=Math.floor(V/2),S.width=z,S.height=V,1!==this.devicePixelRatio&&!1!==r&&(S.style.width=t+"px",S.style.height=e+"px"),Re.set(new THREE.Vector2(-O,-C),new THREE.Vector2(O,C)),we.set(new THREE.Vector2(-O,-C),new THREE.Vector2(O,C)),j=1,D=0,k=U=B=N=F=null},this.setClearColor=function(t,e){A.set(t),L=void 0!==e?e:1,we.set(new THREE.Vector2(-O,-C),new THREE.Vector2(O,C))},this.setClearColorHex=function(t,e){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(t,e)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){P.setTransform(1,0,0,-1,O,C),!1===we.empty()&&(we.intersect(Re),we.expandByScalar(2),1>L&&P.clearRect(0|we.min.x,0|we.min.y,0|we.max.x-we.min.x,0|we.max.y-we.min.y),L>0&&(u(THREE.NormalBlending),l(1),f("rgba("+Math.floor(255*A.r)+","+Math.floor(255*A.g)+","+Math.floor(255*A.b)+","+L+")"),P.fillRect(0|we.min.x,0|we.min.y,0|we.max.x-we.min.x,0|we.max.y-we.min.y)),we.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(t,S){if(!1==S instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear(),P.setTransform(1,0,0,-1,O,C),M.info.render.vertices=0,M.info.render.faces=0,g=_.projectScene(t,S,this.sortObjects,this.sortElements),v=g.elements,T=g.lights,x=S,be.setRGB(0,0,0),Me.setRGB(0,0,0),_e.setRGB(0,0,0);for(var z=0,V=T.length;V>z;z++){var A=T[z],L=A.color;A instanceof THREE.AmbientLight?be.add(L):A instanceof THREE.DirectionalLight?Me.add(L):A instanceof THREE.PointLight&&_e.add(L)}for(z=0,V=v.length;V>z;z++){var j=v[z],D=j.material;if(void 0!==D&&!1!==D.visible){if(He.makeEmpty(),j instanceof THREE.RenderableSprite){R=j,R.x*=O,R.y*=C,A=R,L=D,l(L.opacity),u(L.blending);var F=j.scale.x*O,j=j.scale.y*C,D=.5*Math.sqrt(F*F+j*j);if(He.min.set(A.x-D,A.y-D),He.max.set(A.x+D,A.y+D),!1===Re.isIntersectionBox(He))He.makeEmpty();else if(L instanceof THREE.SpriteMaterial||L instanceof THREE.ParticleSystemMaterial){var N=L.map;if(null!==N){!1===N.hasEventListener("update",n)&&(void 0!==N.image&&0<N.image.width&&o(N),N.addEventListener("update",n)),D=xe[N.id],void 0!==D?f(D):f("rgba( 0, 0, 0, 1 )");var B=N.image,D=B.width*N.offset.x,U=B.height*N.offset.y,k=B.width*N.repeat.x,N=B.height*N.repeat.y,B=F/k,I=j/N;P.save(),P.translate(A.x,A.y),0!==L.rotation&&P.rotate(L.rotation),P.translate(-F/2,-j/2),P.scale(B,I),P.translate(-D,-U),P.fillRect(D,U,k,N)}else f(L.color.getStyle()),P.save(),P.translate(A.x,A.y),0!==L.rotation&&P.rotate(L.rotation),P.scale(F,-j),P.fillRect(-.5,-.5,1,1);P.restore()}else L instanceof THREE.SpriteCanvasMaterial&&(E(L.color.getStyle()),f(L.color.getStyle()),P.save(),P.translate(A.x,A.y),0!==L.rotation&&P.rotate(L.rotation),P.scale(F,j),L.program(P),P.restore())}else if(j instanceof THREE.RenderableLine){if(R=j.v1,w=j.v2,R.positionScreen.x*=O,R.positionScreen.y*=C,w.positionScreen.x*=O,w.positionScreen.y*=C,He.setFromPoints([R.positionScreen,w.positionScreen]),!0===Re.isIntersectionBox(He))if(A=R,L=w,F=j,j=D,l(j.opacity),u(j.blending),P.beginPath(),P.moveTo(A.positionScreen.x,A.positionScreen.y),P.lineTo(L.positionScreen.x,L.positionScreen.y),j instanceof THREE.LineBasicMaterial){if(p(j.linewidth),m(j.linecap),d(j.linejoin),j.vertexColors!==THREE.VertexColors)E(j.color.getStyle());else if(D=F.vertexColors[0].getStyle(),F=F.vertexColors[1].getStyle(),D===F)E(D);else{try{var q=P.createLinearGradient(A.positionScreen.x,A.positionScreen.y,L.positionScreen.x,L.positionScreen.y);q.addColorStop(0,D),q.addColorStop(1,F)}catch(se){q=D}E(q)}P.stroke(),He.expandByScalar(2*j.linewidth)}else j instanceof THREE.LineDashedMaterial&&(p(j.linewidth),m(j.linecap),d(j.linejoin),E(j.color.getStyle()),y(j.dashSize,j.gapSize),P.stroke(),He.expandByScalar(2*j.linewidth),y(null,null))}else if(j instanceof THREE.RenderableFace3){if(R=j.v1,w=j.v2,H=j.v3,-1>R.positionScreen.z||1<R.positionScreen.z)continue;if(-1>w.positionScreen.z||1<w.positionScreen.z)continue;if(-1>H.positionScreen.z||1<H.positionScreen.z)continue;if(R.positionScreen.x*=O,R.positionScreen.y*=C,w.positionScreen.x*=O,w.positionScreen.y*=C,H.positionScreen.x*=O,H.positionScreen.y*=C,0<D.overdraw&&(c(R.positionScreen,w.positionScreen,D.overdraw),c(w.positionScreen,H.positionScreen,D.overdraw),c(H.positionScreen,R.positionScreen,D.overdraw)),He.setFromPoints([R.positionScreen,w.positionScreen,H.positionScreen]),!0===Re.isIntersectionBox(He)){A=R,L=w,F=H,M.info.render.vertices+=3,M.info.render.faces++,l(D.opacity),u(D.blending),G=A.positionScreen.x,W=A.positionScreen.y,Y=L.positionScreen.x,X=L.positionScreen.y,Q=F.positionScreen.x,Z=F.positionScreen.y;var U=G,k=W,N=Y,B=X,I=Q,he=Z;P.beginPath(),P.moveTo(U,k),P.lineTo(N,B),P.lineTo(I,he),P.closePath(),(D instanceof THREE.MeshLambertMaterial||D instanceof THREE.MeshPhongMaterial)&&null===D.map?(ge.copy(D.color),ve.copy(D.emissive),D.vertexColors===THREE.FaceColors&&ge.multiply(j.color),!1===D.wireframe&&D.shading===THREE.SmoothShading&&3===j.vertexNormalsLength?(de.copy(be),Ee.copy(be),fe.copy(be),e(j.v1.positionWorld,j.vertexNormalsModel[0],de),e(j.v2.positionWorld,j.vertexNormalsModel[1],Ee),e(j.v3.positionWorld,j.vertexNormalsModel[2],fe),de.multiply(ge).add(ve),Ee.multiply(ge).add(ve),fe.multiply(ge).add(ve),ye.addColors(Ee,fe).multiplyScalar(.5),K=h(de,Ee,fe,ye),s(G,W,Y,X,Q,Z,0,0,1,0,0,1,K)):(me.copy(be),e(j.centroidModel,j.normalModel,me),me.multiply(ge).add(ve),!0===D.wireframe?r(me,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):i(me))):D instanceof THREE.MeshBasicMaterial||D instanceof THREE.MeshLambertMaterial||D instanceof THREE.MeshPhongMaterial?null!==D.map?D.map.mapping instanceof THREE.UVMapping&&(te=j.uvs[0],a(G,W,Y,X,Q,Z,te[0].x,te[0].y,te[1].x,te[1].y,te[2].x,te[2].y,D.map)):null!==D.envMap?D.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(Se.copy(j.vertexNormalsModelView[0]),ee=.5*Se.x+.5,re=.5*Se.y+.5,Se.copy(j.vertexNormalsModelView[1]),ie=.5*Se.x+.5,ne=.5*Se.y+.5,Se.copy(j.vertexNormalsModelView[2]),oe=.5*Se.x+.5,ae=.5*Se.y+.5,a(G,W,Y,X,Q,Z,ee,re,ie,ne,oe,ae,D.envMap)):(me.copy(D.color),D.vertexColors===THREE.FaceColors&&me.multiply(j.color),!0===D.wireframe?r(me,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):i(me)):D instanceof THREE.MeshDepthMaterial?(J=x.near,$=x.far,de.r=de.g=de.b=1-b(A.positionScreen.z*A.positionScreen.w,J,$),Ee.r=Ee.g=Ee.b=1-b(L.positionScreen.z*L.positionScreen.w,J,$),fe.r=fe.g=fe.b=1-b(F.positionScreen.z*F.positionScreen.w,J,$),ye.addColors(Ee,fe).multiplyScalar(.5),K=h(de,Ee,fe,ye),s(G,W,Y,X,Q,Z,0,0,1,0,0,1,K)):D instanceof THREE.MeshNormalMaterial&&(A=void 0,D.shading===THREE.FlatShading?(A=j.normalModelView,me.setRGB(A.x,A.y,A.z).multiplyScalar(.5).addScalar(.5),!0===D.wireframe?r(me,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):i(me)):D.shading===THREE.SmoothShading&&(A=j.vertexNormalsModelView[0],de.setRGB(A.x,A.y,A.z).multiplyScalar(.5).addScalar(.5),A=j.vertexNormalsModelView[1],Ee.setRGB(A.x,A.y,A.z).multiplyScalar(.5).addScalar(.5),A=j.vertexNormalsModelView[2],fe.setRGB(A.x,A.y,A.z).multiplyScalar(.5).addScalar(.5),ye.addColors(Ee,fe).multiplyScalar(.5),K=h(de,Ee,fe,ye),s(G,W,Y,X,Q,Z,0,0,1,0,0,1,K)))}}we.union(He)}}P.setTransform(1,0,0,1,0,0)}}},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen)},THREE.RenderableFace3=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.material=this.color=null,this.uvs=[[]],this.z=0},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.rotation=this.z=this.y=this.x=0,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.GeometryUtils={merge:function(t,e,r){var i,n,o=t.vertices.length,a=e instanceof THREE.Mesh?e.geometry:e,s=t.vertices,h=a.vertices,c=t.faces,l=a.faces,t=t.faceVertexUvs[0],a=a.faceVertexUvs[0];void 0===r&&(r=0),e instanceof THREE.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,n=(new THREE.Matrix3).getNormalMatrix(i));for(var e=0,u=h.length;u>e;e++){var p=h[e].clone();i&&p.applyMatrix4(i),s.push(p)}for(e=0,u=l.length;u>e;e++){var m,d,p=l[e],E=p.vertexNormals,f=p.vertexColors;for(m=new THREE.Face3(p.a+o,p.b+o,p.c+o),m.normal.copy(p.normal),n&&m.normal.applyMatrix3(n).normalize(),s=0,h=E.length;h>s;s++)d=E[s].clone(),n&&d.applyMatrix3(n).normalize(),m.vertexNormals.push(d);for(m.color.copy(p.color),s=0,h=f.length;h>s;s++)d=f[s],m.vertexColors.push(d.clone());m.materialIndex=p.materialIndex+r,m.centroid.copy(p.centroid),i&&m.centroid.applyMatrix4(i),c.push(m)}for(e=0,u=a.length;u>e;e++){for(r=a[e],i=[],s=0,h=r.length;h>s;s++)i.push(new THREE.Vector2(r[s].x,r[s].y));t.push(i)}},randomPointInTriangle:function(){var t=new THREE.Vector3;return function(e,r,i){var n=new THREE.Vector3,o=THREE.Math.random16(),a=THREE.Math.random16();o+a>1&&(o=1-o,a=1-a);var s=1-o-a;return n.copy(e),n.multiplyScalar(o),t.copy(r),t.multiplyScalar(a),n.add(t),t.copy(i),t.multiplyScalar(s),n.add(t),n}}(),randomPointInFace:function(t,e){return THREE.GeometryUtils.randomPointInTriangle(e.vertices[t.a],e.vertices[t.b],e.vertices[t.c])},randomPointsInGeometry:function(t,e){function r(t){function e(r,i){if(r>i)return r;var n=r+Math.floor((i-r)/2);return p[n]>t?e(r,n-1):p[n]<t?e(n+1,i):n}return e(0,p.length-1)}var i,n,o,a,s,h=t.faces,c=t.vertices,l=h.length,u=0,p=[];for(n=0;l>n;n++)i=h[n],o=c[i.a],a=c[i.b],s=c[i.c],i._area=THREE.GeometryUtils.triangleArea(o,a,s),u+=i._area,p[n]=u;for(i=[],n=0;e>n;n++)c=THREE.Math.random16()*u,c=r(c),i[n]=THREE.GeometryUtils.randomPointInFace(h[c],t,!0);return i},triangleArea:function(){var t=new THREE.Vector3,e=new THREE.Vector3;return function(r,i,n){return t.subVectors(i,r),e.subVectors(n,r),t.cross(e),.5*t.length()}}(),center:function(t){t.computeBoundingBox();var e=t.boundingBox,r=new THREE.Vector3;return r.addVectors(e.min,e.max),r.multiplyScalar(-.5),t.applyMatrix((new THREE.Matrix4).makeTranslation(r.x,r.y,r.z)),t.computeBoundingBox(),r},triangulateQuads:function(t){var e,r,i,n,o=[],a=[];for(e=0,r=t.faceVertexUvs.length;r>e;e++)a[e]=[];for(e=0,r=t.faces.length;r>e;e++)for(o.push(t.faces[e]),i=0,n=t.faceVertexUvs.length;n>i;i++)a[i].push(t.faceVertexUvs[i][e]);t.faces=o,t.faceVertexUvs=a,t.computeCentroids(),t.computeFaceNormals(),t.computeVertexNormals(),t.hasTangents&&t.computeTangents()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,r){var i=new THREE.ImageLoader;i.crossOrigin=this.crossOrigin;var n=new THREE.Texture(void 0,e),e=i.load(t,function(){n.needsUpdate=!0,r&&r(n)});return n.image=e,n.sourceFile=t,n},loadCompressedTexture:function(t,e,r,i){var n=new THREE.CompressedTexture;n.mapping=e;var o=new XMLHttpRequest;return o.onload=function(){var t=THREE.ImageUtils.parseDDS(o.response,!0);n.format=t.format,n.mipmaps=t.mipmaps,n.image.width=t.width,n.image.height=t.height,n.generateMipmaps=!1,n.needsUpdate=!0,r&&r(n)},o.onerror=i,o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null),n},loadTextureCube:function(t,e,r,i){var n=[];n.loadCount=0;var o=new THREE.Texture;o.image=n,void 0!==e&&(o.mapping=e),o.flipY=!1;for(var e=0,a=t.length;a>e;++e){var s=new Image;n[e]=s,s.onload=function(){n.loadCount+=1,6===n.loadCount&&(o.needsUpdate=!0,r&&r(o))},s.onerror=i,s.crossOrigin=this.crossOrigin,s.src=t[e]}return o},loadCompressedTextureCube:function(t,e,r,i){var n=[];n.loadCount=0;var o=new THREE.CompressedTexture;if(o.image=n,void 0!==e&&(o.mapping=e),o.flipY=!1,o.generateMipmaps=!1,e=function(t,e){return function(){var i=THREE.ImageUtils.parseDDS(t.response,!0);e.format=i.format,e.mipmaps=i.mipmaps,e.width=i.width,e.height=i.height,n.loadCount+=1,6===n.loadCount&&(o.format=i.format,o.needsUpdate=!0,r&&r(o))}},t instanceof Array)for(var a=0,s=t.length;s>a;++a){var h={};n[a]=h;var c=new XMLHttpRequest;c.onload=e(c,h),c.onerror=i,h=t[a],c.open("GET",h,!0),c.responseType="arraybuffer",c.send(null)}else c=new XMLHttpRequest,c.onload=function(){var t=THREE.ImageUtils.parseDDS(c.response,!0);if(t.isCubemap){for(var e=t.mipmaps.length/t.mipmapCount,i=0;e>i;i++){n[i]={mipmaps:[]};for(var a=0;a<t.mipmapCount;a++)n[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+a]),n[i].format=t.format,n[i].width=t.width,n[i].height=t.height}o.format=t.format,o.needsUpdate=!0,r&&r(o)}},c.onerror=i,c.open("GET",t,!0),c.responseType="arraybuffer",c.send(null);return o},loadDDSTexture:function(t,e,r,i){var n=[];n.loadCount=0;var o=new THREE.CompressedTexture;o.image=n,void 0!==e&&(o.mapping=e),o.flipY=!1,o.generateMipmaps=!1;var a=new XMLHttpRequest;return a.onload=function(){var t=THREE.ImageUtils.parseDDS(a.response,!0);if(t.isCubemap)for(var e=t.mipmaps.length/t.mipmapCount,i=0;e>i;i++){n[i]={mipmaps:[]};for(var s=0;s<t.mipmapCount;s++)n[i].mipmaps.push(t.mipmaps[i*t.mipmapCount+s]),n[i].format=t.format,n[i].width=t.width,n[i].height=t.height}else o.image.width=t.width,o.image.height=t.height,o.mipmaps=t.mipmaps;o.format=t.format,o.needsUpdate=!0,r&&r(o)},a.onerror=i,a.open("GET",t,!0),a.responseType="arraybuffer",a.send(null),o},parseDDS:function(t,e){function r(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}var i={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},n=r("DXT1"),o=r("DXT3"),a=r("DXT5"),s=new Int32Array(t,0,31);if(542327876!==s[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),i;if(4&!s[20])return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),i;var h=s[21],c=!1;switch(h){case n:n=8,i.format=THREE.RGB_S3TC_DXT1_Format;break;case o:n=16,i.format=THREE.RGBA_S3TC_DXT3_Format;break;case a:n=16,i.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==s[22]&&16711680&s[23]&&65280&s[24]&&255&s[25]&&4278190080&s[26]))return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(255&h,255&h>>8,255&h>>16,255&h>>24)),i;c=!0,n=64,i.format=THREE.RGBAFormat}i.mipmapCount=1,131072&s[2]&&!1!==e&&(i.mipmapCount=Math.max(1,s[7])),i.isCubemap=512&s[28]?!0:!1,i.width=s[4],i.height=s[3];for(var s=s[1]+4,o=i.width,a=i.height,h=i.isCubemap?6:1,l=0;h>l;l++){for(var u=0;u<i.mipmapCount;u++){if(c){var p;p=o;for(var m=a,d=4*p*m,E=new Uint8Array(t,s,d),d=new Uint8Array(d),f=0,y=0,g=0;m>g;g++)for(var v=0;p>v;v++){var T=E[y];y++;var x=E[y];y++;var R=E[y];y++;var w=E[y];y++,d[f]=R,f++,d[f]=x,f++,d[f]=T,f++,d[f]=w,f++}p=d,m=p.length}else m=Math.max(4,o)/4*Math.max(4,a)/4*n,p=new Uint8Array(t,s,m);i.mipmaps.push({data:p,width:o,height:a}),s+=m,o=Math.max(.5*o,1),a=Math.max(.5*a,1)}o=i.width,a=i.height}return i},getNormalMap:function(t,e){var r=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e]},e=1|e,i=t.width,n=t.height,o=document.createElement("canvas");o.width=i,o.height=n;var a=o.getContext("2d");a.drawImage(t,0,0);for(var s=a.getImageData(0,0,i,n).data,h=a.createImageData(i,n),c=h.data,l=0;i>l;l++)for(var u=0;n>u;u++){var p=0>u-1?0:u-1,m=u+1>n-1?n-1:u+1,d=0>l-1?0:l-1,E=l+1>i-1?i-1:l+1,f=[],y=[0,0,s[4*(u*i+l)]/255*e];for(f.push([-1,0,s[4*(u*i+d)]/255*e]),f.push([-1,-1,s[4*(p*i+d)]/255*e]),f.push([0,-1,s[4*(p*i+l)]/255*e]),f.push([1,-1,s[4*(p*i+E)]/255*e]),f.push([1,0,s[4*(u*i+E)]/255*e]),f.push([1,1,s[4*(m*i+E)]/255*e]),f.push([0,1,s[4*(m*i+l)]/255*e]),f.push([-1,1,s[4*(m*i+d)]/255*e]),p=[],d=f.length,m=0;d>m;m++){var E=f[m],g=f[(m+1)%d],E=[E[0]-y[0],E[1]-y[1],E[2]-y[2]],g=[g[0]-y[0],g[1]-y[1],g[2]-y[2]];p.push(r([E[1]*g[2]-E[2]*g[1],E[2]*g[0]-E[0]*g[2],E[0]*g[1]-E[1]*g[0]]))}for(f=[0,0,0],m=0;m<p.length;m++)f[0]+=p[m][0],f[1]+=p[m][1],f[2]+=p[m][2];f[0]/=p.length,f[1]/=p.length,f[2]/=p.length,y=4*(u*i+l),c[y]=0|255*((f[0]+1)/2),c[y+1]=0|255*((f[1]+1)/2),c[y+2]=0|255*f[2],c[y+3]=255}return a.putImageData(h,0,0),o},generateDataTexture:function(t,e,r){for(var i=t*e,n=new Uint8Array(3*i),o=Math.floor(255*r.r),a=Math.floor(255*r.g),r=Math.floor(255*r.b),s=0;i>s;s++)n[3*s]=o,n[3*s+1]=a,n[3*s+2]=r;return t=new THREE.DataTexture(n,t,e,THREE.RGBFormat),t.needsUpdate=!0,t}},THREE.SceneUtils={createMultiMaterialObject:function(t,e){for(var r=new THREE.Object3D,i=0,n=e.length;n>i;i++)r.add(new THREE.Mesh(t,e[i]));return r},detach:function(t,e,r){t.applyMatrix(e.matrixWorld),e.remove(t),r.add(t)},attach:function(t,e,r){var i=new THREE.Matrix4;i.getInverse(r.matrixWorld),t.applyMatrix(i),e.remove(t),r.add(t)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(t){var e=t.familyName.toLowerCase();return this.faces[e]=this.faces[e]||{},this.faces[e][t.cssFontWeight]=this.faces[e][t.cssFontWeight]||{},this.faces[e][t.cssFontWeight][t.cssFontStyle]=t,this.faces[e][t.cssFontWeight][t.cssFontStyle]=t},drawText:function(t){for(var e=this.getFace(),r=this.size/e.resolution,i=0,n=(t+"").split(""),o=n.length,a=[],t=0;o>t;t++){var s=new THREE.Path,s=this.extractGlyphPoints(n[t],e,r,i,s),i=i+s.offset;a.push(s.path)}return{paths:a,offset:i/2}},extractGlyphPoints:function(t,e,r,i,n){var o,a,s,h,c,l,u,p,m,d,E,f=[],y=e.glyphs[t]||e.glyphs["?"];if(y){if(y.o)for(e=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),h=e.length,t=0;h>t;)switch(s=e[t++]){case"m":s=e[t++]*r+i,c=e[t++]*r,n.moveTo(s,c);break;case"l":s=e[t++]*r+i,c=e[t++]*r,n.lineTo(s,c);break;case"q":if(s=e[t++]*r+i,c=e[t++]*r,p=e[t++]*r+i,m=e[t++]*r,n.quadraticCurveTo(p,m,s,c),o=f[f.length-1])for(l=o.x,u=o.y,o=1,a=this.divisions;a>=o;o++){var g=o/a;THREE.Shape.Utils.b2(g,l,p,s),THREE.Shape.Utils.b2(g,u,m,c)}break;case"b":if(s=e[t++]*r+i,c=e[t++]*r,p=e[t++]*r+i,m=e[t++]*-r,d=e[t++]*r+i,E=e[t++]*-r,n.bezierCurveTo(s,c,p,m,d,E),o=f[f.length-1])for(l=o.x,u=o.y,o=1,a=this.divisions;a>=o;o++)g=o/a,THREE.Shape.Utils.b3(g,l,p,d,s),THREE.Shape.Utils.b3(g,u,m,E,c)}return{offset:y.ha*r,path:n}}}},THREE.FontUtils.generateShapes=function(t,e){var e=e||{},r=void 0!==e.curveSegments?e.curveSegments:4,i=void 0!==e.font?e.font:"helvetiker",n=void 0!==e.weight?e.weight:"normal",o=void 0!==e.style?e.style:"normal";for(THREE.FontUtils.size=void 0!==e.size?e.size:100,THREE.FontUtils.divisions=r,THREE.FontUtils.face=i,THREE.FontUtils.weight=n,THREE.FontUtils.style=o,r=THREE.FontUtils.drawText(t).paths,i=[],n=0,o=r.length;o>n;n++)Array.prototype.push.apply(i,r[n].toShapes());return i},function(t){var e=function(t){for(var e=t.length,r=0,i=e-1,n=0;e>n;i=n++)r+=t[i].x*t[n].y-t[n].x*t[i].y;return.5*r};return t.Triangulate=function(t,r){var i=t.length;if(3>i)return null;var n,o,a,s=[],h=[],c=[];if(0<e(t))for(o=0;i>o;o++)h[o]=o;else for(o=0;i>o;o++)h[o]=i-1-o;var l=2*i;for(o=i-1;i>2;){if(0>=l--){console.log("Warning, unable to triangulate polygon!");break}n=o,n>=i&&(n=0),o=n+1,o>=i&&(o=0),a=o+1,a>=i&&(a=0);var u;t:{var p=u=void 0,m=void 0,d=void 0,E=void 0,f=void 0,y=void 0,g=void 0,v=void 0,p=t[h[n]].x,m=t[h[n]].y,d=t[h[o]].x,E=t[h[o]].y,f=t[h[a]].x,y=t[h[a]].y;if(1e-10>(d-p)*(y-m)-(E-m)*(f-p))u=!1;else{var T=void 0,x=void 0,R=void 0,w=void 0,H=void 0,b=void 0,M=void 0,_=void 0,S=void 0,z=void 0,S=_=M=v=g=void 0,T=f-d,x=y-E,R=p-f,w=m-y,H=d-p,b=E-m;for(u=0;i>u;u++)if(u!==n&&u!==o&&u!==a&&(g=t[h[u]].x,v=t[h[u]].y,M=g-p,_=v-m,S=g-d,z=v-E,g-=f,v-=y,S=T*z-x*S,M=H*_-b*M,_=R*v-w*g,S>=-1e-10&&_>=-1e-10&&M>=-1e-10)){u=!1;break t}u=!0}}if(u){for(s.push([t[h[n]],t[h[o]],t[h[a]]]),c.push([h[n],h[o],h[a]]),n=o,a=o+1;i>a;n++,a++)h[n]=h[a];i--,l=2*i}}return r?c:s},t.Triangulate.area=e,t}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.CubeGeometry=function(t,e,r,i,n,o){function a(t,e,r,i,n,o,a,h){var c,l=s.widthSegments,u=s.heightSegments,p=n/2,m=o/2,d=s.vertices.length;"x"===t&&"y"===e||"y"===t&&"x"===e?c="z":"x"===t&&"z"===e||"z"===t&&"x"===e?(c="y",u=s.depthSegments):("z"===t&&"y"===e||"y"===t&&"z"===e)&&(c="x",l=s.depthSegments);var E=l+1,f=u+1,y=n/l,g=o/u,v=new THREE.Vector3;for(v[c]=a>0?1:-1,n=0;f>n;n++)for(o=0;E>o;o++){var T=new THREE.Vector3;T[t]=(o*y-p)*r,T[e]=(n*g-m)*i,T[c]=a,s.vertices.push(T)}for(n=0;u>n;n++)for(o=0;l>o;o++)m=o+E*n,t=o+E*(n+1),e=o+1+E*(n+1),r=o+1+E*n,i=new THREE.Vector2(o/l,1-n/u),a=new THREE.Vector2(o/l,1-(n+1)/u),c=new THREE.Vector2((o+1)/l,1-(n+1)/u),p=new THREE.Vector2((o+1)/l,1-n/u),m=new THREE.Face3(m+d,t+d,r+d),m.normal.copy(v),m.vertexNormals.push(v.clone(),v.clone(),v.clone()),m.materialIndex=h,s.faces.push(m),s.faceVertexUvs[0].push([i,a,p]),m=new THREE.Face3(t+d,e+d,r+d),m.normal.copy(v),m.vertexNormals.push(v.clone(),v.clone(),v.clone()),m.materialIndex=h,s.faces.push(m),s.faceVertexUvs[0].push([a.clone(),c,p.clone()])}THREE.Geometry.call(this);var s=this;this.width=t,this.height=e,this.depth=r,this.widthSegments=i||1,this.heightSegments=n||1,this.depthSegments=o||1,t=this.width/2,e=this.height/2,r=this.depth/2,a("z","y",-1,-1,this.depth,this.height,t,0),a("z","y",1,-1,this.depth,this.height,-t,1),a("x","z",1,1,this.width,this.depth,e,2),a("x","z",1,-1,this.width,this.depth,-e,3),a("x","y",1,-1,this.width,this.height,r,4),a("x","y",-1,-1,this.width,this.height,-r,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),!function(t,e){"use strict";function r(){i.READY||(g.determineEventTypes(),d.each(i.gestures,function(t){T.register(t)}),g.onTouch(i.DOCUMENT,p,T.detect),g.onTouch(i.DOCUMENT,m,T.detect),i.READY=!0)}var i=function(t,e){return new i.Instance(t,e||{})};i.VERSION="1.0.9",i.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},i.HAS_POINTEREVENTS=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,i.HAS_TOUCHEVENTS="ontouchstart"in t,i.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,i.NO_MOUSEEVENTS=i.HAS_TOUCHEVENTS&&t.navigator.userAgent.match(i.MOBILE_REGEX),i.EVENT_TYPES={},i.UPDATE_VELOCITY_INTERVAL=16,i.DOCUMENT=t.document;var n=i.DIRECTION_DOWN="down",o=i.DIRECTION_LEFT="left",a=i.DIRECTION_UP="up",s=i.DIRECTION_RIGHT="right",h=i.POINTER_MOUSE="mouse",c=i.POINTER_TOUCH="touch",l=i.POINTER_PEN="pen",u=i.EVENT_START="start",p=i.EVENT_MOVE="move",m=i.EVENT_END="end";i.plugins=i.plugins||{},i.gestures=i.gestures||{},i.READY=!1;var d=i.utils={extend:function(t,r,i){for(var n in r)t[n]!==e&&i||(t[n]=r[n]);return t},each:function(t,r,i){var n,o;if("forEach"in t)t.forEach(r,i);else if(t.length!==e){for(n=-1;o=t[++n];)if(r.call(i,o,n,t)===!1)return}else for(n in t)if(t.hasOwnProperty(n)&&r.call(i,t[n],n,t)===!1)return},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],r=[];return d.each(t,function(t){e.push(void 0!==t.clientX?t.clientX:t.pageX),r.push(void 0!==t.clientY?t.clientY:t.pageY)}),{pageX:(Math.min.apply(Math,e)+Math.max.apply(Math,e))/2,pageY:(Math.min.apply(Math,r)+Math.max.apply(Math,r))/2}},getVelocity:function(t,e,r){return{x:Math.abs(e/t)||0,y:Math.abs(r/t)||0}},getAngle:function(t,e){var r=e.pageY-t.pageY,i=e.pageX-t.pageX;return 180*Math.atan2(r,i)/Math.PI},getDirection:function(t,e){var r=Math.abs(t.pageX-e.pageX),i=Math.abs(t.pageY-e.pageY);return i>r?t.pageY-e.pageY>0?a:n:t.pageX-e.pageX>0?o:s},getDistance:function(t,e){var r=e.pageX-t.pageX,i=e.pageY-t.pageY;return Math.sqrt(r*r+i*i)},getScale:function(t,e){return t.length<2||e.length<2?1:this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1])},getRotation:function(t,e){return t.length<2||e.length<2?0:this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0])},isVertical:function(t){return t==a||t==n},toggleDefaultBehavior:function(t,e,r){if(e&&t&&t.style){d.each(["webkit","moz","Moz","ms","o",""],function(i){d.each(e,function(e,n){i&&(n=i+n.substring(0,1).toUpperCase()+n.substring(1)),n in t.style&&(t.style[n]=!r&&e)})});var i=function(){return!1};"none"==e.userSelect&&(t.onselectstart=!r&&i),"none"==e.userDrag&&(t.ondragstart=!r&&i)}}};i.Instance=function(t,e){var n=this;return r(),this.element=t,this.enabled=!0,this.options=d.extend(d.extend({},i.defaults),e||{}),this.options.stop_browser_behavior&&d.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=g.onTouch(t,u,function(t){n.enabled&&T.startDetect(n,t)}),this.eventHandlers=[],this},i.Instance.prototype={on:function(t,e){var r=t.split(" ");return d.each(r,function(t){this.element.addEventListener(t,e,!1),this.eventHandlers.push({gesture:t,handler:e})},this),this},off:function(t,e){var r,i,n=t.split(" ");return d.each(n,function(t){for(this.element.removeEventListener(t,e,!1),r=-1;i=this.eventHandlers[++r];)i.gesture===t&&i.handler===e&&this.eventHandlers.splice(r,1)},this),this},trigger:function(t,e){e||(e={});var r=i.DOCUMENT.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e;var n=this.element;return d.hasParent(e.target,n)&&(n=e.target),n.dispatchEvent(r),this},enable:function(t){return this.enabled=t,this},dispose:function(){var t,e;for(this.options.stop_browser_behavior&&d.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),t=-1;e=this.eventHandlers[++t];)this.element.removeEventListener(e.gesture,e.handler,!1);return this.eventHandlers=[],g.unbindDom(this.element,i.EVENT_TYPES[u],this.eventStartHandler),null}};var E=null,f=!1,y=!1,g=i.event={bindDom:function(t,e,r){var i=e.split(" ");
	d.each(i,function(e){t.addEventListener(e,r,!1)})},unbindDom:function(t,e,r){var i=e.split(" ");d.each(i,function(e){t.removeEventListener(e,r,!1)})},onTouch:function(t,e,r){var n=this,o=function(o){var a=o.type.toLowerCase();if(!a.match(/mouse/)||!y){a.match(/touch/)||a.match(/pointerdown/)||a.match(/mouse/)&&1===o.which?f=!0:a.match(/mouse/)&&!o.which&&(f=!1),a.match(/touch|pointer/)&&(y=!0);var s=0;f&&(i.HAS_POINTEREVENTS&&e!=m?s=v.updatePointer(e,o):a.match(/touch/)?s=o.touches.length:y||(s=a.match(/up/)?0:1),s>0&&e==m?e=p:s||(e=m),(s||null===E)&&(E=o),r.call(T,n.collectEventData(t,e,n.getTouchList(E,e),o)),i.HAS_POINTEREVENTS&&e==m&&(s=v.updatePointer(e,o))),s||(E=null,f=!1,y=!1,v.reset())}};return this.bindDom(t,i.EVENT_TYPES[e],o),o},determineEventTypes:function(){var t;t=i.HAS_POINTEREVENTS?v.getEvents():i.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],i.EVENT_TYPES[u]=t[0],i.EVENT_TYPES[p]=t[1],i.EVENT_TYPES[m]=t[2]},getTouchList:function(t){return i.HAS_POINTEREVENTS?v.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,e,r,i){var n=c;return(i.type.match(/mouse/)||v.matchType(h,i))&&(n=h),{center:d.getCenter(r),timeStamp:(new Date).getTime(),target:i.target,touches:r,eventType:e,pointerType:n,srcEvent:i,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return T.stopDetect()}}}},v=i.PointerEvent={pointers:{},getTouchList:function(){var t=[];return d.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){return t==m?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e),Object.keys(this.pointers).length},matchType:function(t,e){if(!e.pointerType)return!1;var r=e.pointerType,i={};return i[h]=r===h,i[c]=r===c,i[l]=r===l,i[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},T=i.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:d.extend({},e),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst.options;return d.each(this.gestures,function(r){return this.stopped||e[r.name]===!1||r.handler.call(r,t,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=t),t.eventType==m&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=d.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var e=this.current,r=e.startEvent;(t.touches.length!=r.touches.length||t.touches===r.touches)&&(r.touches=[],d.each(t.touches,function(t){r.touches.push(d.extend({},t))}));var n,o,a=t.timeStamp-r.timeStamp,s=t.center.pageX-r.center.pageX,h=t.center.pageY-r.center.pageY,c=e.lastVelocityEvent,l=e.velocity;return c&&t.timeStamp-c.timeStamp>i.UPDATE_VELOCITY_INTERVAL?(l=d.getVelocity(t.timeStamp-c.timeStamp,t.center.pageX-c.center.pageX,t.center.pageY-c.center.pageY),e.lastVelocityEvent=t,e.velocity=l):e.velocity||(l=d.getVelocity(a,s,h),e.lastVelocityEvent=t,e.velocity=l),t.eventType==m?(n=e.lastEvent&&e.lastEvent.interimAngle,o=e.lastEvent&&e.lastEvent.interimDirection):(n=e.lastEvent&&d.getAngle(e.lastEvent.center,t.center),o=e.lastEvent&&d.getDirection(e.lastEvent.center,t.center)),d.extend(t,{deltaTime:a,deltaX:s,deltaY:h,velocityX:l.x,velocityY:l.y,distance:d.getDistance(r.center,t.center),angle:d.getAngle(r.center,t.center),interimAngle:n,direction:d.getDirection(r.center,t.center),interimDirection:o,scale:d.getScale(r.touches,t.touches),rotation:d.getRotation(r.touches,t.touches),startEvent:r}),t},register:function(t){var r=t.defaults||{};return r[t.name]===e&&(r[t.name]=!0),d.extend(i.defaults,r,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}};i.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,e){if(T.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(e.options.drag_max_touches<=0||t.touches.length<=e.options.drag_max_touches)switch(t.eventType){case u:this.triggered=!1;break;case p:if(t.distance<e.options.drag_min_distance&&T.current.name!=this.name)return;if(T.current.name!=this.name&&(T.current.name=this.name,e.options.correct_for_drag_min_distance&&t.distance>0)){var r=Math.abs(e.options.drag_min_distance/t.distance);T.current.startEvent.center.pageX+=t.deltaX*r,T.current.startEvent.center.pageY+=t.deltaY*r,t=T.extendEventData(t)}(T.current.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var i=T.current.lastEvent.direction;t.drag_locked_to_axis&&i!==t.direction&&(t.direction=d.isVertical(i)?t.deltaY<0?a:n:t.deltaX<0?o:s),this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),e.trigger(this.name+t.direction,t);var h=d.isVertical(t.direction);(e.options.drag_block_vertical&&h||e.options.drag_block_horizontal&&!h)&&t.preventDefault();break;case m:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},i.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,e){switch(t.eventType){case u:clearTimeout(this.timer),T.current.name=this.name,this.timer=setTimeout(function(){"hold"==T.current.name&&e.trigger("hold",t)},e.options.hold_timeout);break;case p:t.distance>e.options.hold_threshold&&clearTimeout(this.timer);break;case m:clearTimeout(this.timer)}}},i.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==m&&e.trigger(this.name,t)}},i.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,e){if(t.eventType==m){if(t.touches.length<e.options.swipe_min_touches||t.touches.length>e.options.swipe_max_touches)return;(t.velocityX>e.options.swipe_velocity||t.velocityY>e.options.swipe_velocity)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},i.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(t,e){var r,i,n;t.eventType==u?this.has_moved=!1:t.eventType!=p||this.moved?t.eventType==m&&"touchcancel"!=t.srcEvent.type&&t.deltaTime<e.options.tap_max_touchtime&&!this.has_moved&&(r=T.previous,i=r&&r.lastEvent&&t.timeStamp-r.lastEvent.timeStamp,n=!1,r&&"tap"==r.name&&i&&i<e.options.doubletap_interval&&t.distance<e.options.doubletap_distance&&(e.trigger("doubletap",t),n=!0),(!n||e.options.tap_always)&&(T.current.name="tap",e.trigger(T.current.name,t))):this.has_moved=t.distance>e.options.tap_max_distance}},i.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,e){return e.options.prevent_mouseevents&&t.pointerType==h?void t.stopDetect():(e.options.prevent_default&&t.preventDefault(),void(t.eventType==u&&e.trigger(this.name,t)))}},i.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(t,e){if(T.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(t.touches.length>=2){if(e.options.transform_always_block&&t.preventDefault(),e.options.transform_within_instance)for(var r=-1;t.touches[++r];)if(!d.hasParent(t.touches[r].target,e.element))return;switch(t.eventType){case u:this.triggered=!1;break;case p:var i=Math.abs(1-t.scale),n=Math.abs(t.rotation);if(i<e.options.transform_min_scale&&n<e.options.transform_min_rotation)return;T.current.name=this.name,this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),n>e.options.transform_min_rotation&&e.trigger("rotate",t),i>e.options.transform_min_scale&&(e.trigger("pinch",t),e.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case m:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}}},"function"==typeof define&&define.amd?define(function(){return i}):"object"==typeof module&&module.exports?module.exports=i:t.Hammer=i}(window),contentLoaded(window,function(){function t(){h=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e3),h.position.y=performanceProfile.cameraY,h.position.z=performanceProfile.cameraZ,c=new THREE.Scene;var t=[new THREE.MeshBasicMaterial({overdraw:1,wireframe:!1,ambient:16777215,map:s[0]}),new THREE.MeshBasicMaterial({overdraw:1,wireframe:!1,ambient:16777215,map:s[1]}),new THREE.MeshBasicMaterial({overdraw:1,wireframe:!0}),new THREE.MeshBasicMaterial({overdraw:1,wireframe:!0}),new THREE.MeshBasicMaterial({overdraw:1,wireframe:!1,ambient:16777215,map:s[4]}),new THREE.MeshBasicMaterial({overdraw:1,wireframe:!1,ambient:16777215,map:s[5]})],r=performanceProfile.cubeLength,i=performanceProfile.textureMappingQuality;u=new THREE.Mesh(new THREE.CubeGeometry(r,r,r,i,i,i),new THREE.MeshFaceMaterial(t)),u.dynamic=!0,u.position.y=performanceProfile.cubeY,c.add(u),l=new THREE.CanvasRenderer,l.setClearColor(0),a.append(l.domElement),$(window).on("resize orientationchange",e),e()}function e(){var t=a.width(),e=a.height(),r=performanceProfile.canvasWidth,i=performanceProfile.canvasWidth;t<performanceProfile.canvasWidth&&(r=i=t),a.find("canvas").css({"margin-top":parseInt(e-i)/2+"px","margin-left":parseInt(t-i)/2+"px"}),h.aspect=1,h.updateProjectionMatrix(),l.setSize(r,i)}function r(t){var e=t.target,r=e.getBoundingClientRect(),i=t.gesture.center.pageX-r.left,n=t.gesture.center.pageY-r.top,o=[i,n];return o}function i(t){switch(t.gesture.preventDefault(),t.type){case"dragright":case"dragleft":m=0;var e,i=r(t);e=d?i[0]-d[0]>0?t.gesture.velocityX:-t.gesture.velocityX:t.gesture.deltaX>0?t.gesture.velocityX:-t.gesture.velocityX,m+=e/10,m=0>m?Math.max(-.1,m):Math.min(.1,m),d=i;break;case"tap":console.log("tap:"+t.gesture.deltaX+","+t.gesture.velocityX);var n=new THREE.Projector,o=r(t);p.x=(o[0]-150)/150,p.y=(o[1]-150)/150;var a=n.pickingRay(p.clone(),h),s=a.intersectObjects(c.children);if(s.length>0){var l=s[0].face.materialIndex;if(l>=0&&l<cubeLinks.length){var u="dialog=no,width="+window.innerWidth+",height="+window.innerHeight;window.open(cubeLinks[l],"_blank",u)}$("#linkster").length?$("#linkster").text(cubeLinks[l]):$("body").append('<div id="linkster" style="position:absolute; top:20px; left:20px; color:black; background: white;">'+cubeLinks[l]+"</div>")}$("#xy").length?$("#xy").text(parseInt(o[0])+","+parseInt(o[1])):$("body").append('<div id="xy" style="position:absolute; top:40px; left:40px; color:black; background: white;">'+parseInt(o[0])+","+parseInt(o[1])+"</div>")}}function n(){var t=new Hammer(l.domElement,{drag_lock_to_axis:!0});t.on("dragleft dragright tap",i)}function o(){E?(u.rotation.y+=m,m>0&&(m-=.001),0>m&&(m+=.001),Math.abs(m)>.001||(m=0)):(u.rotation.y+=.05,u.rotation.y<2*Math.PI||(E=!0,n())),l.render(c,h),requestAnimFrame(o)}var a=$(window.cubeContainer||"#mediacube");if(a.length){(/windows phone/i.test(ua.os.name)&&"7.5"==ua.os.version||/android/i.test(ua.os.name)&&/^2\.3/.test(ua.os.version||/^3\./.test(ua.os.version))||/symbian/i.test(ua.os.name))&&a.text("android 2.3.x or 3.x or wp7.x"),!/iphone/i.test(ua.device.model)&&!/ipad/i.test(ua.device.model)||window.devicePixelRatio>1||(performanceProfile.textureMappingQuality=2),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,50)}}();var s;THREE.ImageUtils.loadTexture(cubeImages[0],void 0,function(e){THREE.ImageUtils.loadTexture(cubeImages[1],void 0,function(r){THREE.ImageUtils.loadTexture(cubeImages[2],void 0,function(i){THREE.ImageUtils.loadTexture(cubeImages[3],void 0,function(n){e.wrapS=r.wrapS=i.wrapS=n.wrapS=e.wrapT=r.wrapT=i.wrapT=n.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1),r.repeat.set(1,1),i.repeat.set(1,1),n.repeat.set(1,1),e.anisotropy=r.anisotropy=i.anisotropy=n.anisotropy=1,s=[e,r,null,null,n,i],setTimeout(function(){t(),o()})})})})});var h,c,l,u,p=new THREE.Vector3,m=0,d=null,E=!1}});