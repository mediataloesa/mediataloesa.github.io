// user-agent parser https://github.com/faisalman/ua-parser-js
(function(window,undefined){"use strict";var EMPTY="",UNKNOWN="?",FUNC_TYPE="function",UNDEF_TYPE="undefined",OBJ_TYPE="object",MAJOR="major",MODEL="model",NAME="name",TYPE="type",VENDOR="vendor",VERSION="version",ARCHITECTURE="architecture",CONSOLE="console",MOBILE="mobile",TABLET="tablet";var util={has:function(str1,str2){return str2.toLowerCase().indexOf(str1.toLowerCase())!==-1},lowerize:function(str){return str.toLowerCase()}};var mapper={rgx:function(){for(var result,i=0,j,k,p,q,matches,match,args=arguments;i<args.length;i+=2){var regex=args[i],props=args[i+1];if(typeof result===UNDEF_TYPE){result={};for(p in props){q=props[p];if(typeof q===OBJ_TYPE){result[q[0]]=undefined}else{result[q]=undefined}}}for(j=k=0;j<regex.length;j++){matches=regex[j].exec(this.getUA());if(!!matches){for(p=0;p<props.length;p++){match=matches[++k];q=props[p];if(typeof q===OBJ_TYPE&&q.length>0){if(q.length==2){if(typeof q[1]==FUNC_TYPE){result[q[0]]=q[1].call(this,match)}else{result[q[0]]=q[1]}}else if(q.length==3){if(typeof q[1]===FUNC_TYPE&&!(q[1].exec&&q[1].test)){result[q[0]]=match?q[1].call(this,match,q[2]):undefined}else{result[q[0]]=match?match.replace(q[1],q[2]):undefined}}else if(q.length==4){result[q[0]]=match?q[3].call(this,match.replace(q[1],q[2])):undefined}}else{result[q]=match?match:undefined}}break}}if(!!matches)break}return result},str:function(str,map){for(var i in map){if(typeof map[i]===OBJ_TYPE&&map[i].length>0){for(var j=0;j<map[i].length;j++){if(util.has(map[i][j],str)){return i===UNKNOWN?undefined:i}}}else if(util.has(map[i],str)){return i===UNKNOWN?undefined:i}}return str}};var maps={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}};var regexes={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[NAME,VERSION,MAJOR],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[NAME,"Opera"],VERSION,MAJOR],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[NAME,VERSION,MAJOR],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[NAME,"IE"],VERSION,MAJOR],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[NAME,"Yandex"],VERSION,MAJOR],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[NAME,/_/g," "],VERSION,MAJOR],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[NAME,VERSION,MAJOR],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[NAME,"Dolphin"],VERSION,MAJOR],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[NAME,"Chrome"],VERSION,MAJOR],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[VERSION,MAJOR,[NAME,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[VERSION,MAJOR,NAME],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[NAME,[MAJOR,mapper.str,maps.browser.oldsafari.major],[VERSION,mapper.str,maps.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[NAME,VERSION,MAJOR],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[NAME,"Netscape"],VERSION,MAJOR],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[NAME,VERSION,MAJOR]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[ARCHITECTURE,"amd64"]],[/((?:i[346]|x)86)[;\)]/i],[[ARCHITECTURE,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[ARCHITECTURE,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[ARCHITECTURE,/ower/,"",util.lowerize]],[/(sun4\w)[;\)]/i],[[ARCHITECTURE,"sparc"]],[/(ia64(?=;)|68k(?=\))|arm(?=v\d+;)|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[ARCHITECTURE,util.lowerize]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[MODEL,VENDOR,[TYPE,TABLET]],[/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[VENDOR,MODEL,[TYPE,TABLET]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[MODEL,VENDOR,[TYPE,MOBILE]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[VENDOR,MODEL,[TYPE,MOBILE]],[/\((bb10);\s(\w+)/i],[[VENDOR,"BlackBerry"],MODEL,[TYPE,MOBILE]],[/android.+((transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+))/i],[[VENDOR,"Asus"],MODEL,[TYPE,TABLET]],[/(sony)\s(tablet\s[ps])/i],[VENDOR,MODEL,[TYPE,TABLET]],[/(nintendo)\s([wids3u]+)/i],[VENDOR,MODEL,[TYPE,CONSOLE]],[/((playstation)\s[3portablevi]+)/i],[[VENDOR,"Sony"],MODEL,[TYPE,CONSOLE]],[/(sprint\s(\w+))/i],[[VENDOR,mapper.str,maps.device.sprint.vendor],[MODEL,mapper.str,maps.device.sprint.model],[TYPE,MOBILE]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[VENDOR,[MODEL,/_/g," "],[TYPE,MOBILE]],[/\s((milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?))[\w\s]+build\//i,/(mot)[\s-]?(\w+)*/i],[[VENDOR,"Motorola"],MODEL,[TYPE,MOBILE]],[/android.+\s((mz60\d|xoom[\s2]{0,2}))\sbuild\//i],[[VENDOR,"Motorola"],MODEL,[TYPE,TABLET]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9))/i],[[VENDOR,"Samsung"],MODEL,[TYPE,TABLET]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[VENDOR,"Samsung"],MODEL,[TYPE,MOBILE]],[/(sie)-(\w+)*/i],[[VENDOR,"Siemens"],MODEL,[TYPE,MOBILE]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[VENDOR,"Nokia"],MODEL,[TYPE,MOBILE]],[/android\s3\.[\s\w-;]{10}((a\d{3}))/i],[[VENDOR,"Acer"],MODEL,[TYPE,TABLET]],[/android\s3\.[\s\w-;]{10}(lg?)-([06cv9]{3,4})/i],[[VENDOR,"LG"],MODEL,[TYPE,TABLET]],[/((nexus\s4))/i,/((nexus\s5))/i,/(lg)[e;\s-\/]+(\w+)*/i],[[VENDOR,"LG"],MODEL,[TYPE,MOBILE]],[/(mobile|tablet);.+rv\:.+gecko\//i],[TYPE,VENDOR,MODEL]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[NAME,VERSION],[/rv\:([\w\.]+).*(gecko)/i],[VERSION,NAME]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[NAME,[VERSION,mapper.str,maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[NAME,"Windows"],[VERSION,mapper.str,maps.os.windows.version]],[/\((bb)(10);/i],[[NAME,"BlackBerry"],VERSION],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[NAME,VERSION],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[NAME,"Symbian"],VERSION],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[NAME,"Firefox OS"],VERSION],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[NAME,VERSION],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[NAME,"Chromium OS"],VERSION],[/(sunos)\s?([\w\.]+\d)*/i],[[NAME,"Solaris"],VERSION],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[NAME,VERSION],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[NAME,"iOS"],[VERSION,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[NAME,[VERSION,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[NAME,VERSION]]};var UAParser=function(uastring){var ua=uastring||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:EMPTY);if(!(this instanceof UAParser)){return new UAParser(uastring).getResult()}this.getBrowser=function(){return mapper.rgx.apply(this,regexes.browser)};this.getCPU=function(){return mapper.rgx.apply(this,regexes.cpu)};this.getDevice=function(){return mapper.rgx.apply(this,regexes.device)};this.getEngine=function(){return mapper.rgx.apply(this,regexes.engine)};this.getOS=function(){return mapper.rgx.apply(this,regexes.os)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}};this.getUA=function(){return ua};this.setUA=function(uastring){ua=uastring;return this};this.setUA(ua)};if(typeof exports!==UNDEF_TYPE){if(typeof module!==UNDEF_TYPE&&module.exports){exports=module.exports=UAParser}exports.UAParser=UAParser}else{window.UAParser=UAParser;if(typeof define===FUNC_TYPE&&define.amd){define(function(){return UAParser})}if(typeof window.jQuery!==UNDEF_TYPE){var $=window.jQuery;var parser=new UAParser;$.ua=parser.getResult();$.ua.get=function(){return parser.getUA()};$.ua.set=function(uastring){parser.setUA(uastring);var result=parser.getResult();for(var prop in result){$.ua[prop]=result[prop]}}}}})(this);

// defaults to high performance
var performanceProfile = {
	cubeLength:300,
	cubeY:150,
	canvasWidth:300,
	cameraZ:420,
	cameraY:150,
	textureMappingQuality:4,	// higher better but uses more memory
};

var parser = new UAParser();
var ua = parser.getResult();

// IE9 or lower doesnt have TypedArrays, see http://caniuse.com/#search=typeda
(function(e){"use strict";function r(e){switch(typeof e){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return e===null?"null":"object"}}function i(e){return Object.prototype.toString.call(e).replace(/^\[object *|\]$/g,"")}function s(e){return typeof e==="function"}function o(e){if(e===null||e===t)throw TypeError();return Object(e)}function u(e){return e>>0}function a(e){return e>>>0}function g(e){function t(t){Object.defineProperty(e,t,{get:function(){return e._getter(t)},set:function(n){e._setter(t,n)},enumerable:true,configurable:false})}if(e.length>n)throw RangeError("Array too large for polyfill");var r;for(r=0;r<e.length;r+=1){t(r)}}function y(e,t){var n=32-t;return e<<n>>n}function b(e,t){var n=32-t;return e<<n>>>n}function w(e){return[e&255]}function E(e){return y(e[0],8)}function S(e){return[e&255]}function x(e){return b(e[0],8)}function T(e){e=m(Number(e));return[e<0?0:e>255?255:e&255]}function N(e){return[e>>8&255,e&255]}function C(e){return y(e[0]<<8|e[1],16)}function k(e){return[e>>8&255,e&255]}function L(e){return b(e[0]<<8|e[1],16)}function A(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]}function O(e){return y(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function M(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]}function _(e){return b(e[0]<<24|e[1]<<16|e[2]<<8|e[3],32)}function D(e,t,n){function y(e){var t=c(e),n=e-t;if(n<.5)return t;if(n>.5)return t+1;return t%2?t+1:t}var r=(1<<t-1)-1,i,s,o,u,a,p,m,g;if(e!==e){s=(1<<t)-1;o=v(2,n-1);i=0}else if(e===Infinity||e===-Infinity){s=(1<<t)-1;o=0;i=e<0?1:0}else if(e===0){s=0;o=0;i=1/e===-Infinity?1:0}else{i=e<0;e=l(e);if(e>=v(2,1-r)){s=d(c(h(e)/f),1023);o=y(e/v(2,s)*v(2,n));if(o/v(2,n)>=2){s=s+1;o=1}if(s>r){s=(1<<t)-1;o=0}else{s=s+r;o=o-v(2,n)}}else{s=0;o=y(e/v(2,1-r-n))}}p=[];for(a=n;a;a-=1){p.push(o%2?1:0);o=c(o/2)}for(a=t;a;a-=1){p.push(s%2?1:0);s=c(s/2)}p.push(i?1:0);p.reverse();m=p.join("");g=[];while(m.length){g.push(parseInt(m.substring(0,8),2));m=m.substring(8)}return g}function P(e,t,n){var r=[],i,s,o,u,a,f,l,c;for(i=e.length;i;i-=1){o=e[i-1];for(s=8;s;s-=1){r.push(o%2?1:0);o=o>>1}}r.reverse();u=r.join("");a=(1<<t-1)-1;f=parseInt(u.substring(0,1),2)?-1:1;l=parseInt(u.substring(1,1+t),2);c=parseInt(u.substring(1+t),2);if(l===(1<<t)-1){return c!==0?NaN:f*Infinity}else if(l>0){return f*v(2,l-a)*(1+c/v(2,n))}else if(c!==0){return f*v(2,-(a-1))*(c/v(2,n))}else{return f<0?-0:0}}function H(e){return P(e,11,52)}function B(e){return D(e,11,52)}function j(e){return P(e,8,23)}function F(e){return D(e,8,23)}var t=void 0;var n=1e5;var f=Math.LN2,l=Math.abs,c=Math.floor,h=Math.log,p=Math.max,d=Math.min,v=Math.pow,m=Math.round;(function(){var e=Object.defineProperty;var t=!function(){try{return Object.defineProperty({},"x",{})}catch(e){return false}}();if(!e||t){Object.defineProperty=function(t,n,r){if(e)try{return e(t,n,r)}catch(i){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");if(Object.prototype.__defineGetter__&&"get"in r)Object.prototype.__defineGetter__.call(t,n,r.get);if(Object.prototype.__defineSetter__&&"set"in r)Object.prototype.__defineSetter__.call(t,n,r.set);if("value"in r)t[n]=r.value;return t}}})();(function(){function n(e){e=u(e);if(e<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:e});Object.defineProperty(this,"_bytes",{value:Array(e)});for(var t=0;t<e;t+=1)this._bytes[t]=0}function f(){if(!arguments.length||typeof arguments[0]!=="object"){return function(e){e=u(e);if(e<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:e});Object.defineProperty(this,"byteLength",{value:e*this.BYTES_PER_ELEMENT});Object.defineProperty(this,"buffer",{value:new n(this.byteLength)});Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments)}if(arguments.length>=1&&r(arguments[0])==="object"&&arguments[0]instanceof f){return function(e){if(this.constructor!==e.constructor)throw TypeError();var t=e.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new n(t)});Object.defineProperty(this,"byteLength",{value:t});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:e.length});for(var r=0;r<this.length;r+=1)this._setter(r,e._getter(r))}.apply(this,arguments)}if(arguments.length>=1&&r(arguments[0])==="object"&&!(arguments[0]instanceof f)&&!(arguments[0]instanceof n||i(arguments[0])==="ArrayBuffer")){return function(e){var t=e.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new n(t)});Object.defineProperty(this,"byteLength",{value:t});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:e.length});for(var r=0;r<this.length;r+=1){var i=e[r];this._setter(r,Number(i))}}.apply(this,arguments)}if(arguments.length>=1&&r(arguments[0])==="object"&&(arguments[0]instanceof n||i(arguments[0])==="ArrayBuffer")){return function(e,n,r){n=a(n);if(n>e.byteLength)throw RangeError("byteOffset out of range");if(n%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(r===t){var i=e.byteLength-n;if(i%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");r=i/this.BYTES_PER_ELEMENT}else{r=a(r);i=r*this.BYTES_PER_ELEMENT}if(n+i>e.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:e});Object.defineProperty(this,"byteLength",{value:i});Object.defineProperty(this,"byteOffset",{value:n});Object.defineProperty(this,"length",{value:r})}.apply(this,arguments)}throw TypeError()}function v(e,t,n){var r=function(){Object.defineProperty(this,"constructor",{value:r});f.apply(this,arguments);g(this)};if("__proto__"in r){r.__proto__=f}else{r.from=f.from;r.of=f.of}r.BYTES_PER_ELEMENT=e;var i=function(){};i.prototype=h;r.prototype=new i;Object.defineProperty(r.prototype,"BYTES_PER_ELEMENT",{value:e});Object.defineProperty(r.prototype,"_pack",{value:t});Object.defineProperty(r.prototype,"_unpack",{value:n});return r}e.ArrayBuffer=e.ArrayBuffer||n;Object.defineProperty(f,"from",{value:function(e){return new this(e)}});Object.defineProperty(f,"of",{value:function(){return new this(arguments)}});var h={};f.prototype=h;Object.defineProperty(f.prototype,"_getter",{value:function(e){if(arguments.length<1)throw SyntaxError("Not enough arguments");e=a(e);if(e>=this.length)return t;var n=[],r,i;for(r=0,i=this.byteOffset+e*this.BYTES_PER_ELEMENT;r<this.BYTES_PER_ELEMENT;r+=1,i+=1){n.push(this.buffer._bytes[i])}return this._unpack(n)}});Object.defineProperty(f.prototype,"get",{value:f.prototype._getter});Object.defineProperty(f.prototype,"_setter",{value:function(e,t){if(arguments.length<2)throw SyntaxError("Not enough arguments");e=a(e);if(e>=this.length)return;var n=this._pack(t),r,i;for(r=0,i=this.byteOffset+e*this.BYTES_PER_ELEMENT;r<this.BYTES_PER_ELEMENT;r+=1,i+=1){this.buffer._bytes[i]=n[r]}}});Object.defineProperty(f.prototype,"constructor",{value:f});Object.defineProperty(f.prototype,"copyWithin",{value:function(e,n){var r=arguments[2];var i=o(this);var s=i.length;var f=a(s);f=p(f,0);var l=u(e);var c;if(l<0)c=p(f+l,0);else c=d(l,f);var h=u(n);var v;if(h<0)v=p(f+h,0);else v=d(h,f);var m;if(r===t)m=f;else m=u(r);var g;if(m<0)g=p(f+m,0);else g=d(m,f);var y=d(g-v,f-c);var b;if(v<c&&c<v+y){b=-1;v=v+y-1;c=c+y-1}else{b=1}while(y>0){i._setter(c,i._getter(v));v=v+b;c=c+b;y=y-1}return i}});Object.defineProperty(f.prototype,"every",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();var i=arguments[1];for(var o=0;o<r;o++){if(!e.call(i,n._getter(o),o,n))return false}return true}});Object.defineProperty(f.prototype,"fill",{value:function(e){var n=arguments[1],r=arguments[2];var i=o(this);var s=i.length;var f=a(s);f=p(f,0);var l=u(n);var c;if(l<0)c=p(f+l,0);else c=d(l,f);var h;if(r===t)h=f;else h=u(r);var v;if(h<0)v=p(f+h,0);else v=d(h,f);while(c<v){i._setter(c,e);c+=1}return i}});Object.defineProperty(f.prototype,"filter",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();var i=[];var o=arguments[1];for(var u=0;u<r;u++){var f=n._getter(u);if(e.call(o,f,u,n))i.push(f)}return new this.constructor(i)}});Object.defineProperty(f.prototype,"find",{value:function(e){var n=o(this);var r=n.length;var i=a(r);if(!s(e))throw TypeError();var u=arguments.length>1?arguments[1]:t;var f=0;while(f<i){var l=n._getter(f);var c=e.call(u,l,f,n);if(Boolean(c))return l;++f}return t}});Object.defineProperty(f.prototype,"findIndex",{value:function(e){var n=o(this);var r=n.length;var i=a(r);if(!s(e))throw TypeError();var u=arguments.length>1?arguments[1]:t;var f=0;while(f<i){var l=n._getter(f);var c=e.call(u,l,f,n);if(Boolean(c))return f;++f}return-1}});Object.defineProperty(f.prototype,"forEach",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();var i=arguments[1];for(var o=0;o<r;o++)e.call(i,n._getter(o),o,n)}});Object.defineProperty(f.prototype,"indexOf",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(r===0)return-1;var i=0;if(arguments.length>0){i=Number(arguments[1]);if(i!==i){i=0}else if(i!==0&&i!==1/0&&i!==-(1/0)){i=(i>0||-1)*c(l(i))}}if(i>=r)return-1;var s=i>=0?i:p(r-l(i),0);for(;s<r;s++){if(n._getter(s)===e){return s}}return-1}});Object.defineProperty(f.prototype,"join",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);var i=Array(r);for(var s=0;s<r;++s)i[s]=n._getter(s);return i.join(e===t?",":e)}});Object.defineProperty(f.prototype,"lastIndexOf",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(r===0)return-1;var i=r;if(arguments.length>1){i=Number(arguments[1]);if(i!==i){i=0}else if(i!==0&&i!==1/0&&i!==-(1/0)){i=(i>0||-1)*c(l(i))}}var s=i>=0?d(i,r-1):r-l(i);for(;s>=0;s--){if(n._getter(s)===e)return s}return-1}});Object.defineProperty(f.prototype,"map",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();var i=[];i.length=r;var o=arguments[1];for(var u=0;u<r;u++)i[u]=e.call(o,n._getter(u),u,n);return new this.constructor(i)}});Object.defineProperty(f.prototype,"reduce",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();if(r===0&&arguments.length===1)throw TypeError();var i=0;var o;if(arguments.length>=2){o=arguments[1]}else{o=n._getter(i++)}while(i<r){o=e.call(t,o,n._getter(i),i,n);i++}return o}});Object.defineProperty(f.prototype,"reduceRight",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();if(r===0&&arguments.length===1)throw TypeError();var i=r-1;var o;if(arguments.length>=2){o=arguments[1]}else{o=n._getter(i--)}while(i>=0){o=e.call(t,o,n._getter(i),i,n);i--}return o}});Object.defineProperty(f.prototype,"reverse",{value:function(){if(this===t||this===null)throw TypeError();var e=Object(this);var n=a(e.length);var r=c(n/2);for(var i=0,s=n-1;i<r;++i,--s){var o=e._getter(i);e._setter(i,e._getter(s));e._setter(s,o)}return e}});Object.defineProperty(f.prototype,"set",{value:function(e,t){if(arguments.length<1)throw SyntaxError("Not enough arguments");var n,r,i,s,o,u,f,l,c,h;if(typeof arguments[0]==="object"&&arguments[0].constructor===this.constructor){n=arguments[0];i=a(arguments[1]);if(i+n.length>this.length){throw RangeError("Offset plus length of array is out of range")}l=this.byteOffset+i*this.BYTES_PER_ELEMENT;c=n.length*this.BYTES_PER_ELEMENT;if(n.buffer===this.buffer){h=[];for(o=0,u=n.byteOffset;o<c;o+=1,u+=1){h[o]=n.buffer._bytes[u]}for(o=0,f=l;o<c;o+=1,f+=1){this.buffer._bytes[f]=h[o]}}else{for(o=0,u=n.byteOffset,f=l;o<c;o+=1,u+=1,f+=1){this.buffer._bytes[f]=n.buffer._bytes[u]}}}else if(typeof arguments[0]==="object"&&typeof arguments[0].length!=="undefined"){r=arguments[0];s=a(r.length);i=a(arguments[1]);if(i+s>this.length){throw RangeError("Offset plus length of array is out of range")}for(o=0;o<s;o+=1){u=r[o];this._setter(i+o,Number(u))}}else{throw TypeError("Unexpected argument type(s)")}}});Object.defineProperty(f.prototype,"slice",{value:function(e,n){var r=o(this);var i=r.length;var s=a(i);var f=u(e);var l=f<0?p(s+f,0):d(f,s);var c=n===t?s:u(n);var h=c<0?p(s+c,0):d(c,s);var v=h-l;var m=r.constructor;var g=new m(v);var y=0;while(l<h){var b=r._getter(l);g._setter(y,b);++l;++y}return g}});Object.defineProperty(f.prototype,"some",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);if(!s(e))throw TypeError();var i=arguments[1];for(var o=0;o<r;o++){if(e.call(i,n._getter(o),o,n)){return true}}return false}});Object.defineProperty(f.prototype,"sort",{value:function(e){if(this===t||this===null)throw TypeError();var n=Object(this);var r=a(n.length);var i=Array(r);for(var s=0;s<r;++s)i[s]=n._getter(s);if(e)i.sort(e);else i.sort();for(s=0;s<r;++s)n._setter(s,i[s]);return n}});Object.defineProperty(f.prototype,"subarray",{value:function(e,t){function n(e,t,n){return e<t?t:e>n?n:e}e=u(e);t=u(t);if(arguments.length<1){e=0}if(arguments.length<2){t=this.length}if(e<0){e=this.length+e}if(t<0){t=this.length+t}e=n(e,0,this.length);t=n(t,0,this.length);var r=t-e;if(r<0){r=0}return new this.constructor(this.buffer,this.byteOffset+e*this.BYTES_PER_ELEMENT,r)}});var m=v(1,w,E);var y=v(1,S,x);var b=v(1,T,x);var D=v(2,N,C);var P=v(2,k,L);var I=v(4,A,O);var q=v(4,M,_);var R=v(4,F,j);var U=v(8,B,H);e.Int8Array=e.Int8Array||m;e.Uint8Array=e.Uint8Array||y;e.Uint8ClampedArray=e.Uint8ClampedArray||b;e.Int16Array=e.Int16Array||D;e.Uint16Array=e.Uint16Array||P;e.Int32Array=e.Int32Array||I;e.Uint32Array=e.Uint32Array||q;e.Float32Array=e.Float32Array||R;e.Float64Array=e.Float64Array||U})();(function(){function n(e,t){return s(e.get)?e.get(t):e[t]}function o(e,n,r){if(!(e instanceof ArrayBuffer||i(e)==="ArrayBuffer"))throw TypeError();n=a(n);if(n>e.byteLength)throw RangeError("byteOffset out of range");if(r===t)r=e.byteLength-n;else r=a(r);if(n+r>e.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:e});Object.defineProperty(this,"byteLength",{value:r});Object.defineProperty(this,"byteOffset",{value:n})}function u(e){return function(i,s){i=a(i);if(i+e.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");i+=this.byteOffset;var o=new Uint8Array(this.buffer,i,e.BYTES_PER_ELEMENT),u=[];for(var f=0;f<e.BYTES_PER_ELEMENT;f+=1)u.push(n(o,f));if(Boolean(s)===Boolean(r))u.reverse();return n(new e((new Uint8Array(u)).buffer),0)}}function f(e){return function(i,s,o){i=a(i);if(i+e.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var u=new e([s]),f=new Uint8Array(u.buffer),l=[],c,h;for(c=0;c<e.BYTES_PER_ELEMENT;c+=1)l.push(n(f,c));if(Boolean(o)===Boolean(r))l.reverse();h=new Uint8Array(this.buffer,i,e.BYTES_PER_ELEMENT);h.set(l)}}var r=function(){var e=new Uint16Array([4660]),t=new Uint8Array(e.buffer);return n(t,0)===18}();Object.defineProperty(o.prototype,"getUint8",{value:u(Uint8Array)});Object.defineProperty(o.prototype,"getInt8",{value:u(Int8Array)});Object.defineProperty(o.prototype,"getUint16",{value:u(Uint16Array)});Object.defineProperty(o.prototype,"getInt16",{value:u(Int16Array)});Object.defineProperty(o.prototype,"getUint32",{value:u(Uint32Array)});Object.defineProperty(o.prototype,"getInt32",{value:u(Int32Array)});Object.defineProperty(o.prototype,"getFloat32",{value:u(Float32Array)});Object.defineProperty(o.prototype,"getFloat64",{value:u(Float64Array)});Object.defineProperty(o.prototype,"setUint8",{value:f(Uint8Array)});Object.defineProperty(o.prototype,"setInt8",{value:f(Int8Array)});Object.defineProperty(o.prototype,"setUint16",{value:f(Uint16Array)});Object.defineProperty(o.prototype,"setInt16",{value:f(Int16Array)});Object.defineProperty(o.prototype,"setUint32",{value:f(Uint32Array)});Object.defineProperty(o.prototype,"setInt32",{value:f(Int32Array)});Object.defineProperty(o.prototype,"setFloat32",{value:f(Float32Array)});Object.defineProperty(o.prototype,"setFloat64",{value:f(Float64Array)});e.DataView=e.DataView||o})()})(this)

// three.js - http://github.com/mrdoob/three.js
'use strict';var THREE={REVISION:"65"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};THREE.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=c[d];Object.defineProperty(a,f,Object.getOwnPropertyDescriptor(b,f))}else for(f in c={}.hasOwnProperty,b)c.call(b,f)&&(a[f]=b[f]);return a};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=self.setTimeout(function(){b(c+f)},f);a=c+f;return g});void 0===self.cancelAnimationFrame&&void 0!==
	self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;
THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;
THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;
THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;
THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){void 0!==a&&this.set(a);return this};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+6*(b-a)*
	c:0.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a},b=0.5>=c?c*(1+b):c+b-c*b,c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
	Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
	a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<
	8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){var a=a||{h:0,s:0,l:0},b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var i=e-f,f=0.5>=h?i/(e+f):i/(2-e-f);switch(e){case b:g=(c-d)/i+(c<d?6:0);break;case c:g=(d-b)/i+2;break;case d:g=(b-c)/i+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
																																																																																																																														b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
	this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={};THREE.Quaternion=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(a){this._x=a;this._updateEuler()},get y(){return this._y},set y(a){this._y=a;this._updateEuler()},get z(){return this._z},set z(a){this._z=a;this._updateEuler()},get w(){return this._w},set w(a){this._w=a;this._updateEuler()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;
	this._updateEuler();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._w=a._w;this._updateEuler();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),e=Math.cos(a._z/2),f=Math.sin(a._x/2),g=Math.sin(a._y/2),h=Math.sin(a._z/2);"XYZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*
	e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"YXZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"ZXY"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"ZYX"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"YZX"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e-f*g*h):"XZY"===a.order&&(this._x=f*d*e-c*g*h,this._y=c*g*e-f*d*h,this._z=
	c*d*h+f*g*e,this._w=c*d*e+f*g*h);!1!==b&&this._updateEuler();return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this._updateEuler();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0],a=b[4],d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],i=b[6],b=b[10],j=c+f+b;0<j?(c=0.5/Math.sqrt(j+1),this._w=0.25/c,this._x=(i-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(i-g)/c,this._x=0.25*c,
	this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=0.25*c,this._z=(g+i)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+i)/c,this._z=0.25*c);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*
	this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=
	a._w,g=b._x,h=b._y,i=b._z,j=b._w;this._x=c*j+f*g+d*i-e*h;this._y=d*j+f*h+e*g-c*i;this._z=e*j+f*i+c*h-d*g;this._w=f*j-c*g-d*h-e*i;this._updateEuler();return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=
	-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(g),i=Math.sqrt(1-g*g);if(0.0010>Math.abs(i))return this._w=0.5*(f+this._w),this._x=0.5*(c+this._x),this._y=0.5*(d+this._y),this._z=0.5*(e+this._z),this;g=Math.sin((1-b)*h)/i;h=Math.sin(b*h)/i;this._w=f*g+this._w*h;this._x=c*g+this._x*h;this._y=d*g+this._y*h;this._z=e*g+this._z*h;this._updateEuler();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},
	fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];this._w=a[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
																																																																																																																														 b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=
	a.y;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);
	return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/
	b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
	a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
	this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
	b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements,e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);
	this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,a=a.w,h=a*b+f*d-g*c,i=a*c+g*b-e*d,j=a*d+e*c-f*b,b=-e*b-f*c-g*d;this.x=h*a+b*-e+i*-g-j*-f;this.y=i*a+b*-f+j*-e-h*-g;this.z=j*a+b*-g+h*-f-i*-e;return this},transformDirection:function(a){var b=this.x,c=this.y,d=this.z,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*
	b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<
	a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
	setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){var c=
		a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;this.x=d*h-e*g;this.y=e*f-c*h;this.z=c*g-d*f;return this},angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},
	setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code.");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code.");
		return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code.");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),
		a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var a=new THREE.Quaternion;return function(b){!1===b instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a=new THREE.Quaternion;return function(b,c){this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),projectOnVector:function(){var a=new THREE.Vector3;
	return function(b){a.copy(b).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new THREE.Vector3;return function(b){a.copy(this).projectOnVector(b).multiplyScalar(2);return this.subVectors(a,this)}}()});THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
	case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
	addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},
	applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,
		this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d,a=a.elements,e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],i=a[9];c=a[2];b=a[6];var j=a[10];if(0.01>Math.abs(d-g)&&0.01>Math.abs(f-c)&&0.01>Math.abs(i-b)){if(0.1>Math.abs(d+g)&&0.1>Math.abs(f+c)&&0.1>Math.abs(i+b)&&0.1>Math.abs(e+h+j-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;j=(j+1)/2;d=(d+g)/4;f=(f+c)/4;i=(i+b)/4;e>h&&e>j?0.01>e?(b=0,d=c=0.707106781):(b=Math.sqrt(e),c=d/b,d=f/b):h>j?0.01>h?
		(b=0.707106781,c=0,d=0.707106781):(c=Math.sqrt(h),b=d/c,d=i/c):0.01>j?(c=b=0.707106781,d=0):(d=Math.sqrt(j),b=f/d,c=i/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-i)*(b-i)+(f-c)*(f-c)+(g-d)*(g-d));0.0010>Math.abs(a)&&(a=1);this.x=(b-i)/a;this.y=(f-c)/a;this.z=(g-d)/a;this.w=Math.acos((e+h+j-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=
		a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
		this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&
		a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(a){this._x=a;this._updateQuaternion()},get y(){return this._y},set y(a){this._y=a;this._updateQuaternion()},get z(){return this._z},set z(a){this._z=a;this._updateQuaternion()},get order(){return this._order},set order(a){this._order=a;this._updateQuaternion()},
	set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this._updateQuaternion();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._updateQuaternion();return this},setFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],i=d[5],j=d[9],k=d[2],p=d[6],d=d[10],b=b||this._order;"XYZ"===b?(this._y=Math.asin(c(g)),0.99999>Math.abs(g)?(this._x=Math.atan2(-j,d),this._z=
		Math.atan2(-f,e)):(this._x=Math.atan2(p,i),this._z=0)):"YXZ"===b?(this._x=Math.asin(-c(j)),0.99999>Math.abs(j)?(this._y=Math.atan2(g,d),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,e),this._z=0)):"ZXY"===b?(this._x=Math.asin(c(p)),0.99999>Math.abs(p)?(this._y=Math.atan2(-k,d),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,e))):"ZYX"===b?(this._y=Math.asin(-c(k)),0.99999>Math.abs(k)?(this._x=Math.atan2(p,d),this._z=Math.atan2(h,e)):(this._x=0,this._z=Math.atan2(-f,i))):"YZX"===b?(this._z=
		Math.asin(c(h)),0.99999>Math.abs(h)?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,e)):(this._x=0,this._y=Math.atan2(g,d))):"XZY"===b?(this._z=Math.asin(-c(f)),0.99999>Math.abs(f)?(this._x=Math.atan2(p,i),this._y=Math.atan2(g,e)):(this._x=Math.atan2(-j,d),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+b);this._order=b;this._updateQuaternion();return this},setFromQuaternion:function(a,b,c){function d(a){return Math.min(Math.max(a,-1),1)}var e=a.x*a.x,f=
		a.y*a.y,g=a.z*a.z,h=a.w*a.w,b=b||this._order;"XYZ"===b?(this._x=Math.atan2(2*(a.x*a.w-a.y*a.z),h-e-f+g),this._y=Math.asin(d(2*(a.x*a.z+a.y*a.w))),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+e-f-g)):"YXZ"===b?(this._x=Math.asin(d(2*(a.x*a.w-a.y*a.z))),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-e-f+g),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-e+f-g)):"ZXY"===b?(this._x=Math.asin(d(2*(a.x*a.w+a.y*a.z))),this._y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-e-f+g),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-e+f-g)):"ZYX"===
		b?(this._x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-e-f+g),this._y=Math.asin(d(2*(a.y*a.w-a.x*a.z))),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+e-f-g)):"YZX"===b?(this._x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-e+f-g),this._y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+e-f-g),this._z=Math.asin(d(2*(a.x*a.y+a.z*a.w)))):"XZY"===b?(this._x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-e+f-g),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+e-f-g),this._z=Math.asin(d(2*(a.z*a.w-a.x*a.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+
		b);this._order=b;!1!==c&&this._updateQuaternion();return this},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},clone:function(){return new THREE.Euler(this._x,
		this._y,this._z,this._order)}};THREE.Matrix3=function(a,b,c,d,e,f,g,h,i){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==e?e:1,f||0,g||0,h||0,void 0!==i?i:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,g,h,i){var j=this.elements;j[0]=a;j[3]=b;j[6]=c;j[1]=d;j[4]=e;j[7]=f;j[2]=g;j[5]=h;j[8]=i;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
	multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],a=a[8];return b*f*a-b*g*i-c*e*a+c*g*h+d*e*i-d*f*h},getInverse:function(a,
																																																																																																																															 b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
		c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],
		a[6],a[7],a[8]]},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};THREE.Matrix4=function(a,b,c,d,e,f,g,h,i,j,k,p,m,r,s,q){var l=this.elements=new Float32Array(16);l[0]=void 0!==a?a:1;l[4]=b||0;l[8]=c||0;l[12]=d||0;l[1]=e||0;l[5]=void 0!==f?f:1;l[9]=g||0;l[13]=h||0;l[2]=i||0;l[6]=j||0;l[10]=void 0!==k?k:1;l[14]=p||0;l[3]=m||0;l[7]=r||0;l[11]=s||0;l[15]=void 0!==q?q:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,p,m,r,s,q){var l=this.elements;l[0]=a;l[4]=b;l[8]=c;l[12]=d;l[1]=e;l[5]=f;l[9]=g;l[13]=h;l[2]=i;l[6]=j;l[10]=k;l[14]=p;l[3]=m;l[7]=r;l[11]=s;l[15]=q;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
	return this.copyPosition(a)},copyPosition:function(a){var b=this.elements,a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements,b=b.elements,d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),makeRotationFromEuler:function(a){!1===
	a instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),c=Math.sin(c),g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e);if("XYZ"===a.order){var a=f*h,i=f*e,j=c*h,k=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=i+j*d;b[5]=a-k*d;b[9]=-c*g;b[2]=k-a*d;b[6]=j+i*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,i=g*e,j=d*h,k=d*e,b[0]=a+k*c,b[4]=j*c-i,b[8]=
	f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=i*c-j,b[6]=k+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,i=g*e,j=d*h,k=d*e,b[0]=a-k*c,b[4]=-f*e,b[8]=j+i*c,b[1]=i+j*c,b[5]=f*h,b[9]=k-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,i=f*e,j=c*h,k=c*e,b[0]=g*h,b[4]=j*d-i,b[8]=a*d+k,b[1]=g*e,b[5]=k*d+a,b[9]=i*d-j,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,i=f*d,j=c*g,k=c*d,b[0]=g*h,b[4]=k-a*e,b[8]=j*e+i,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=i*e+j,b[10]=a-k*e):"XZY"===a.order&&(a=f*g,i=f*d,j=c*g,k=c*d,b[0]=
	g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+k,b[5]=f*h,b[9]=i*e-j,b[2]=j*e-i,b[6]=c*h,b[10]=k*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,a=c*g,j=c*h,c=
	c*i,k=d*h,d=d*i,e=e*i,g=f*g,h=f*h,f=f*i;b[0]=1-(k+e);b[4]=j-f;b[8]=c+h;b[1]=j+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+k);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var g=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());b.crossVectors(c,a);g[0]=a.x;
	g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],p=c[9],m=c[13],r=c[2],s=c[6],q=c[10],l=c[14],n=c[3],t=c[7],w=c[11],c=c[15],
	B=d[0],I=d[4],F=d[8],z=d[12],A=d[1],y=d[5],D=d[9],E=d[13],u=d[2],v=d[6],x=d[10],G=d[14],C=d[3],L=d[7],O=d[11],d=d[15];e[0]=f*B+g*A+h*u+i*C;e[4]=f*I+g*y+h*v+i*L;e[8]=f*F+g*D+h*x+i*O;e[12]=f*z+g*E+h*G+i*d;e[1]=j*B+k*A+p*u+m*C;e[5]=j*I+k*y+p*v+m*L;e[9]=j*F+k*D+p*x+m*O;e[13]=j*z+k*E+p*G+m*d;e[2]=r*B+s*A+q*u+l*C;e[6]=r*I+s*y+q*v+l*L;e[10]=r*F+s*D+q*x+l*O;e[14]=r*z+s*E+q*G+l*d;e[3]=n*B+t*A+w*u+c*C;e[7]=n*I+t*y+w*v+c*L;e[11]=n*F+t*D+w*x+c*O;e[15]=n*z+t*E+w*G+c*d;return this},multiplyToArray:function(a,b,
																																																																																																																													  c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
	return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,d=b.length;c<d;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
	a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],p=a[10],m=a[14];return a[3]*(+e*h*k-d*i*k-e*g*p+c*i*p+d*g*m-c*h*m)+a[7]*(+b*h*m-b*i*p+e*f*p-d*f*m+d*i*j-e*h*j)+a[11]*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*p+d*f*k-c*f*
	p+c*h*j)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;
	a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;
	b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],p=d[13],m=d[2],r=d[6],s=d[10],q=d[14],l=d[3],n=d[7],t=d[11],d=d[15];c[0]=k*q*n-p*s*n+p*r*t-j*q*t-k*r*d+j*s*d;c[4]=h*s*n-g*q*n-h*r*t+f*q*t+g*r*d-f*s*d;c[8]=g*p*n-h*k*n+h*j*t-f*p*t-g*j*d+f*k*d;c[12]=h*k*r-g*p*r-h*j*s+f*p*s+g*j*q-f*k*q;c[1]=p*s*l-k*q*l-p*m*t+i*q*t+k*m*d-i*s*d;c[5]=g*q*l-h*s*l+h*m*t-e*q*t-g*m*d+e*s*d;c[9]=h*k*l-g*p*l-h*i*t+e*p*t+g*i*d-
	e*k*d;c[13]=g*p*m-h*k*m+h*i*s-e*p*s-g*i*q+e*k*q;c[2]=j*q*l-p*r*l+p*m*n-i*q*n-j*m*d+i*r*d;c[6]=h*r*l-f*q*l-h*m*n+e*q*n+f*m*d-e*r*d;c[10]=f*p*l-h*j*l+h*i*n-e*p*n-f*i*d+e*j*d;c[14]=h*j*m-f*p*m-h*i*r+e*p*r+f*i*q-e*j*q;c[3]=k*r*l-j*s*l-k*m*n+i*s*n+j*m*t-i*r*t;c[7]=f*s*l-g*r*l+g*m*n-e*s*n-f*m*t+e*r*t;c[11]=g*j*l-f*k*l-g*i*n+e*k*n+f*i*t-e*j*t;c[15]=f*k*m-g*j*m+g*i*r-e*k*r-f*i*s+e*j*s;c=e*c[0]+i*c[4]+m*c[8]+l*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");
	this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},
	scale:function(a){var b=this.elements,c=a.x,d=a.y,a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(1,
		0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a),a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,
		0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,d,e){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),i=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.elements.set(this.elements);var c=1/g,f=1/h,j=1/i;b.elements[0]*=c;b.elements[1]*=
		c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=j;b.elements[9]*=j;b.elements[10]*=j;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=i;return this}}(),makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){var a=c*Math.tan(THREE.Math.degToRad(0.5*
		a)),e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/i;g[9]=0;g[13]=-((c+d)/i);g[2]=0;g[6]=0;g[10]=-2/j;g[14]=-((f+e)/j);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){var a=
		this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
	var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(a,b,c,d){var e=a.clone().add(b).multiplyScalar(0.5),f=b.clone().sub(a).normalize(),g=0.5*a.distanceTo(b),
	h=this.origin.clone().sub(e),a=-this.direction.dot(f),b=h.dot(this.direction),i=-h.dot(f),j=h.lengthSq(),k=Math.abs(1-a*a),p,m;0<=k?(h=a*i-b,p=a*b-i,m=g*k,0<=h?p>=-m?p<=m?(g=1/k,h*=g,p*=g,a=h*(h+a*p+2*b)+p*(a*h+p+2*i)+j):(p=g,h=Math.max(0,-(a*p+b)),a=-h*h+p*(p+2*i)+j):(p=-g,h=Math.max(0,-(a*p+b)),a=-h*h+p*(p+2*i)+j):p<=-m?(h=Math.max(0,-(-a*g+b)),p=0<h?-g:Math.min(Math.max(-g,-i),g),a=-h*h+p*(p+2*i)+j):p<=m?(h=0,p=Math.min(Math.max(-g,-i),g),a=p*(p+2*i)+j):(h=Math.max(0,-(a*g+b)),p=0<h?g:Math.min(Math.max(-g,
	-i),g),a=-h*h+p*(p+2*i)+j)):(p=0<a?-g:g,h=Math.max(0,-(a*p+b)),a=-h*h+p*(p+2*i)+j);c&&c.copy(this.direction.clone().multiplyScalar(h).add(this.origin));d&&d.copy(f.clone().multiplyScalar(p).add(e));return a},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?
	0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,d,e,f,g;d=1/this.direction.x;f=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x);0<=f?(e=(a.min.y-h.y)*f,f*=
	a.max.y-h.y):(e=(a.max.y-h.y)*f,f*=a.min.y-h.y);if(c>f||e>d)return null;if(e>c||c!==c)c=e;if(f<d||d!==d)d=f;0<=g?(e=(a.min.z-h.z)*g,g*=a.max.z-h.z):(e=(a.max.z-h.z)*g,g*=a.min.z-h.z);if(c>g||e>d)return null;if(e>c||c!==c)c=e;if(g<d||d!==d)d=g;return 0>d?null:this.at(0<=c?c:d,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h,i){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<
	f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;g=h*this.direction.dot(b.cross(a));if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,i)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},
	clone:function(){return(new THREE.Ray).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,d=a.length;c<d;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);
	this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);
	this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),
	(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
	return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},addPoint:function(a){a.x<this.min.x?this.min.x=a.x:a.x>this.max.x&&(this.max.x=a.x);a.y<this.min.y?this.min.y=a.y:a.y>this.max.y&&(this.max.y=a.y);a.z<this.min.z?this.min.z=a.z:a.z>this.max.z&&(this.max.z=a.z)},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var b=1,c=a.length;b<c;b++)this.addPoint(a[b])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=
	new THREE.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){if(void 0!==b.geometry&&void 0!==b.geometry.vertices)for(var e=b.geometry.vertices,f=0,g=e.length;f<g;f++)a.copy(e[f]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);
	this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
	this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
	this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
	new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
	this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);
	this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));this.radius=Math.sqrt(e);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
	this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
	return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
	c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
																																																																																																																																		   b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start),a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else return f=-(b.start.dot(this.normal)+this.constant)/f,0>f||1<f?void 0:d.copy(e).multiplyScalar(f).add(b.start)}}(),
	coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,e){var f=e||c.getNormalMatrix(d),f=a.copy(this.normal).applyMatrix3(f),g=this.coplanarPoint(b);g.applyMatrix4(d);this.setFromNormalAndCoplanarPoint(f,g);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
		a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements,a=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],i=c[6],j=c[7],k=c[8],p=c[9],m=c[10],r=c[11],s=c[12],q=c[13],l=c[14],c=c[15];b[0].setComponents(f-a,j-g,r-k,c-s).normalize();b[1].setComponents(f+
	a,j+g,r+k,c+s).normalize();b[2].setComponents(f+d,j+h,r+p,c+q).normalize();b[3].setComponents(f-d,j-h,r-p,c-q).normalize();b[4].setComponents(f-e,j-i,r-m,c-l).normalize();b[5].setComponents(f+e,j+i,r+m,c+l).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){for(var b=this.planes,
																																																																																																																													  c=a.center,a=-a.radius,d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,e=0;6>e;e++){var f=d[e];a.x=0<f.normal.x?c.min.x:c.max.x;b.x=0<f.normal.x?c.max.x:c.min.x;a.y=0<f.normal.y?c.min.y:c.max.y;b.y=0<f.normal.y?c.max.y:c.min.y;a.z=0<f.normal.z?c.min.z:c.max.z;b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),containsPoint:function(a){for(var b=
	this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Math={PI2:2*Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var e=0;36>e;e++)8==e||13==e||18==e||23==e?b[e]="-":14==e?b[e]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[e]=a[19==e?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,
																																																																																																																																																															 b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/
	180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}()};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);var d=a.dot(a),e=a.dot(b),f=a.dot(c),i=b.dot(b),g=b.dot(c),j=d*i-e*e,h=h||new THREE.Vector3;if(0==j)return h.set(-2,-1,-1);j=1/j;i=(i*f-e*g)*j;d=(d*g-e*f)*j;return h.set(1-i-d,d,i)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
	new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
	clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(){var a=[];return function(b){if(void 0!==this._listeners){var c=this._listeners[b.type];if(void 0!==c){b.target=this;for(var d=c.length,e=0;e<d;e++)a[e]=c[e];for(e=0;e<d;e++)a[e].call(this,
	b)}}}}()};(function(a){a.Raycaster=function(b,c,d,e){this.ray=new a.Ray(b,c);this.near=d||0;this.far=e||Infinity};var b=new a.Sphere,c=new a.Ray;new a.Plane;new a.Vector3;var d=new a.Vector3,e=new a.Matrix4,f=function(a,b){return a.distance-b.distance},g=new a.Vector3,h=new a.Vector3,i=new a.Vector3,j=function(f,k,r){if(f instanceof a.Sprite){d.setFromMatrixPosition(f.matrixWorld);var s=k.ray.distanceToPoint(d);if(s>f.scale.x)return r;r.push({distance:s,point:f.position,face:null,object:f})}else if(f instanceof
	a.LOD)d.setFromMatrixPosition(f.matrixWorld),s=k.ray.origin.distanceTo(d),j(f.getObjectForDistance(s),k,r);else if(f instanceof a.Mesh){var q=f.geometry;null===q.boundingSphere&&q.computeBoundingSphere();b.copy(q.boundingSphere);b.applyMatrix4(f.matrixWorld);if(!1===k.ray.isIntersectionSphere(b))return r;e.getInverse(f.matrixWorld);c.copy(k.ray).applyMatrix4(e);if(null!==q.boundingBox&&!1===c.isIntersectionBox(q.boundingBox))return r;if(q instanceof a.BufferGeometry){var l=f.material;if(void 0===
	l||!1===q.dynamic)return r;var n,t,w=k.precision;if(void 0!==q.attributes.index)for(var B=q.offsets,I=q.attributes.index.array,F=q.attributes.position.array,z=q.offsets.length,A=q.attributes.index.array.length/3,A=0;A<z;++A)for(var s=B[A].start,y=B[A].index,q=s,D=s+B[A].count;q<D;q+=3)s=y+I[q],n=y+I[q+1],t=y+I[q+2],g.set(F[3*s],F[3*s+1],F[3*s+2]),h.set(F[3*n],F[3*n+1],F[3*n+2]),i.set(F[3*t],F[3*t+1],F[3*t+2]),n=l.side===a.BackSide?c.intersectTriangle(i,h,g,!0):c.intersectTriangle(g,h,i,l.side!==a.DoubleSide),
	null!==n&&(n.applyMatrix4(f.matrixWorld),s=k.ray.origin.distanceTo(n),s<w||(s<k.near||s>k.far)||r.push({distance:s,point:n,face:null,faceIndex:null,object:f}));else{F=q.attributes.position.array;A=q.attributes.position.array.length;for(q=0;q<A;q+=3)s=q,n=q+1,t=q+2,g.set(F[3*s],F[3*s+1],F[3*s+2]),h.set(F[3*n],F[3*n+1],F[3*n+2]),i.set(F[3*t],F[3*t+1],F[3*t+2]),n=l.side===a.BackSide?c.intersectTriangle(i,h,g,!0):c.intersectTriangle(g,h,i,l.side!==a.DoubleSide),null!==n&&(n.applyMatrix4(f.matrixWorld),
	s=k.ray.origin.distanceTo(n),s<w||(s<k.near||s>k.far)||r.push({distance:s,point:n,face:null,faceIndex:null,object:f}))}}else if(q instanceof a.Geometry){I=f.material instanceof a.MeshFaceMaterial;F=!0===I?f.material.materials:null;w=k.precision;B=q.vertices;z=0;for(A=q.faces.length;z<A;z++)if(y=q.faces[z],l=!0===I?F[y.materialIndex]:f.material,void 0!==l){s=B[y.a];n=B[y.b];t=B[y.c];if(!0===l.morphTargets){var D=q.morphTargets,E=f.morphTargetInfluences;g.set(0,0,0);h.set(0,0,0);i.set(0,0,0);for(var u=
	0,v=D.length;u<v;u++){var x=E[u];if(0!==x){var G=D[u].vertices;g.x+=(G[y.a].x-s.x)*x;g.y+=(G[y.a].y-s.y)*x;g.z+=(G[y.a].z-s.z)*x;h.x+=(G[y.b].x-n.x)*x;h.y+=(G[y.b].y-n.y)*x;h.z+=(G[y.b].z-n.z)*x;i.x+=(G[y.c].x-t.x)*x;i.y+=(G[y.c].y-t.y)*x;i.z+=(G[y.c].z-t.z)*x}}g.add(s);h.add(n);i.add(t);s=g;n=h;t=i}n=l.side===a.BackSide?c.intersectTriangle(t,n,s,!0):c.intersectTriangle(s,n,t,l.side!==a.DoubleSide);null!==n&&(n.applyMatrix4(f.matrixWorld),s=k.ray.origin.distanceTo(n),s<w||(s<k.near||s>k.far)||r.push({distance:s,
	point:n,face:y,faceIndex:z,object:f}))}}}else if(f instanceof a.Line){w=k.linePrecision;l=w*w;q=f.geometry;null===q.boundingSphere&&q.computeBoundingSphere();b.copy(q.boundingSphere);b.applyMatrix4(f.matrixWorld);if(!1===k.ray.isIntersectionSphere(b))return r;e.getInverse(f.matrixWorld);c.copy(k.ray).applyMatrix4(e);if(q instanceof a.Geometry){B=q.vertices;w=B.length;n=new a.Vector3;t=new a.Vector3;A=f.type===a.LineStrip?1:2;for(q=0;q<w-1;q+=A)c.distanceSqToSegment(B[q],B[q+1],t,n)>l||(s=c.origin.distanceTo(t),
	s<k.near||s>k.far||r.push({distance:s,point:n.clone().applyMatrix4(f.matrixWorld),face:null,faceIndex:null,object:f}))}}},k=function(a,b,c){for(var a=a.getDescendants(),d=0,e=a.length;d<e;d++)j(a[d],b,c)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.linePrecision=1;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b)};a.Raycaster.prototype.intersectObject=function(a,b){var c=[];!0===b&&k(a,this,c);j(a,this,c);c.sort(f);return c};a.Raycaster.prototype.intersectObjects=function(a,
																																																																																																																														b){for(var c=[],d=0,e=a.length;d<e;d++)j(a[d],this,c),!0===b&&k(a[d],this,c);c.sort(f);return c}})(THREE);THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this._rotation=new THREE.Euler;this._quaternion=new THREE.Quaternion;this.scale=new THREE.Vector3(1,1,1);this._rotation._quaternion=this.quaternion;this._quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;
	this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};
THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(a){this._rotation=a;this._rotation._quaternion=this._quaternion;this._quaternion._euler=this._rotation;this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(a){this._quaternion=a;this._quaternion._euler=this._rotation;this._rotation._quaternion=this._quaternion;this._quaternion._updateEuler()},get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");
	return this.rotation.order},set eulerOrder(a){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);
	this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=
	new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b);a.applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
	return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
	lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;a.dispatchEvent({type:"added"});this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}},remove:function(a){var b=
		this.children.indexOf(a);if(-1!==b){a.parent=void 0;a.dispatchEvent({type:"removed"});this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},getObjectById:function(a,b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.id===a||!0===b&&(e=e.getObjectById(a,b),void 0!==e))return e}},getObjectByName:function(a,
																																																																																																																															   b){for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c];if(e.name===a||!0===b&&(e=e.getObjectByName(a,b),void 0!==e))return e}},getChildByName:function(a,b){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getDescendants:function(a){void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<c;b++)this.children[b].getDescendants(a);return a},updateMatrix:function(){this.matrix.compose(this.position,
		this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},clone:function(a,b){void 0===a&&(a=new THREE.Object3D);void 0===b&&(b=!0);
		a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.quaternion.copy(this.quaternion);a.scale.copy(this.scale);a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;a.userData=JSON.parse(JSON.stringify(this.userData));
		if(!0===b)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){function a(){if(i===k){var a=new THREE.RenderableVertex;j.push(a);k++;i++;return a}return j[i++]}function b(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function c(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;if(0<=e&&0<=f&&0<=g&&0<=h)return!0;if(0>e&&0>f||0>g&&0>h)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var d,e,f=[],g=
	0,h,i,j=[],k=0,p,m,r=[],s=0,q,l,n=[],t=0,w,B,I=[],F=0,z={objects:[],sprites:[],lights:[],elements:[]},A=new THREE.Vector3,y=new THREE.Vector3,D=new THREE.Vector3,E=new THREE.Vector3,u=new THREE.Vector4,v=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),x=new THREE.Box3,G=Array(3),C=new THREE.Matrix4,L=new THREE.Matrix4,O,Z=new THREE.Matrix4,V=new THREE.Matrix3,fa=new THREE.Matrix3,la=new THREE.Vector3,aa=new THREE.Frustum,X=new THREE.Vector4,ia=new THREE.Vector4;this.projectVector=
	function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);L.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);return a.applyProjection(L)};var N=new THREE.Matrix4;this.unprojectVector=function(a,b){N.getInverse(b.projectionMatrix);L.multiplyMatrices(b.matrixWorld,N);return a.applyProjection(L)};this.pickingRay=function(a,b){a.z=-1;var c=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(c,b);c.sub(a).normalize();return new THREE.Raycaster(a,c)};var K=function(a){if(e===
	g){var b=new THREE.RenderableObject;f.push(b);g++;e++;d=b}else d=f[e++];d.id=a.id;d.object=a;null!==a.renderDepth?d.z=a.renderDepth:(E.setFromMatrixPosition(a.matrixWorld),E.applyProjection(L),d.z=E.z);return d},Y=function(a){var b=a.positionWorld,c=a.positionScreen;b.copy(a.position).applyMatrix4(O);c.copy(b).applyMatrix4(L);b=1/c.w;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z},ja=function(a){if(!1!==a.visible){a instanceof THREE.Light?z.lights.push(a):a instanceof
	THREE.Mesh||a instanceof THREE.Line?(!1===a.frustumCulled||!0===aa.intersectsObject(a))&&z.objects.push(K(a)):a instanceof THREE.Sprite&&z.sprites.push(K(a));for(var b=0,c=a.children.length;b<c;b++)ja(a.children[b])}};this.projectScene=function(d,f,g,k){var N=!1,E,K,R,M,ka,Q,T,sa,va;B=l=m=0;z.elements.length=0;!0===d.autoUpdate&&d.updateMatrixWorld();void 0===f.parent&&f.updateMatrixWorld();C.copy(f.matrixWorldInverse.getInverse(f.matrixWorld));L.multiplyMatrices(f.projectionMatrix,C);fa.getNormalMatrix(C);
	aa.setFromMatrix(L);e=0;z.objects.length=0;z.sprites.length=0;z.lights.length=0;ja(d);!0===g&&z.objects.sort(b);for(var g=0,ma=z.objects.length;g<ma;g++)if(d=z.objects[g].object,O=d.matrixWorld,i=0,d instanceof THREE.Mesh){E=d.geometry;K=E.vertices;R=E.faces;ka=E.faceVertexUvs;V.getNormalMatrix(O);sa=d.material instanceof THREE.MeshFaceMaterial;va=!0===sa?d.material:null;for(var U=0,ba=K.length;U<ba;U++)h=a(),h.position.copy(K[U]),Y(h);U=0;for(ba=R.length;U<ba;U++){K=R[U];var ca=!0===sa?va.materials[K.materialIndex]:
		d.material;if(void 0!==ca){var ga=ca.side;M=j[K.a];Q=j[K.b];T=j[K.c];if(!0===ca.morphTargets){var N=E.morphTargets,da=d.morphTargetInfluences,wa=M.position,xa=Q.position,ya=T.position;A.set(0,0,0);y.set(0,0,0);D.set(0,0,0);for(var ta=0,ua=N.length;ta<ua;ta++){var P=da[ta];if(0!==P){var S=N[ta].vertices;A.x+=(S[K.a].x-wa.x)*P;A.y+=(S[K.a].y-wa.y)*P;A.z+=(S[K.a].z-wa.z)*P;y.x+=(S[K.b].x-xa.x)*P;y.y+=(S[K.b].y-xa.y)*P;y.z+=(S[K.b].z-xa.z)*P;D.x+=(S[K.c].x-ya.x)*P;D.y+=(S[K.c].y-ya.y)*P;D.z+=(S[K.c].z-
		ya.z)*P}}M.position.add(A);Q.position.add(y);T.position.add(D);Y(M);Y(Q);Y(T)}G[0]=M.positionScreen;G[1]=Q.positionScreen;G[2]=T.positionScreen;if(!0===M.visible||!0===Q.visible||!0===T.visible||v.isIntersectionBox(x.setFromPoints(G)))if(N=0>(T.positionScreen.x-M.positionScreen.x)*(Q.positionScreen.y-M.positionScreen.y)-(T.positionScreen.y-M.positionScreen.y)*(Q.positionScreen.x-M.positionScreen.x),ga===THREE.DoubleSide||N===(ga===THREE.FrontSide)){m===s?(da=new THREE.RenderableFace3,r.push(da),s++,
		m++,p=da):p=r[m++];p.id=d.id;p.v1.copy(M);p.v2.copy(Q);p.v3.copy(T);p.normalModel.copy(K.normal);!1===N&&(ga===THREE.BackSide||ga===THREE.DoubleSide)&&p.normalModel.negate();p.normalModel.applyMatrix3(V).normalize();p.normalModelView.copy(p.normalModel).applyMatrix3(fa);p.centroidModel.copy(K.centroid).applyMatrix4(O);M=K.vertexNormals;Q=0;for(T=Math.min(M.length,3);Q<T;Q++)da=p.vertexNormalsModel[Q],da.copy(M[Q]),!1===N&&(ga===THREE.BackSide||ga===THREE.DoubleSide)&&da.negate(),da.applyMatrix3(V).normalize(),
		p.vertexNormalsModelView[Q].copy(da).applyMatrix3(fa);p.vertexNormalsLength=M.length;Q=0;for(ga=Math.min(ka.length,3);Q<ga;Q++)if(M=ka[Q][U],void 0!==M){T=0;for(N=M.length;T<N;T++)p.uvs[Q][T]=M[T]}p.color=K.color;p.material=ca;la.copy(p.centroidModel).applyProjection(L);p.z=la.z;z.elements.push(p)}}}}else if(d instanceof THREE.Line){Z.multiplyMatrices(L,O);K=d.geometry.vertices;M=a();M.positionScreen.copy(K[0]).applyMatrix4(Z);E=d.type===THREE.LinePieces?2:1;U=1;for(ba=K.length;U<ba;U++)M=a(),M.positionScreen.copy(K[U]).applyMatrix4(Z),
		0<(U+1)%E||(Q=j[i-2],X.copy(M.positionScreen),ia.copy(Q.positionScreen),!0===c(X,ia)&&(X.multiplyScalar(1/X.w),ia.multiplyScalar(1/ia.w),l===t?(R=new THREE.RenderableLine,n.push(R),t++,l++,q=R):q=n[l++],q.id=d.id,q.v1.positionScreen.copy(X),q.v2.positionScreen.copy(ia),q.z=Math.max(X.z,ia.z),q.material=d.material,d.material.vertexColors===THREE.VertexColors&&(q.vertexColors[0].copy(d.geometry.colors[U]),q.vertexColors[1].copy(d.geometry.colors[U-1])),z.elements.push(q)))}g=0;for(ma=z.sprites.length;g<
		ma;g++)d=z.sprites[g].object,O=d.matrixWorld,u.set(O.elements[12],O.elements[13],O.elements[14],1),u.applyMatrix4(L),E=1/u.w,u.z*=E,-1<=u.z&&1>=u.z&&(B===F?(R=new THREE.RenderableSprite,I.push(R),F++,B++,w=R):w=I[B++],w.id=d.id,w.x=u.x*E,w.y=u.y*E,w.z=u.z,w.object=d,w.rotation=d.rotation,w.scale.x=d.scale.x*Math.abs(w.x-(u.x+f.projectionMatrix.elements[0])/(u.w+f.projectionMatrix.elements[12])),w.scale.y=d.scale.y*Math.abs(w.y-(u.y+f.projectionMatrix.elements[5])/(u.w+f.projectionMatrix.elements[13])),
		w.material=d.material,z.elements.push(w));!0===k&&z.elements.sort(b);return z}};THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
	return a}};THREE.Face4=function(a,b,c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,e,f,g)};THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
	this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){var e=this.faces[c];e.normal.applyMatrix3(b).normalize();for(var f=0,g=e.vertexNormals.length;f<g;f++)e.vertexNormals[f].applyMatrix3(b).normalize();e.centroid.applyMatrix4(a)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof
	THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,0,0),c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,
	g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d;d=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)d[b]=new THREE.Vector3;if(a){var e,f,g,h=new THREE.Vector3,i=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],e=this.vertices[c.a],f=this.vertices[c.b],g=this.vertices[c.c],h.subVectors(g,f),i.subVectors(e,f),h.cross(i),d[c.a].add(h),d[c.b].add(h),d[c.c].add(h)}else{a=
	0;for(b=this.faces.length;a<b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal)}b=0;for(c=this.vertices.length;b<c;b++)d[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.vertexNormals[0]=d[c.a].clone(),c.vertexNormals[1]=d[c.b].clone(),c.vertexNormals[2]=d[c.c].clone()},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++){e=this.faces[c];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=
	e.normal.clone();e.__originalVertexNormals||(e.__originalVertexNormals=[]);a=0;for(b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=e.vertexNormals[a].clone()}var f=new THREE.Geometry;f.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];e=this.morphNormals[a].faceNormals;
	var g=this.morphNormals[a].vertexNormals,h,i;c=0;for(d=this.faces.length;c<d;c++)h=new THREE.Vector3,i={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},e.push(h),g.push(i)}g=this.morphNormals[a];f.vertices=this.morphTargets[a].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],h=g.faceNormals[c],i=g.vertexNormals[c],h.copy(e.normal),i.a.copy(e.vertexNormals[0]),i.b.copy(e.vertexNormals[1]),i.c.copy(e.vertexNormals[2])}c=0;for(d=
																																																																																																																															 this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){var a,b,c,d,e,f,g,h,i,j,k,p,m,r,s,q,l,n=[],t=[];c=new THREE.Vector3;var w=new THREE.Vector3,B=new THREE.Vector3,I=new THREE.Vector3,F=new THREE.Vector3;a=0;for(b=this.vertices.length;a<b;a++)n[a]=new THREE.Vector3,t[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)e=this.faces[a],f=this.faceVertexUvs[0][a],d=e.a,l=e.b,e=e.c,g=this.vertices[d],h=this.vertices[l],
	i=this.vertices[e],j=f[0],k=f[1],p=f[2],f=h.x-g.x,m=i.x-g.x,r=h.y-g.y,s=i.y-g.y,h=h.z-g.z,g=i.z-g.z,i=k.x-j.x,q=p.x-j.x,k=k.y-j.y,j=p.y-j.y,p=1/(i*j-q*k),c.set((j*f-k*m)*p,(j*r-k*s)*p,(j*h-k*g)*p),w.set((i*m-q*f)*p,(i*s-q*r)*p,(i*g-q*h)*p),n[d].add(c),n[l].add(c),n[e].add(c),t[d].add(w),t[l].add(w),t[e].add(w);w=["a","b","c","d"];a=0;for(b=this.faces.length;a<b;a++){e=this.faces[a];for(c=0;c<Math.min(e.vertexNormals.length,3);c++)F.copy(e.vertexNormals[c]),d=e[w[c]],l=n[d],B.copy(l),B.sub(F.multiplyScalar(F.dot(l))).normalize(),
	I.crossVectors(e.vertexNormals[c],l),d=I.dot(t[d]),d=0>d?-1:1,e.vertexTangents[c]=new THREE.Vector4(B.x,B.y,B.z,d)}this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);
	this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),f,g;f=0;for(g=this.vertices.length;f<g;f++)d=this.vertices[f],d=Math.round(d.x*e)+"_"+Math.round(d.y*e)+"_"+Math.round(d.z*e),void 0===a[d]?(a[d]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[d]];a=[];f=0;for(g=this.faces.length;f<g;f++){e=this.faces[f];e.a=c[e.a];e.b=c[e.b];e.c=c[e.c];e=[e.a,e.b,e.c];for(d=0;3>d;d++)if(e[d]==e[(d+1)%3]){a.push(f);break}}for(f=a.length-1;0<=f;f--){e=
	a[f];this.faces.splice(e,1);c=0;for(g=this.faceVertexUvs.length;c<g;c++)this.faceVertexUvs[c].splice(e,1)}f=this.vertices.length-b.length;this.vertices=b;return f},clone:function(){for(var a=new THREE.Geometry,b=this.vertices,c=0,d=b.length;c<d;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(d=b.length;c<d;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(d=b.length;c<d;c++){for(var e=b[c],f=[],g=0,h=e.length;g<h;g++)f.push(new THREE.Vector2(e[g].x,e[g].y));a.faceVertexUvs[0].push(f)}return a},
	dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.attributes={};this.dynamic=!0;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b,c,d){this.attributes[a]={itemSize:d,array:new b(c*d)}},applyMatrix:function(a){var b,c;this.attributes.position&&(b=this.attributes.position.array);this.attributes.normal&&(c=this.attributes.normal.array);void 0!==b&&(a.multiplyVector3Array(b),this.verticesNeedUpdate=!0);void 0!==c&&((new THREE.Matrix3).getNormalMatrix(a).multiplyVector3Array(c),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===
	this.boundingBox&&(this.boundingBox=new THREE.Box3);var a=this.attributes.position.array;if(a){var b=this.boundingBox,c,d,e;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var f=3,g=a.length;f<g;f+=3)c=a[f],d=a[f+1],e=a[f+2],c<b.min.x?b.min.x=c:c>b.max.x&&(b.max.x=c),d<b.min.y?b.min.y=d:d>b.max.y&&(b.max.y=d),e<b.min.z?b.min.z=e:e>b.max.z&&(b.max.z=e)}if(void 0===a||0===a.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){var a=
	new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var d=this.boundingSphere.center,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),a.addPoint(b);a.center(d);for(var g=0,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),g=Math.max(g,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(g)}}}(),computeVertexNormals:function(){if(this.attributes.position){var a,
	b,c,d;a=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(a)};else{a=0;for(b=this.attributes.normal.array.length;a<b;a++)this.attributes.normal.array[a]=0}var e=this.attributes.position.array,f=this.attributes.normal.array,g,h,i,j,k,p,m=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,q=new THREE.Vector3,l=new THREE.Vector3;if(this.attributes.index){var n=this.attributes.index.array,t=this.offsets;c=0;for(d=
																																																																																																																														   t.length;c<d;++c){b=t[c].start;g=t[c].count;var w=t[c].index;a=b;for(b+=g;a<b;a+=3)g=w+n[a],h=w+n[a+1],i=w+n[a+2],j=e[3*g],k=e[3*g+1],p=e[3*g+2],m.set(j,k,p),j=e[3*h],k=e[3*h+1],p=e[3*h+2],r.set(j,k,p),j=e[3*i],k=e[3*i+1],p=e[3*i+2],s.set(j,k,p),q.subVectors(s,r),l.subVectors(m,r),q.cross(l),f[3*g]+=q.x,f[3*g+1]+=q.y,f[3*g+2]+=q.z,f[3*h]+=q.x,f[3*h+1]+=q.y,f[3*h+2]+=q.z,f[3*i]+=q.x,f[3*i+1]+=q.y,f[3*i+2]+=q.z}}else{a=0;for(b=e.length;a<b;a+=9)j=e[a],k=e[a+1],p=e[a+2],m.set(j,k,p),j=e[a+3],k=e[a+4],
	p=e[a+5],r.set(j,k,p),j=e[a+6],k=e[a+7],p=e[a+8],s.set(j,k,p),q.subVectors(s,r),l.subVectors(m,r),q.cross(l),f[a]=q.x,f[a+1]=q.y,f[a+2]=q.z,f[a+3]=q.x,f[a+4]=q.y,f[a+5]=q.z,f[a+6]=q.x,f[a+7]=q.y,f[a+8]=q.z}this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,e=0,f=a.length;e<f;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},computeTangents:function(){function a(a){V.x=d[3*a];V.y=d[3*a+1];
	V.z=d[3*a+2];fa.copy(V);aa=h[a];O.copy(aa);O.sub(V.multiplyScalar(V.dot(aa))).normalize();Z.crossVectors(fa,aa);X=Z.dot(i[a]);la=0>X?-1:1;g[4*a]=O.x;g[4*a+1]=O.y;g[4*a+2]=O.z;g[4*a+3]=la}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var b=this.attributes.index.array,c=this.attributes.position.array,
	d=this.attributes.normal.array,e=this.attributes.uv.array,f=c.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={itemSize:4,array:new Float32Array(4*f)});for(var g=this.attributes.tangent.array,h=[],i=[],j=0;j<f;j++)h[j]=new THREE.Vector3,i[j]=new THREE.Vector3;var k,p,m,r,s,q,l,n,t,w,B,I,F,z,A,f=new THREE.Vector3,j=new THREE.Vector3,y,D,E,u,v,x,G,C=this.offsets;E=0;for(u=C.length;E<u;++E){D=C[E].start;v=C[E].count;var L=C[E].index;y=D;for(D+=v;y<D;y+=3)v=L+b[y],x=L+b[y+1],G=L+b[y+
	2],k=c[3*v],p=c[3*v+1],m=c[3*v+2],r=c[3*x],s=c[3*x+1],q=c[3*x+2],l=c[3*G],n=c[3*G+1],t=c[3*G+2],w=e[2*v],B=e[2*v+1],I=e[2*x],F=e[2*x+1],z=e[2*G],A=e[2*G+1],r-=k,k=l-k,s-=p,p=n-p,q-=m,m=t-m,I-=w,w=z-w,F-=B,B=A-B,A=1/(I*B-w*F),f.set((B*r-F*k)*A,(B*s-F*p)*A,(B*q-F*m)*A),j.set((I*k-w*r)*A,(I*p-w*s)*A,(I*m-w*q)*A),h[v].add(f),h[x].add(f),h[G].add(f),i[v].add(j),i[x].add(j),i[G].add(j)}var O=new THREE.Vector3,Z=new THREE.Vector3,V=new THREE.Vector3,fa=new THREE.Vector3,la,aa,X;E=0;for(u=C.length;E<u;++E){D=
	C[E].start;v=C[E].count;L=C[E].index;y=D;for(D+=v;y<D;y+=3)v=L+b[y],x=L+b[y+1],G=L+b[y+2],a(v),a(x),a(G)}this.tangentsNeedUpdate=this.hasTangents=!0}},clone:function(){var a=new THREE.BufferGeometry,b=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c;for(c in this.attributes){for(var d=this.attributes[c],e=d.array,f={itemSize:d.itemSize,numItems:d.numItems,array:null},d=0,g=b.length;d<g;d++){var h=b[d];if(e instanceof h){f.array=new h(e);
	break}}a.attributes[c]=f}d=0;for(g=this.offsets.length;d<g;d++)b=this.offsets[d],a.offsets.push({start:b.start,index:b.index,count:b.count});return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();
THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:0.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;return a};THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,d=a*c,a=Math.abs(a*b-d),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(d+this.x*a/this.fullWidth,d+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;return a};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/a.total).toFixed(0)+
	"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");a.pop();return(1>a.length?".":a.join("/"))+"/"},initMaterials:function(a,b){for(var c=[],d=0;d<a.length;++d)c[d]=THREE.Loader.prototype.createMaterial(a[d],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==a}function d(a){a=
	Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function e(a,e,f,h,i,j,l){var n=/\.dds$/i.test(f),t=b+"/"+f;if(n){var w=THREE.ImageUtils.loadCompressedTexture(t);a[e]=w}else w=document.createElement("canvas"),a[e]=new THREE.Texture(w);a[e].sourceFile=f;h&&(a[e].repeat.set(h[0],h[1]),1!==h[0]&&(a[e].wrapS=THREE.RepeatWrapping),1!==h[1]&&(a[e].wrapT=THREE.RepeatWrapping));i&&a[e].offset.set(i[0],i[1]);j&&(f={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==f[j[0]]&&(a[e].wrapS=
	f[j[0]]),void 0!==f[j[1]]&&(a[e].wrapT=f[j[1]]));l&&(a[e].anisotropy=l);if(!n){var B=a[e],a=new Image;a.onload=function(){if(!c(this.width)||!c(this.height)){var a=d(this.width),b=d(this.height);B.image.width=a;B.image.height=b;B.image.getContext("2d").drawImage(this,0,0,a,b)}else B.image=this;B.needsUpdate=!0};void 0!==g.crossOrigin&&(a.crossOrigin=g.crossOrigin);a.src=t}}function f(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var g=this,h="MeshLambertMaterial",i={color:15658734,opacity:1,map:null,
	lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var j=a.shading.toLowerCase();"phong"===j?h="MeshPhongMaterial":"basic"===j&&(h="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(i.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)i.transparent=a.transparent;void 0!==a.depthTest&&(i.depthTest=a.depthTest);void 0!==a.depthWrite&&(i.depthWrite=a.depthWrite);void 0!==a.visible&&(i.visible=a.visible);void 0!==a.flipSided&&(i.side=THREE.BackSide);
	void 0!==a.doubleSided&&(i.side=THREE.DoubleSide);void 0!==a.wireframe&&(i.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?i.vertexColors=THREE.FaceColors:a.vertexColors&&(i.vertexColors=THREE.VertexColors));a.colorDiffuse?i.color=f(a.colorDiffuse):a.DbgColor&&(i.color=a.DbgColor);a.colorSpecular&&(i.specular=f(a.colorSpecular));a.colorAmbient&&(i.ambient=f(a.colorAmbient));a.transparency&&(i.opacity=a.transparency);a.specularCoef&&(i.shininess=a.specularCoef);a.mapDiffuse&&
		b&&e(i,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&e(i,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&e(i,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&e(i,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&e(i,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
		a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(i.bumpScale=a.mapBumpScale);a.mapNormal?(h=THREE.ShaderLib.normalmap,j=THREE.UniformsUtils.clone(h.uniforms),j.tNormal.value=i.normalMap,a.mapNormalFactor&&j.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),i.map&&(j.tDiffuse.value=i.map,j.enableDiffuse.value=!0),i.specularMap&&(j.tSpecular.value=i.specularMap,j.enableSpecular.value=!0),i.lightMap&&(j.tAO.value=i.lightMap,j.enableAO.value=!0),j.diffuse.value.setHex(i.color),
		j.specular.value.setHex(i.specular),j.ambient.value.setHex(i.ambient),j.shininess.value=i.shininess,void 0!==i.opacity&&(j.opacity.value=i.opacity),h=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:j,lights:!0,fog:!0}),i.transparent&&(h.transparent=!0)):h=new THREE[h](i);void 0!==a.DbgName&&(h.name=a.DbgName);return h}};THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){var e=this,f=new XMLHttpRequest;void 0!==b&&f.addEventListener("load",function(c){b(c.target.responseText);e.manager.itemEnd(a)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==d&&f.addEventListener("error",function(a){d(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.open("GET",a,!0);f.send(null);e.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){var e=this,f=document.createElement("img");void 0!==b&&f.addEventListener("load",function(){e.manager.itemEnd(a);b(this)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);void 0!==d&&f.addEventListener("error",function(a){d(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);f.src=a;e.manager.itemStart(a);return f},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(a,b,c){c=c&&"string"===typeof c?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,b,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(a,b,c,d,e){var f=new XMLHttpRequest,g=0;f.onreadystatechange=function(){if(f.readyState===f.DONE)if(200===f.status||0===f.status){if(f.responseText){var h=JSON.parse(f.responseText),h=a.parse(h,d);c(h.geometry,h.materials)}else console.warn("THREE.JSONLoader: ["+b+"] seems to be unreachable or file there is empty");a.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+b+"] ["+f.status+"]");else f.readyState===f.LOADING?e&&(0===g&&
	(g=f.getResponseHeader("Content-Length")),e({total:g,loaded:f.responseText.length})):f.readyState===f.HEADERS_RECEIVED&&void 0!==e&&(g=f.getResponseHeader("Content-Length"))};f.open("GET",b,!0);f.withCredentials=this.withCredentials;f.send(null)};
THREE.JSONLoader.prototype.parse=function(a,b){var c=new THREE.Geometry,d=void 0!==a.scale?1/a.scale:1,e,f,g,h,i,j,k,p,m,r,s,q,l,n,t=a.faces;m=a.vertices;var w=a.normals,B=a.colors,I=0;if(void 0!==a.uvs){for(e=0;e<a.uvs.length;e++)a.uvs[e].length&&I++;for(e=0;e<I;e++)c.faceVertexUvs[e]=[]}h=0;for(i=m.length;h<i;)j=new THREE.Vector3,j.x=m[h++]*d,j.y=m[h++]*d,j.z=m[h++]*d,c.vertices.push(j);h=0;for(i=t.length;h<i;)if(m=t[h++],r=m&1,g=m&2,e=m&8,k=m&16,s=m&32,j=m&64,m&=128,r){r=new THREE.Face3;r.a=t[h];
	r.b=t[h+1];r.c=t[h+3];q=new THREE.Face3;q.a=t[h+1];q.b=t[h+2];q.c=t[h+3];h+=4;g&&(g=t[h++],r.materialIndex=g,q.materialIndex=g);g=c.faces.length;if(e)for(e=0;e<I;e++){l=a.uvs[e];c.faceVertexUvs[e][g]=[];c.faceVertexUvs[e][g+1]=[];for(f=0;4>f;f++)p=t[h++],n=l[2*p],p=l[2*p+1],n=new THREE.Vector2(n,p),2!==f&&c.faceVertexUvs[e][g].push(n),0!==f&&c.faceVertexUvs[e][g+1].push(n)}k&&(k=3*t[h++],r.normal.set(w[k++],w[k++],w[k]),q.normal.copy(r.normal));if(s)for(e=0;4>e;e++)k=3*t[h++],s=new THREE.Vector3(w[k++],
		w[k++],w[k]),2!==e&&r.vertexNormals.push(s),0!==e&&q.vertexNormals.push(s);j&&(j=t[h++],j=B[j],r.color.setHex(j),q.color.setHex(j));if(m)for(e=0;4>e;e++)j=t[h++],j=B[j],2!==e&&r.vertexColors.push(new THREE.Color(j)),0!==e&&q.vertexColors.push(new THREE.Color(j));c.faces.push(r);c.faces.push(q)}else{r=new THREE.Face3;r.a=t[h++];r.b=t[h++];r.c=t[h++];g&&(g=t[h++],r.materialIndex=g);g=c.faces.length;if(e)for(e=0;e<I;e++){l=a.uvs[e];c.faceVertexUvs[e][g]=[];for(f=0;3>f;f++)p=t[h++],n=l[2*p],p=l[2*p+1],
	n=new THREE.Vector2(n,p),c.faceVertexUvs[e][g].push(n)}k&&(k=3*t[h++],r.normal.set(w[k++],w[k++],w[k]));if(s)for(e=0;3>e;e++)k=3*t[h++],s=new THREE.Vector3(w[k++],w[k++],w[k]),r.vertexNormals.push(s);j&&(j=t[h++],r.color.setHex(B[j]));if(m)for(e=0;3>e;e++)j=t[h++],r.vertexColors.push(new THREE.Color(B[j]));c.faces.push(r)}if(a.skinWeights){h=0;for(i=a.skinWeights.length;h<i;h+=2)t=a.skinWeights[h],w=a.skinWeights[h+1],c.skinWeights.push(new THREE.Vector4(t,w,0,0))}if(a.skinIndices){h=0;for(i=a.skinIndices.length;h<
	i;h+=2)t=a.skinIndices[h],w=a.skinIndices[h+1],c.skinIndices.push(new THREE.Vector4(t,w,0,0))}c.bones=a.bones;c.animation=a.animation;c.animations=a.animations;if(void 0!==a.morphTargets){h=0;for(i=a.morphTargets.length;h<i;h++){c.morphTargets[h]={};c.morphTargets[h].name=a.morphTargets[h].name;c.morphTargets[h].vertices=[];B=c.morphTargets[h].vertices;I=a.morphTargets[h].vertices;t=0;for(w=I.length;t<w;t+=3)m=new THREE.Vector3,m.x=I[t]*d,m.y=I[t+1]*d,m.z=I[t+2]*d,B.push(m)}}if(void 0!==a.morphColors){h=
	0;for(i=a.morphColors.length;h<i;h++){c.morphColors[h]={};c.morphColors[h].name=a.morphColors[h].name;c.morphColors[h].colors=[];w=c.morphColors[h].colors;B=a.morphColors[h].colors;d=0;for(t=B.length;d<t;d+=3)I=new THREE.Color(16755200),I.setRGB(B[d],B[d+1],B[d+2]),w.push(I)}}c.computeCentroids();c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials)return{geometry:c};d=this.initMaterials(a.materials,b);this.needsTangents(d)&&c.computeTangents();return{geometry:c,materials:d}};THREE.LoadingManager=function(a,b,c){var d=this,e=0,f=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(){f++};this.itemEnd=function(a){e++;if(void 0!==d.onProgress)d.onProgress(a,e,f);if(e===f&&void 0!==d.onLoad)d.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.BufferGeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader;d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=new THREE.BufferGeometry,c=a.attributes,d=a.offsets,a=a.boundingSphere,e;for(e in c){var f=c[e];b.attributes[e]={itemSize:f.itemSize,array:new self[f.type](f.array)}}void 0!==d&&(b.offsets=JSON.parse(JSON.stringify(d)));
	void 0!==a&&(b.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==a.center?a.center:[0,0,0]),a.radius));return b}};THREE.GeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader;d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(){}};THREE.MaterialLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader;d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=new THREE[a.type];void 0!==a.color&&b.color.setHex(a.color);void 0!==a.ambient&&b.ambient.setHex(a.ambient);void 0!==a.emissive&&b.emissive.setHex(a.emissive);void 0!==a.specular&&b.specular.setHex(a.specular);void 0!==a.shininess&&
(b.shininess=a.shininess);void 0!==a.vertexColors&&(b.vertexColors=a.vertexColors);void 0!==a.blending&&(b.blending=a.blending);void 0!==a.side&&(b.side=a.side);void 0!==a.opacity&&(b.opacity=a.opacity);void 0!==a.transparent&&(b.transparent=a.transparent);void 0!==a.wireframe&&(b.wireframe=a.wireframe);if(void 0!==a.materials)for(var c=0,d=a.materials.length;c<d;c++)b.materials.push(this.parse(a.materials[c]));return b}};THREE.ObjectLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader(c.manager);d.setCrossOrigin(this.crossOrigin);d.load(a,function(a){b(c.parse(JSON.parse(a)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=this.parseGeometries(a.geometries),c=this.parseMaterials(a.materials);return this.parseObject(a.object,b,c)},parseGeometries:function(a){var b={};if(void 0!==a)for(var c=new THREE.JSONLoader,d=new THREE.BufferGeometryLoader,
																																																																																																																e=0,f=a.length;e<f;e++){var g,h=a[e];switch(h.type){case "PlaneGeometry":g=new THREE.PlaneGeometry(h.width,h.height,h.widthSegments,h.heightSegments);break;case "CircleGeometry":g=new THREE.CircleGeometry(h.radius,h.segments);break;case "CubeGeometry":g=new THREE.CubeGeometry(h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CylinderGeometry":g=new THREE.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded);break;case "SphereGeometry":g=
	new THREE.SphereGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "IcosahedronGeometry":g=new THREE.IcosahedronGeometry(h.radius,h.detail);break;case "TorusGeometry":g=new THREE.TorusGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":g=new THREE.TorusKnotGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.p,h.q,h.heightScale);break;case "BufferGeometry":g=d.parse(h.data);break;case "Geometry":g=
	c.parse(h.data).geometry}g.uuid=h.uuid;void 0!==h.name&&(g.name=h.name);b[h.uuid]=g}return b},parseMaterials:function(a){var b={};if(void 0!==a)for(var c=new THREE.MaterialLoader,d=0,e=a.length;d<e;d++){var f=a[d],g=c.parse(f);g.uuid=f.uuid;void 0!==f.name&&(g.name=f.name);b[f.uuid]=g}return b},parseObject:function(){var a=new THREE.Matrix4;return function(b,c,d){var e;switch(b.type){case "Scene":e=new THREE.Scene;break;case "PerspectiveCamera":e=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,
	b.far);break;case "OrthographicCamera":e=new THREE.OrthographicCamera(b.left,b.right,b.top,b.bottom,b.near,b.far);break;case "AmbientLight":e=new THREE.AmbientLight(b.color);break;case "DirectionalLight":e=new THREE.DirectionalLight(b.color,b.intensity);break;case "PointLight":e=new THREE.PointLight(b.color,b.intensity,b.distance);break;case "SpotLight":e=new THREE.SpotLight(b.color,b.intensity,b.distance,b.angle,b.exponent);break;case "HemisphereLight":e=new THREE.HemisphereLight(b.color,b.groundColor,
	b.intensity);break;case "Mesh":e=c[b.geometry];var f=d[b.material];void 0===e&&console.error("THREE.ObjectLoader: Undefined geometry "+b.geometry);void 0===f&&console.error("THREE.ObjectLoader: Undefined material "+b.material);e=new THREE.Mesh(e,f);break;case "Sprite":f=d[b.material];void 0===f&&console.error("THREE.ObjectLoader: Undefined material "+b.material);e=new THREE.Sprite(f);break;default:e=new THREE.Object3D}e.uuid=b.uuid;void 0!==b.name&&(e.name=b.name);void 0!==b.matrix?(a.fromArray(b.matrix),
	a.decompose(e.position,e.quaternion,e.scale)):(void 0!==b.position&&e.position.fromArray(b.position),void 0!==b.rotation&&e.rotation.fromArray(b.rotation),void 0!==b.scale&&e.scale.fromArray(b.scale));void 0!==b.visible&&(e.visible=b.visible);void 0!==b.userData&&(e.userData=b.userData);if(void 0!==b.children)for(var g in b.children)e.add(this.parseObject(b.children[g],c,d));return e}}()};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};
THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(a,b){var c=this,d=new THREE.XHRLoader(c.manager);d.setCrossOrigin(this.crossOrigin);d.load(a,function(d){c.parse(JSON.parse(d),b,a)})},setCrossOrigin:function(a){this.crossOrigin=a},addGeometryHandler:function(a,b){this.geometryHandlers[a]={loaderClass:b}},addHierarchyHandler:function(a,b){this.hierarchyHandlers[a]={loaderClass:b}},parse:function(a,b,c){function d(a,b){return"relativeToHTML"==b?a:m+"/"+a}function e(){f(z.scene,
	y.objects)}function f(a,b){var c,e,g,i,j,l;for(l in b){var k=z.objects[l],m=b[l];if(void 0===k){if(m.type&&m.type in p.hierarchyHandlers){if(void 0===m.loading){c={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var n={},u;for(u in m)u in c||(n[u]=m[u]);s=z.materials[m.material];m.loading=!0;c=p.hierarchyHandlers[m.type].loaderObject;c.options?c.load(d(m.url,y.urlBaseType),h(l,a,s,m)):c.load(d(m.url,y.urlBaseType),h(l,
	a,s,m),n)}}else if(void 0!==m.geometry){if(r=z.geometries[m.geometry]){k=!1;s=z.materials[m.material];k=s instanceof THREE.ShaderMaterial;e=m.position;g=m.rotation;i=m.scale;c=m.matrix;j=m.quaternion;m.material||(s=new THREE.MeshFaceMaterial(z.face_materials[m.geometry]));s instanceof THREE.MeshFaceMaterial&&0===s.materials.length&&(s=new THREE.MeshFaceMaterial(z.face_materials[m.geometry]));if(s instanceof THREE.MeshFaceMaterial)for(n=0;n<s.materials.length;n++)k=k||s.materials[n]instanceof THREE.ShaderMaterial;
	k&&r.computeTangents();m.skin?k=new THREE.SkinnedMesh(r,s):m.morph?(k=new THREE.MorphAnimMesh(r,s),void 0!==m.duration&&(k.duration=m.duration),void 0!==m.time&&(k.time=m.time),void 0!==m.mirroredLoop&&(k.mirroredLoop=m.mirroredLoop),s.morphNormals&&r.computeMorphNormals()):k=new THREE.Mesh(r,s);k.name=l;c?(k.matrixAutoUpdate=!1,k.matrix.set(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])):(k.position.fromArray(e),j?k.quaternion.fromArray(j):k.rotation.fromArray(g),
		k.scale.fromArray(i));k.visible=m.visible;k.castShadow=m.castShadow;k.receiveShadow=m.receiveShadow;a.add(k);z.objects[l]=k}}else if("AmbientLight"===m.type||"PointLight"===m.type||"DirectionalLight"===m.type||"SpotLight"===m.type||"HemisphereLight"===m.type||"AreaLight"===m.type){n=m.color;c=m.intensity;e=m.distance;g=m.position;i=m.rotation;switch(m.type){case "AmbientLight":t=new THREE.AmbientLight(n);break;case "PointLight":t=new THREE.PointLight(n,c,e);t.position.fromArray(g);break;case "DirectionalLight":t=
	new THREE.DirectionalLight(n,c);t.position.fromArray(m.direction);break;case "SpotLight":t=new THREE.SpotLight(n,c,e,1);t.angle=m.angle;t.position.fromArray(g);t.target.set(g[0],g[1]-e,g[2]);t.target.applyEuler(new THREE.Euler(i[0],i[1],i[2],"XYZ"));break;case "HemisphereLight":t=new THREE.DirectionalLight(n,c,e);t.target.set(g[0],g[1]-e,g[2]);t.target.applyEuler(new THREE.Euler(i[0],i[1],i[2],"XYZ"));break;case "AreaLight":t=new THREE.AreaLight(n,c),t.position.fromArray(g),t.width=m.size,t.height=
	m.size_y}a.add(t);t.name=l;z.lights[l]=t;z.objects[l]=t}else"PerspectiveCamera"===m.type||"OrthographicCamera"===m.type?(e=m.position,g=m.rotation,j=m.quaternion,"PerspectiveCamera"===m.type?q=new THREE.PerspectiveCamera(m.fov,m.aspect,m.near,m.far):"OrthographicCamera"===m.type&&(q=new THREE.OrthographicCamera(m.left,m.right,m.top,m.bottom,m.near,m.far)),q.name=l,q.position.fromArray(e),void 0!==j?q.quaternion.fromArray(j):void 0!==g&&q.rotation.fromArray(g),a.add(q),z.cameras[l]=q,z.objects[l]=
	q):(e=m.position,g=m.rotation,i=m.scale,j=m.quaternion,k=new THREE.Object3D,k.name=l,k.position.fromArray(e),j?k.quaternion.fromArray(j):k.rotation.fromArray(g),k.scale.fromArray(i),k.visible=void 0!==m.visible?m.visible:!1,a.add(k),z.objects[l]=k,z.empties[l]=k);if(k){if(void 0!==m.userData)for(var w in m.userData)k.userData[w]=m.userData[w];if(void 0!==m.groups)for(n=0;n<m.groups.length;n++)c=m.groups[n],void 0===z.groups[c]&&(z.groups[c]=[]),z.groups[c].push(l)}}void 0!==k&&void 0!==m.children&&
f(k,m.children)}}function g(a){return function(b,c){b.name=a;z.geometries[a]=b;z.face_materials[a]=c;e();w-=1;p.onLoadComplete();j()}}function h(a,b,c,d){return function(f){var f=f.content?f.content:f.dae?f.scene:f,g=d.rotation,h=d.quaternion,i=d.scale;f.position.fromArray(d.position);h?f.quaternion.fromArray(h):f.rotation.fromArray(g);f.scale.fromArray(i);c&&f.traverse(function(a){a.material=c});var m=void 0!==d.visible?d.visible:!0;f.traverse(function(a){a.visible=m});b.add(f);f.name=a;z.objects[a]=
	f;e();w-=1;p.onLoadComplete();j()}}function i(a){return function(b,c){b.name=a;z.geometries[a]=b;z.face_materials[a]=c}}function j(){p.callbackProgress({totalModels:I,totalTextures:F,loadedModels:I-w,loadedTextures:F-B},z);p.onLoadProgress();if(0===w&&0===B){for(var a=0;a<A.length;a++){var c=A[a],d=z.objects[c.targetName];d?c.object.target=d:(c.object.target=new THREE.Object3D,z.scene.add(c.object.target));c.object.target.userData.targetInverse=c.object}b(z)}}function k(a,b){b(a);if(void 0!==a.children)for(var c in a.children)k(a.children[c],
	b)}var p=this,m=THREE.Loader.prototype.extractUrlBase(c),r,s,q,l,n,t,w,B,I,F,z,A=[],y=a,D;for(D in this.geometryHandlers)a=this.geometryHandlers[D].loaderClass,this.geometryHandlers[D].loaderObject=new a;for(D in this.hierarchyHandlers)a=this.hierarchyHandlers[D].loaderClass,this.hierarchyHandlers[D].loaderObject=new a;B=w=0;z={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(y.transform&&(D=y.transform.position,
	a=y.transform.rotation,c=y.transform.scale,D&&z.scene.position.fromArray(D),a&&z.scene.rotation.fromArray(a),c&&z.scene.scale.fromArray(c),D||a||c))z.scene.updateMatrix(),z.scene.updateMatrixWorld();D=function(a){return function(){B-=a;j();p.onLoadComplete()}};for(var E in y.fogs)a=y.fogs[E],"linear"===a.type?l=new THREE.Fog(0,a.near,a.far):"exp2"===a.type&&(l=new THREE.FogExp2(0,a.density)),a=a.color,l.color.setRGB(a[0],a[1],a[2]),z.fogs[E]=l;for(var u in y.geometries)l=y.geometries[u],l.type in
	this.geometryHandlers&&(w+=1,p.onLoadStart());for(var v in y.objects)k(y.objects[v],function(a){a.type&&a.type in p.hierarchyHandlers&&(w+=1,p.onLoadStart())});I=w;for(u in y.geometries)if(l=y.geometries[u],"cube"===l.type)r=new THREE.CubeGeometry(l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments),r.name=u,z.geometries[u]=r;else if("plane"===l.type)r=new THREE.PlaneGeometry(l.width,l.height,l.widthSegments,l.heightSegments),r.name=u,z.geometries[u]=r;else if("sphere"===l.type)r=
	new THREE.SphereGeometry(l.radius,l.widthSegments,l.heightSegments),r.name=u,z.geometries[u]=r;else if("cylinder"===l.type)r=new THREE.CylinderGeometry(l.topRad,l.botRad,l.height,l.radSegs,l.heightSegs),r.name=u,z.geometries[u]=r;else if("torus"===l.type)r=new THREE.TorusGeometry(l.radius,l.tube,l.segmentsR,l.segmentsT),r.name=u,z.geometries[u]=r;else if("icosahedron"===l.type)r=new THREE.IcosahedronGeometry(l.radius,l.subdivisions),r.name=u,z.geometries[u]=r;else if(l.type in this.geometryHandlers){v=
{};for(n in l)"type"!==n&&"url"!==n&&(v[n]=l[n]);this.geometryHandlers[l.type].loaderObject.load(d(l.url,y.urlBaseType),g(u),v)}else"embedded"===l.type&&(v=y.embeds[l.id],v.metadata=y.metadata,v&&(v=this.geometryHandlers.ascii.loaderObject.parse(v,""),i(u)(v.geometry,v.materials)));for(var x in y.textures)if(u=y.textures[x],u.url instanceof Array){B+=u.url.length;for(n=0;n<u.url.length;n++)p.onLoadStart()}else B+=1,p.onLoadStart();F=B;for(x in y.textures){u=y.textures[x];void 0!==u.mapping&&void 0!==
	THREE[u.mapping]&&(u.mapping=new THREE[u.mapping]);if(u.url instanceof Array){v=u.url.length;l=[];for(n=0;n<v;n++)l[n]=d(u.url[n],y.urlBaseType);n=(n=/\.dds$/i.test(l[0]))?THREE.ImageUtils.loadCompressedTextureCube(l,u.mapping,D(v)):THREE.ImageUtils.loadTextureCube(l,u.mapping,D(v))}else n=/\.dds$/i.test(u.url),v=d(u.url,y.urlBaseType),l=D(1),n=n?THREE.ImageUtils.loadCompressedTexture(v,u.mapping,l):THREE.ImageUtils.loadTexture(v,u.mapping,l),void 0!==THREE[u.minFilter]&&(n.minFilter=THREE[u.minFilter]),
	void 0!==THREE[u.magFilter]&&(n.magFilter=THREE[u.magFilter]),u.anisotropy&&(n.anisotropy=u.anisotropy),u.repeat&&(n.repeat.set(u.repeat[0],u.repeat[1]),1!==u.repeat[0]&&(n.wrapS=THREE.RepeatWrapping),1!==u.repeat[1]&&(n.wrapT=THREE.RepeatWrapping)),u.offset&&n.offset.set(u.offset[0],u.offset[1]),u.wrap&&(v={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==v[u.wrap[0]]&&(n.wrapS=v[u.wrap[0]]),void 0!==v[u.wrap[1]]&&(n.wrapT=v[u.wrap[1]]));z.textures[x]=n}var G,C;for(G in y.materials){x=
	y.materials[G];for(C in x.parameters)"envMap"===C||"map"===C||"lightMap"===C||"bumpMap"===C?x.parameters[C]=z.textures[x.parameters[C]]:"shading"===C?x.parameters[C]="flat"===x.parameters[C]?THREE.FlatShading:THREE.SmoothShading:"side"===C?x.parameters[C]="double"==x.parameters[C]?THREE.DoubleSide:"back"==x.parameters[C]?THREE.BackSide:THREE.FrontSide:"blending"===C?x.parameters[C]=x.parameters[C]in THREE?THREE[x.parameters[C]]:THREE.NormalBlending:"combine"===C?x.parameters[C]=x.parameters[C]in THREE?
	THREE[x.parameters[C]]:THREE.MultiplyOperation:"vertexColors"===C?"face"==x.parameters[C]?x.parameters[C]=THREE.FaceColors:x.parameters[C]&&(x.parameters[C]=THREE.VertexColors):"wrapRGB"===C&&(D=x.parameters[C],x.parameters[C]=new THREE.Vector3(D[0],D[1],D[2]));void 0!==x.parameters.opacity&&1>x.parameters.opacity&&(x.parameters.transparent=!0);x.parameters.normalMap?(D=THREE.ShaderLib.normalmap,u=THREE.UniformsUtils.clone(D.uniforms),n=x.parameters.color,v=x.parameters.specular,l=x.parameters.ambient,
	E=x.parameters.shininess,u.tNormal.value=z.textures[x.parameters.normalMap],x.parameters.normalScale&&u.uNormalScale.value.set(x.parameters.normalScale[0],x.parameters.normalScale[1]),x.parameters.map&&(u.tDiffuse.value=x.parameters.map,u.enableDiffuse.value=!0),x.parameters.envMap&&(u.tCube.value=x.parameters.envMap,u.enableReflection.value=!0,u.reflectivity.value=x.parameters.reflectivity),x.parameters.lightMap&&(u.tAO.value=x.parameters.lightMap,u.enableAO.value=!0),x.parameters.specularMap&&(u.tSpecular.value=
	z.textures[x.parameters.specularMap],u.enableSpecular.value=!0),x.parameters.displacementMap&&(u.tDisplacement.value=z.textures[x.parameters.displacementMap],u.enableDisplacement.value=!0,u.uDisplacementBias.value=x.parameters.displacementBias,u.uDisplacementScale.value=x.parameters.displacementScale),u.diffuse.value.setHex(n),u.specular.value.setHex(v),u.ambient.value.setHex(l),u.shininess.value=E,x.parameters.opacity&&(u.opacity.value=x.parameters.opacity),s=new THREE.ShaderMaterial({fragmentShader:D.fragmentShader,
	vertexShader:D.vertexShader,uniforms:u,lights:!0,fog:!0})):s=new THREE[x.type](x.parameters);s.name=G;z.materials[G]=s}for(G in y.materials)if(x=y.materials[G],x.parameters.materials){C=[];for(n=0;n<x.parameters.materials.length;n++)C.push(z.materials[x.parameters.materials[n]]);z.materials[G].materials=C}e();z.cameras&&y.defaults.camera&&(z.currentCamera=z.cameras[y.defaults.camera]);z.fogs&&y.defaults.fog&&(z.scene.fog=z.fogs[y.defaults.fog]);p.callbackSync(z);j()}};THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b){var c=new THREE.ImageLoader(this.manager);c.setCrossOrigin(this.crossOrigin);c.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)})},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):this[b]="overdraw"==b?Number(c):c}}},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;
	a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);
THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
	this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
	"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
	a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;
	this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.perPixel=this.perPixel;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
	a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){for(var a=new THREE.MeshFaceMaterial,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a};THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.clone=function(){var a=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.rotation=this.rotation;a.fog=this.fog;return a};THREE.SpriteCanvasMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(a)};THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteCanvasMaterial.prototype.clone=function(){var a=new THREE.SpriteCanvasMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.program=this.program;return a};THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial;THREE.Texture=function(a,b,c,d,e,f,g,h,i){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==i?i:1;this.format=void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;
	this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=
	this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.DataTexture=function(a,b,c,d,e,f,g,h,i,j,k){THREE.Texture.call(this,null,f,g,h,i,j,d,e,k);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,d=this.children.length;for(c=0;c<d;c++)this.children[c].update(this.skinMatrix,b)};THREE.Sprite=function(a){THREE.Object3D.call(this);this.material=void 0!==a?a:new THREE.SpriteMaterial};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Particle=THREE.Sprite;THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);for(var b=Math.abs(b),c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var d=1,e=this.objects.length;d<e;d++)if(c>=this.objects[d].distance)this.objects[d-1].object.visible=!1,this.objects[d].object.visible=!0;else break;for(;d<e;d++)this.objects[d].object.visible=!1}}}();THREE.LOD.prototype.clone=function(){};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)){this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}this.dispatchEvent({type:"objectAdded",object:a});a.dispatchEvent({type:"addedToScene",scene:this});for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1);if(a.shadowCascadeArray)for(b=0;b<a.shadowCascadeArray.length;b++)this.__removeObject(a.shadowCascadeArray[b])}else a instanceof THREE.Camera||(this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1));this.dispatchEvent({type:"objectRemoved",object:a});a.dispatchEvent({type:"removedFromScene",scene:this});for(b=
																																																																																																																														 0;b<a.children.length;b++)this.__removeObject(a.children[b])};THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.CanvasRenderer=function(a){function b(a,b,c){for(var d=0,e=F.length;d<e;d++){var f=F[d];sa.copy(f.color);if(f instanceof THREE.DirectionalLight){var g=ea.setFromMatrixPosition(f.matrixWorld).normalize(),h=b.dot(g);0>=h||(h*=f.intensity,c.add(sa.multiplyScalar(h)))}else f instanceof THREE.PointLight&&(g=ea.setFromMatrixPosition(f.matrixWorld),h=b.dot(ea.subVectors(g,a).normalize()),0>=h||(h*=0==f.distance?1:1-Math.min(a.distanceTo(g)/f.distance,1),0!=h&&(h*=f.intensity,c.add(sa.multiplyScalar(h)))))}}
	function c(a,b,c,d){m(b);r(c);s(d);q(a.getStyle());v.stroke();S.expandByScalar(2*b)}function d(a){l(a.getStyle());v.fill()}function e(a){f(a.target)}function f(a){var b=a.wrapS===THREE.RepeatWrapping,c=a.wrapT===THREE.RepeatWrapping,d=a.image,e=document.createElement("canvas");e.width=d.width;e.height=d.height;var f=e.getContext("2d");f.setTransform(1,0,0,-1,0,d.height);f.drawImage(d,0,0);va[a.id]=v.createPattern(e,!0===b&&!0===c?"repeat":!0===b&&!1===c?"repeat-x":!1===b&&!0===c?"repeat-y":"no-repeat")}
	function g(a,b,c,d,g,h,i,j,m,k,p,q,n){if(!(n instanceof THREE.DataTexture)){!1===n.hasEventListener("update",e)&&(void 0!==n.image&&0<n.image.width&&f(n),n.addEventListener("update",e));var r=va[n.id];if(void 0!==r){l(r);var r=n.offset.x/n.repeat.x,s=n.offset.y/n.repeat.y,t=n.image.width*n.repeat.x,n=n.image.height*n.repeat.y,i=(i+r)*t,j=(j+s)*n,c=c-a,d=d-b,g=g-a,h=h-b,m=(m+r)*t-i,k=(k+s)*n-j,p=(p+r)*t-i,q=(q+s)*n-j,n=m*q-p*k;0!==n&&(r=1/n,n=(q*c-k*g)*r,k=(q*d-k*h)*r,c=(m*g-p*c)*r,d=(m*h-p*d)*r,a=
		a-n*i-c*j,b=b-k*i-d*j,v.save(),v.transform(n,k,c,d,a,b),v.fill(),v.restore())}else l("rgba(0,0,0,1)"),v.fill()}}function h(a,b,c,d,e,f,g,h,i,j,m,k,l){var n,p;n=l.width-1;p=l.height-1;g*=n;h*=p;c-=a;d-=b;e-=a;f-=b;i=i*n-g;j=j*p-h;m=m*n-g;k=k*p-h;p=1/(i*k-m*j);n=(k*c-j*e)*p;j=(k*d-j*f)*p;c=(i*e-m*c)*p;d=(i*f-m*d)*p;a=a-n*g-c*h;b=b-j*g-d*h;v.save();v.transform(n,j,c,d,a,b);v.clip();v.drawImage(l,0,0);v.restore()}function i(a,b,c,d){W[0]=255*a.r|0;W[1]=255*a.g|0;W[2]=255*a.b|0;W[4]=255*b.r|0;W[5]=255*
		b.g|0;W[6]=255*b.b|0;W[8]=255*c.r|0;W[9]=255*c.g|0;W[10]=255*c.b|0;W[12]=255*d.r|0;W[13]=255*d.g|0;W[14]=255*d.b|0;Ba.putImageData(Fa,0,0);Ea.drawImage(Ca,0,0);return Da}function j(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(c/=Math.sqrt(f),d*=c,e*=c,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function k(a){C!==a&&(C=v.globalAlpha=a)}function p(a){L!==a&&(a===THREE.NormalBlending?v.globalCompositeOperation="source-over":a===THREE.AdditiveBlending?v.globalCompositeOperation="lighter":a===THREE.SubtractiveBlending&&
		(v.globalCompositeOperation="darker"),L=a)}function m(a){V!==a&&(V=v.lineWidth=a)}function r(a){fa!==a&&(fa=v.lineCap=a)}function s(a){la!==a&&(la=v.lineJoin=a)}function q(a){O!==a&&(O=v.strokeStyle=a)}function l(a){Z!==a&&(Z=v.fillStyle=a)}function n(a,b){if(aa!==a||X!==b)v.setLineDash([a,b]),aa=a,X=b}console.log("THREE.CanvasRenderer",THREE.REVISION);var t=THREE.Math.smoothstep,a=a||{},w=this,B,I,F,z=new THREE.Projector,A=void 0!==a.canvas?a.canvas:document.createElement("canvas"),y=A.width,D=A.height,
		E=Math.floor(y/2),u=Math.floor(D/2),v=A.getContext("2d"),x=new THREE.Color(0),G=0,C=1,L=0,O=null,Z=null,V=null,fa=null,la=null,aa=null,X=0,ia,N,K,Y;new THREE.RenderableVertex;new THREE.RenderableVertex;var ja,na,oa,pa,qa,ra,$=new THREE.Color,ha=new THREE.Color,R=new THREE.Color,M=new THREE.Color,ka=new THREE.Color,Q=new THREE.Color,T=new THREE.Color,sa=new THREE.Color,va={},ma,U,ba,ca,ga,da,wa,xa,ya,ta,ua=new THREE.Box2,P=new THREE.Box2,S=new THREE.Box2,za=new THREE.Color,Ga=new THREE.Color,Ha=new THREE.Color,
		ea=new THREE.Vector3,Ca,Ba,Fa,W,Da,Ea,Aa=16;Ca=document.createElement("canvas");Ca.width=Ca.height=2;Ba=Ca.getContext("2d");Ba.fillStyle="rgba(0,0,0,1)";Ba.fillRect(0,0,2,2);Fa=Ba.getImageData(0,0,2,2);W=Fa.data;Da=document.createElement("canvas");Da.width=Da.height=Aa;Ea=Da.getContext("2d");Ea.translate(-Aa/2,-Aa/2);Ea.scale(Aa,Aa);Aa--;void 0===v.setLineDash&&(v.setLineDash=void 0!==v.mozDash?function(a){v.mozDash=null!==a[0]?a:null}:function(){});this.domElement=A;this.devicePixelRatio=void 0!==
		a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(a,b,c){y=a*this.devicePixelRatio;D=b*this.devicePixelRatio;E=Math.floor(y/2);u=Math.floor(D/2);A.width=y;A.height=D;1!==this.devicePixelRatio&&!1!==c&&(A.style.width=a+"px",A.style.height=b+"px");ua.set(new THREE.Vector2(-E,
		-u),new THREE.Vector2(E,u));P.set(new THREE.Vector2(-E,-u),new THREE.Vector2(E,u));C=1;L=0;la=fa=V=Z=O=null};this.setClearColor=function(a,b){x.set(a);G=void 0!==b?b:1;P.set(new THREE.Vector2(-E,-u),new THREE.Vector2(E,u))};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){v.setTransform(1,0,0,-1,E,u);!1===P.empty()&&(P.intersect(ua),
		P.expandByScalar(2),1>G&&v.clearRect(P.min.x|0,P.min.y|0,P.max.x-P.min.x|0,P.max.y-P.min.y|0),0<G&&(p(THREE.NormalBlending),k(1),l("rgba("+Math.floor(255*x.r)+","+Math.floor(255*x.g)+","+Math.floor(255*x.b)+","+G+")"),v.fillRect(P.min.x|0,P.min.y|0,P.max.x-P.min.x|0,P.max.y-P.min.y|0)),P.makeEmpty())};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.render=function(a,x){if(!1===x instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");
	else{!0===this.autoClear&&this.clear();v.setTransform(1,0,0,-1,E,u);w.info.render.vertices=0;w.info.render.faces=0;B=z.projectScene(a,x,this.sortObjects,this.sortElements);I=B.elements;F=B.lights;ia=x;za.setRGB(0,0,0);Ga.setRGB(0,0,0);Ha.setRGB(0,0,0);for(var y=0,D=F.length;y<D;y++){var A=F[y],C=A.color;A instanceof THREE.AmbientLight?za.add(C):A instanceof THREE.DirectionalLight?Ga.add(C):A instanceof THREE.PointLight&&Ha.add(C)}y=0;for(D=I.length;y<D;y++){var J=I[y],H=J.material;if(!(void 0===H||
		!1===H.visible)){S.makeEmpty();if(J instanceof THREE.RenderableSprite){N=J;N.x*=E;N.y*=u;A=N;C=H;k(C.opacity);p(C.blending);var G=J.scale.x*E,J=J.scale.y*u,H=0.5*Math.sqrt(G*G+J*J);S.min.set(A.x-H,A.y-H);S.max.set(A.x+H,A.y+H);if(!1===ua.isIntersectionBox(S))S.makeEmpty();else if(C instanceof THREE.SpriteMaterial||C instanceof THREE.ParticleSystemMaterial){var L=C.map;if(null!==L){!1===L.hasEventListener("update",e)&&(void 0!==L.image&&0<L.image.width&&f(L),L.addEventListener("update",e));H=va[L.id];
		void 0!==H?l(H):l("rgba( 0, 0, 0, 1 )");var O=L.image,H=O.width*L.offset.x,V=O.height*L.offset.y,W=O.width*L.repeat.x,L=O.height*L.repeat.y,O=G/W,X=J/L;v.save();v.translate(A.x,A.y);0!==C.rotation&&v.rotate(C.rotation);v.translate(-G/2,-J/2);v.scale(O,X);v.translate(-H,-V);v.fillRect(H,V,W,L)}else l(C.color.getStyle()),v.save(),v.translate(A.x,A.y),0!==C.rotation&&v.rotate(C.rotation),v.scale(G,-J),v.fillRect(-0.5,-0.5,1,1);v.restore()}else C instanceof THREE.SpriteCanvasMaterial&&(q(C.color.getStyle()),
		l(C.color.getStyle()),v.save(),v.translate(A.x,A.y),0!==C.rotation&&v.rotate(C.rotation),v.scale(G,J),C.program(v),v.restore())}else if(J instanceof THREE.RenderableLine){if(N=J.v1,K=J.v2,N.positionScreen.x*=E,N.positionScreen.y*=u,K.positionScreen.x*=E,K.positionScreen.y*=u,S.setFromPoints([N.positionScreen,K.positionScreen]),!0===ua.isIntersectionBox(S))if(A=N,C=K,G=J,J=H,k(J.opacity),p(J.blending),v.beginPath(),v.moveTo(A.positionScreen.x,A.positionScreen.y),v.lineTo(C.positionScreen.x,C.positionScreen.y),
		J instanceof THREE.LineBasicMaterial){m(J.linewidth);r(J.linecap);s(J.linejoin);if(J.vertexColors!==THREE.VertexColors)q(J.color.getStyle());else if(H=G.vertexColors[0].getStyle(),G=G.vertexColors[1].getStyle(),H===G)q(H);else{try{var Z=v.createLinearGradient(A.positionScreen.x,A.positionScreen.y,C.positionScreen.x,C.positionScreen.y);Z.addColorStop(0,H);Z.addColorStop(1,G)}catch(fa){Z=H}q(Z)}v.stroke();S.expandByScalar(2*J.linewidth)}else J instanceof THREE.LineDashedMaterial&&(m(J.linewidth),r(J.linecap),
		s(J.linejoin),q(J.color.getStyle()),n(J.dashSize,J.gapSize),v.stroke(),S.expandByScalar(2*J.linewidth),n(null,null))}else if(J instanceof THREE.RenderableFace3){N=J.v1;K=J.v2;Y=J.v3;if(-1>N.positionScreen.z||1<N.positionScreen.z)continue;if(-1>K.positionScreen.z||1<K.positionScreen.z)continue;if(-1>Y.positionScreen.z||1<Y.positionScreen.z)continue;N.positionScreen.x*=E;N.positionScreen.y*=u;K.positionScreen.x*=E;K.positionScreen.y*=u;Y.positionScreen.x*=E;Y.positionScreen.y*=u;0<H.overdraw&&(j(N.positionScreen,
		K.positionScreen,H.overdraw),j(K.positionScreen,Y.positionScreen,H.overdraw),j(Y.positionScreen,N.positionScreen,H.overdraw));S.setFromPoints([N.positionScreen,K.positionScreen,Y.positionScreen]);if(!0===ua.isIntersectionBox(S)){A=N;C=K;G=Y;w.info.render.vertices+=3;w.info.render.faces++;k(H.opacity);p(H.blending);ja=A.positionScreen.x;na=A.positionScreen.y;oa=C.positionScreen.x;pa=C.positionScreen.y;qa=G.positionScreen.x;ra=G.positionScreen.y;var V=ja,W=na,L=oa,O=pa,X=qa,aa=ra;v.beginPath();v.moveTo(V,
		W);v.lineTo(L,O);v.lineTo(X,aa);v.closePath();(H instanceof THREE.MeshLambertMaterial||H instanceof THREE.MeshPhongMaterial)&&null===H.map?(Q.copy(H.color),T.copy(H.emissive),H.vertexColors===THREE.FaceColors&&Q.multiply(J.color),!1===H.wireframe&&H.shading===THREE.SmoothShading&&3===J.vertexNormalsLength?(ha.copy(za),R.copy(za),M.copy(za),b(J.v1.positionWorld,J.vertexNormalsModel[0],ha),b(J.v2.positionWorld,J.vertexNormalsModel[1],R),b(J.v3.positionWorld,J.vertexNormalsModel[2],M),ha.multiply(Q).add(T),
		R.multiply(Q).add(T),M.multiply(Q).add(T),ka.addColors(R,M).multiplyScalar(0.5),ba=i(ha,R,M,ka),h(ja,na,oa,pa,qa,ra,0,0,1,0,0,1,ba)):($.copy(za),b(J.centroidModel,J.normalModel,$),$.multiply(Q).add(T),!0===H.wireframe?c($,H.wireframeLinewidth,H.wireframeLinecap,H.wireframeLinejoin):d($))):H instanceof THREE.MeshBasicMaterial||H instanceof THREE.MeshLambertMaterial||H instanceof THREE.MeshPhongMaterial?null!==H.map?H.map.mapping instanceof THREE.UVMapping&&(ca=J.uvs[0],g(ja,na,oa,pa,qa,ra,ca[0].x,
		ca[0].y,ca[1].x,ca[1].y,ca[2].x,ca[2].y,H.map)):null!==H.envMap?H.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(ea.copy(J.vertexNormalsModelView[0]),ga=0.5*ea.x+0.5,da=0.5*ea.y+0.5,ea.copy(J.vertexNormalsModelView[1]),wa=0.5*ea.x+0.5,xa=0.5*ea.y+0.5,ea.copy(J.vertexNormalsModelView[2]),ya=0.5*ea.x+0.5,ta=0.5*ea.y+0.5,g(ja,na,oa,pa,qa,ra,ga,da,wa,xa,ya,ta,H.envMap)):($.copy(H.color),H.vertexColors===THREE.FaceColors&&$.multiply(J.color),!0===H.wireframe?c($,H.wireframeLinewidth,H.wireframeLinecap,
		H.wireframeLinejoin):d($)):H instanceof THREE.MeshDepthMaterial?(ma=ia.near,U=ia.far,ha.r=ha.g=ha.b=1-t(A.positionScreen.z*A.positionScreen.w,ma,U),R.r=R.g=R.b=1-t(C.positionScreen.z*C.positionScreen.w,ma,U),M.r=M.g=M.b=1-t(G.positionScreen.z*G.positionScreen.w,ma,U),ka.addColors(R,M).multiplyScalar(0.5),ba=i(ha,R,M,ka),h(ja,na,oa,pa,qa,ra,0,0,1,0,0,1,ba)):H instanceof THREE.MeshNormalMaterial&&(A=void 0,H.shading===THREE.FlatShading?(A=J.normalModelView,$.setRGB(A.x,A.y,A.z).multiplyScalar(0.5).addScalar(0.5),
		!0===H.wireframe?c($,H.wireframeLinewidth,H.wireframeLinecap,H.wireframeLinejoin):d($)):H.shading===THREE.SmoothShading&&(A=J.vertexNormalsModelView[0],ha.setRGB(A.x,A.y,A.z).multiplyScalar(0.5).addScalar(0.5),A=J.vertexNormalsModelView[1],R.setRGB(A.x,A.y,A.z).multiplyScalar(0.5).addScalar(0.5),A=J.vertexNormalsModelView[2],M.setRGB(A.x,A.y,A.z).multiplyScalar(0.5).addScalar(0.5),ka.addColors(R,M).multiplyScalar(0.5),ba=i(ha,R,M,ka),h(ja,na,oa,pa,qa,ra,0,0,1,0,0,1,ba)))}}P.union(S)}}v.setTransform(1,
		0,0,1,0,0)}}};THREE.RenderableVertex=function(){this.position=new THREE.Vector3;this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};THREE.RenderableFace3=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=
	0};THREE.RenderableObject=function(){this.id=0;this.object=null;this.z=0};THREE.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null;this.z=0};THREE.GeometryUtils={merge:function(a,b,c){var d,e,f=a.vertices.length,g=b instanceof THREE.Mesh?b.geometry:b,h=a.vertices,i=g.vertices,j=a.faces,k=g.faces,a=a.faceVertexUvs[0],g=g.faceVertexUvs[0];void 0===c&&(c=0);b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,e=(new THREE.Matrix3).getNormalMatrix(d));for(var b=0,p=i.length;b<p;b++){var m=i[b].clone();d&&m.applyMatrix4(d);h.push(m)}b=0;for(p=k.length;b<p;b++){var m=k[b],r,s,q=m.vertexNormals,l=m.vertexColors;r=new THREE.Face3(m.a+
	f,m.b+f,m.c+f);r.normal.copy(m.normal);e&&r.normal.applyMatrix3(e).normalize();h=0;for(i=q.length;h<i;h++)s=q[h].clone(),e&&s.applyMatrix3(e).normalize(),r.vertexNormals.push(s);r.color.copy(m.color);h=0;for(i=l.length;h<i;h++)s=l[h],r.vertexColors.push(s.clone());r.materialIndex=m.materialIndex+c;r.centroid.copy(m.centroid);d&&r.centroid.applyMatrix4(d);j.push(r)}b=0;for(p=g.length;b<p;b++){c=g[b];d=[];h=0;for(i=c.length;h<i;h++)d.push(new THREE.Vector2(c[h].x,c[h].y));a.push(d)}},randomPointInTriangle:function(){var a=
	new THREE.Vector3;return function(b,c,d){var e=new THREE.Vector3,f=THREE.Math.random16(),g=THREE.Math.random16();1<f+g&&(f=1-f,g=1-g);var h=1-f-g;e.copy(b);e.multiplyScalar(f);a.copy(c);a.multiplyScalar(g);e.add(a);a.copy(d);a.multiplyScalar(h);e.add(a);return e}}(),randomPointInFace:function(a,b){return THREE.GeometryUtils.randomPointInTriangle(b.vertices[a.a],b.vertices[a.b],b.vertices[a.c])},randomPointsInGeometry:function(a,b){function c(a){function b(c,d){if(d<c)return c;var e=c+Math.floor((d-
	c)/2);return j[e]>a?b(c,e-1):j[e]<a?b(e+1,d):e}return b(0,j.length-1)}var d,e,f=a.faces,g=a.vertices,h=f.length,i=0,j=[],k,p,m;for(e=0;e<h;e++)d=f[e],k=g[d.a],p=g[d.b],m=g[d.c],d._area=THREE.GeometryUtils.triangleArea(k,p,m),i+=d._area,j[e]=i;d=[];for(e=0;e<b;e++)g=THREE.Math.random16()*i,g=c(g),d[e]=THREE.GeometryUtils.randomPointInFace(f[g],a,!0);return d},triangleArea:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){a.subVectors(d,c);b.subVectors(e,c);a.cross(b);return 0.5*
	a.length()}}(),center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.addVectors(b.min,b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},triangulateQuads:function(a){var b,c,d,e,f=[],g=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)g[b]=[];b=0;for(c=a.faces.length;b<c;b++){f.push(a.faces[b]);d=0;for(e=a.faceVertexUvs.length;d<e;d++)g[d].push(a.faceVertexUvs[d][b])}a.faces=f;a.faceVertexUvs=g;a.computeCentroids();
	a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()}};THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c){var d=new THREE.ImageLoader;d.crossOrigin=this.crossOrigin;var e=new THREE.Texture(void 0,b),b=d.load(a,function(){e.needsUpdate=!0;c&&c(e)});e.image=b;e.sourceFile=a;return e},loadCompressedTexture:function(a,b,c,d){var e=new THREE.CompressedTexture;e.mapping=b;var f=new XMLHttpRequest;f.onload=function(){var a=THREE.ImageUtils.parseDDS(f.response,!0);e.format=a.format;e.mipmaps=a.mipmaps;e.image.width=a.width;e.image.height=a.height;
	e.generateMipmaps=!1;e.needsUpdate=!0;c&&c(e)};f.onerror=d;f.open("GET",a,!0);f.responseType="arraybuffer";f.send(null);return e},loadTextureCube:function(a,b,c,d){var e=[];e.loadCount=0;var f=new THREE.Texture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;for(var b=0,g=a.length;b<g;++b){var h=new Image;e[b]=h;h.onload=function(){e.loadCount+=1;6===e.loadCount&&(f.needsUpdate=!0,c&&c(f))};h.onerror=d;h.crossOrigin=this.crossOrigin;h.src=a[b]}return f},loadCompressedTextureCube:function(a,b,c,d){var e=
	[];e.loadCount=0;var f=new THREE.CompressedTexture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;b=function(a,b){return function(){var d=THREE.ImageUtils.parseDDS(a.response,!0);b.format=d.format;b.mipmaps=d.mipmaps;b.width=d.width;b.height=d.height;e.loadCount+=1;6===e.loadCount&&(f.format=d.format,f.needsUpdate=!0,c&&c(f))}};if(a instanceof Array)for(var g=0,h=a.length;g<h;++g){var i={};e[g]=i;var j=new XMLHttpRequest;j.onload=b(j,i);j.onerror=d;i=a[g];j.open("GET",i,!0);j.responseType=
	"arraybuffer";j.send(null)}else j=new XMLHttpRequest,j.onload=function(){var a=THREE.ImageUtils.parseDDS(j.response,!0);if(a.isCubemap){for(var b=a.mipmaps.length/a.mipmapCount,d=0;d<b;d++){e[d]={mipmaps:[]};for(var g=0;g<a.mipmapCount;g++)e[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+g]),e[d].format=a.format,e[d].width=a.width,e[d].height=a.height}f.format=a.format;f.needsUpdate=!0;c&&c(f)}},j.onerror=d,j.open("GET",a,!0),j.responseType="arraybuffer",j.send(null);return f},loadDDSTexture:function(a,
																																																																																																																														 b,c,d){var e=[];e.loadCount=0;var f=new THREE.CompressedTexture;f.image=e;void 0!==b&&(f.mapping=b);f.flipY=!1;f.generateMipmaps=!1;var g=new XMLHttpRequest;g.onload=function(){var a=THREE.ImageUtils.parseDDS(g.response,!0);if(a.isCubemap)for(var b=a.mipmaps.length/a.mipmapCount,d=0;d<b;d++){e[d]={mipmaps:[]};for(var k=0;k<a.mipmapCount;k++)e[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+k]),e[d].format=a.format,e[d].width=a.width,e[d].height=a.height}else f.image.width=a.width,f.image.height=a.height,
	f.mipmaps=a.mipmaps;f.format=a.format;f.needsUpdate=!0;c&&c(f)};g.onerror=d;g.open("GET",a,!0);g.responseType="arraybuffer";g.send(null);return f},parseDDS:function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}var d={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},e=c("DXT1"),f=c("DXT3"),g=c("DXT5"),h=new Int32Array(a,0,31);if(542327876!==h[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),d;if(!h[20]&
	4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),d;var i=h[21],j=!1;switch(i){case e:e=8;d.format=THREE.RGB_S3TC_DXT1_Format;break;case f:e=16;d.format=THREE.RGBA_S3TC_DXT3_Format;break;case g:e=16;d.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(32==h[22]&&h[23]&16711680&&h[24]&65280&&h[25]&255&&h[26]&4278190080)j=!0,e=64,d.format=THREE.RGBAFormat;else return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(i&
	255,i>>8&255,i>>16&255,i>>24&255)),d}d.mipmapCount=1;h[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,h[7]));d.isCubemap=h[28]&512?!0:!1;d.width=h[4];d.height=h[3];for(var h=h[1]+4,f=d.width,g=d.height,i=d.isCubemap?6:1,k=0;k<i;k++){for(var p=0;p<d.mipmapCount;p++){if(j){var m;m=f;for(var r=g,s=4*m*r,q=new Uint8Array(a,h,s),s=new Uint8Array(s),l=0,n=0,t=0;t<r;t++)for(var w=0;w<m;w++){var B=q[n];n++;var I=q[n];n++;var F=q[n];n++;var z=q[n];n++;s[l]=F;l++;s[l]=I;l++;s[l]=B;l++;s[l]=z;l++}m=s;r=m.length}else r=
	Math.max(4,f)/4*Math.max(4,g)/4*e,m=new Uint8Array(a,h,r);d.mipmaps.push({data:m,width:f,height:g});h+=r;f=Math.max(0.5*f,1);g=Math.max(0.5*g,1)}f=d.width;g=d.height}return d},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]},b=b|1,d=a.width,e=a.height,f=document.createElement("canvas");f.width=d;f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,d,e).data,i=g.createImageData(d,e),j=i.data,k=0;k<
	d;k++)for(var p=0;p<e;p++){var m=0>p-1?0:p-1,r=p+1>e-1?e-1:p+1,s=0>k-1?0:k-1,q=k+1>d-1?d-1:k+1,l=[],n=[0,0,h[4*(p*d+k)]/255*b];l.push([-1,0,h[4*(p*d+s)]/255*b]);l.push([-1,-1,h[4*(m*d+s)]/255*b]);l.push([0,-1,h[4*(m*d+k)]/255*b]);l.push([1,-1,h[4*(m*d+q)]/255*b]);l.push([1,0,h[4*(p*d+q)]/255*b]);l.push([1,1,h[4*(r*d+q)]/255*b]);l.push([0,1,h[4*(r*d+k)]/255*b]);l.push([-1,1,h[4*(r*d+s)]/255*b]);m=[];s=l.length;for(r=0;r<s;r++){var q=l[r],t=l[(r+1)%s],q=[q[0]-n[0],q[1]-n[1],q[2]-n[2]],t=[t[0]-n[0],
	t[1]-n[1],t[2]-n[2]];m.push(c([q[1]*t[2]-q[2]*t[1],q[2]*t[0]-q[0]*t[2],q[0]*t[1]-q[1]*t[0]]))}l=[0,0,0];for(r=0;r<m.length;r++)l[0]+=m[r][0],l[1]+=m[r][1],l[2]+=m[r][2];l[0]/=m.length;l[1]/=m.length;l[2]/=m.length;n=4*(p*d+k);j[n]=255*((l[0]+1)/2)|0;j[n+1]=255*((l[1]+1)/2)|0;j[n+2]=255*l[2]|0;j[n+3]=255}g.putImageData(i,0,0);return f},generateDataTexture:function(a,b,c){for(var d=a*b,e=new Uint8Array(3*d),f=Math.floor(255*c.r),g=Math.floor(255*c.g),c=Math.floor(255*c.b),h=0;h<d;h++)e[3*h]=f,e[3*h+
	1]=g,e[3*h+2]=c;a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){for(var b=this.getFace(),c=this.size/b.resolution,d=
	0,e=String(a).split(""),f=e.length,g=[],a=0;a<f;a++){var h=new THREE.Path,h=this.extractGlyphPoints(e[a],b,c,d,h),d=d+h.offset;g.push(h.path)}return{paths:g,offset:d/2}},extractGlyphPoints:function(a,b,c,d,e){var f=[],g,h,i,j,k,p,m,r,s,q,l,n=b.glyphs[a]||b.glyphs["?"];if(n){if(n.o){b=n._cachedOutline||(n._cachedOutline=n.o.split(" "));j=b.length;for(a=0;a<j;)switch(i=b[a++],i){case "m":i=b[a++]*c+d;k=b[a++]*c;e.moveTo(i,k);break;case "l":i=b[a++]*c+d;k=b[a++]*c;e.lineTo(i,k);break;case "q":i=b[a++]*
	c+d;k=b[a++]*c;r=b[a++]*c+d;s=b[a++]*c;e.quadraticCurveTo(r,s,i,k);if(g=f[f.length-1]){p=g.x;m=g.y;g=1;for(h=this.divisions;g<=h;g++){var t=g/h;THREE.Shape.Utils.b2(t,p,r,i);THREE.Shape.Utils.b2(t,m,s,k)}}break;case "b":if(i=b[a++]*c+d,k=b[a++]*c,r=b[a++]*c+d,s=b[a++]*-c,q=b[a++]*c+d,l=b[a++]*-c,e.bezierCurveTo(i,k,r,s,q,l),g=f[f.length-1]){p=g.x;m=g.y;g=1;for(h=this.divisions;g<=h;g++)t=g/h,THREE.Shape.Utils.b3(t,p,r,q,i),THREE.Shape.Utils.b3(t,m,s,l,k)}}}return{offset:n.ha*c,path:e}}}};
THREE.FontUtils.generateShapes=function(a,b){var b=b||{},c=void 0!==b.curveSegments?b.curveSegments:4,d=void 0!==b.font?b.font:"helvetiker",e=void 0!==b.weight?b.weight:"normal",f=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=d;THREE.FontUtils.weight=e;THREE.FontUtils.style=f;c=THREE.FontUtils.drawText(a).paths;d=[];e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d};
(function(a){var b=function(a){for(var b=a.length,e=0,f=b-1,g=0;g<b;f=g++)e+=a[f].x*a[g].y-a[g].x*a[f].y;return 0.5*e};a.Triangulate=function(a,d){var e=a.length;if(3>e)return null;var f=[],g=[],h=[],i,j,k;if(0<b(a))for(j=0;j<e;j++)g[j]=j;else for(j=0;j<e;j++)g[j]=e-1-j;var p=2*e;for(j=e-1;2<e;){if(0>=p--){console.log("Warning, unable to triangulate polygon!");break}i=j;e<=i&&(i=0);j=i+1;e<=j&&(j=0);k=j+1;e<=k&&(k=0);var m;a:{var r=m=void 0,s=void 0,q=void 0,l=void 0,n=void 0,t=void 0,w=void 0,B=
	void 0,r=a[g[i]].x,s=a[g[i]].y,q=a[g[j]].x,l=a[g[j]].y,n=a[g[k]].x,t=a[g[k]].y;if(1E-10>(q-r)*(t-s)-(l-s)*(n-r))m=!1;else{var I=void 0,F=void 0,z=void 0,A=void 0,y=void 0,D=void 0,E=void 0,u=void 0,v=void 0,x=void 0,v=u=E=B=w=void 0,I=n-q,F=t-l,z=r-n,A=s-t,y=q-r,D=l-s;for(m=0;m<e;m++)if(!(m===i||m===j||m===k))if(w=a[g[m]].x,B=a[g[m]].y,E=w-r,u=B-s,v=w-q,x=B-l,w-=n,B-=t,v=I*x-F*v,E=y*u-D*E,u=z*B-A*w,-1E-10<=v&&-1E-10<=u&&-1E-10<=E){m=!1;break a}m=!0}}if(m){f.push([a[g[i]],a[g[j]],a[g[k]]]);h.push([g[i],
	g[j],g[k]]);i=j;for(k=j+1;k<e;i++,k++)g[i]=g[k];e--;p=2*e}}return d?h:f};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.CubeGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,q){var l,n=h.widthSegments,t=h.heightSegments,w=e/2,B=f/2,I=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)l="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)l="y",t=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)l="x",n=h.depthSegments;var F=n+1,z=t+1,A=e/n,y=f/t,D=new THREE.Vector3;D[l]=0<g?1:-1;for(e=0;e<z;e++)for(f=0;f<F;f++){var E=new THREE.Vector3;E[a]=(f*A-w)*c;E[b]=(e*y-B)*d;E[l]=g;h.vertices.push(E)}for(e=
																																																																																																																																																																																											 0;e<t;e++)for(f=0;f<n;f++)B=f+F*e,a=f+F*(e+1),b=f+1+F*(e+1),c=f+1+F*e,d=new THREE.Vector2(f/n,1-e/t),g=new THREE.Vector2(f/n,1-(e+1)/t),l=new THREE.Vector2((f+1)/n,1-(e+1)/t),w=new THREE.Vector2((f+1)/n,1-e/t),B=new THREE.Face3(B+I,a+I,c+I),B.normal.copy(D),B.vertexNormals.push(D.clone(),D.clone(),D.clone()),B.materialIndex=q,h.faces.push(B),h.faceVertexUvs[0].push([d,g,w]),B=new THREE.Face3(a+I,b+I,c+I),B.normal.copy(D),B.vertexNormals.push(D.clone(),D.clone(),D.clone()),B.materialIndex=q,h.faces.push(B),
	h.faceVertexUvs[0].push([g.clone(),l,w.clone()])}THREE.Geometry.call(this);var h=this;this.width=a;this.height=b;this.depth=c;this.widthSegments=d||1;this.heightSegments=e||1;this.depthSegments=f||1;a=this.width/2;b=this.height/2;c=this.depth/2;g("z","y",-1,-1,this.depth,this.height,a,0);g("z","y",1,-1,this.depth,this.height,-a,1);g("x","z",1,1,this.width,this.depth,b,2);g("x","z",1,-1,this.width,this.depth,-b,3);g("x","y",1,-1,this.width,this.height,c,4);g("x","y",-1,-1,this.width,this.height,-c,
	5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);

/*! Hammer.JS - v1.0.9 - 2014-03-18
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(a,b){"use strict";function c(){d.READY||(s.determineEventTypes(),o.each(d.gestures,function(a){u.register(a)}),s.onTouch(d.DOCUMENT,m,u.detect),s.onTouch(d.DOCUMENT,n,u.detect),d.READY=!0)}var d=function(a,b){return new d.Instance(a,b||{})};d.VERSION="1.0.9",d.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},d.HAS_POINTEREVENTS=a.navigator.pointerEnabled||a.navigator.msPointerEnabled,d.HAS_TOUCHEVENTS="ontouchstart"in a,d.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&a.navigator.userAgent.match(d.MOBILE_REGEX),d.EVENT_TYPES={},d.UPDATE_VELOCITY_INTERVAL=16,d.DOCUMENT=a.document;var e=d.DIRECTION_DOWN="down",f=d.DIRECTION_LEFT="left",g=d.DIRECTION_UP="up",h=d.DIRECTION_RIGHT="right",i=d.POINTER_MOUSE="mouse",j=d.POINTER_TOUCH="touch",k=d.POINTER_PEN="pen",l=d.EVENT_START="start",m=d.EVENT_MOVE="move",n=d.EVENT_END="end";d.plugins=d.plugins||{},d.gestures=d.gestures||{},d.READY=!1;var o=d.utils={extend:function(a,c,d){for(var e in c)a[e]!==b&&d||(a[e]=c[e]);return a},each:function(a,c,d){var e,f;if("forEach"in a)a.forEach(c,d);else if(a.length!==b){for(e=-1;f=a[++e];)if(c.call(d,f,e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&c.call(d,a[e],e,a)===!1)return},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[];return o.each(a,function(a){b.push("undefined"!=typeof a.clientX?a.clientX:a.pageX),c.push("undefined"!=typeof a.clientY?a.clientY:a.pageY)}),{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),d=Math.abs(a.pageY-b.pageY);return c>=d?a.pageX-b.pageX>0?f:h:a.pageY-b.pageY>0?g:e},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==g||a==e},toggleDefaultBehavior:function(a,b,c){if(b&&a&&a.style){o.each(["webkit","moz","Moz","ms","o",""],function(d){o.each(b,function(b,e){d&&(e=d+e.substring(0,1).toUpperCase()+e.substring(1)),e in a.style&&(a.style[e]=!c&&b)})});var d=function(){return!1};"none"==b.userSelect&&(a.onselectstart=!c&&d),"none"==b.userDrag&&(a.ondragstart=!c&&d)}}};d.Instance=function(a,b){var e=this;return c(),this.element=a,this.enabled=!0,this.options=o.extend(o.extend({},d.defaults),b||{}),this.options.stop_browser_behavior&&o.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!1),this.eventStartHandler=s.onTouch(a,l,function(a){e.enabled&&u.startDetect(e,a)}),this.eventHandlers=[],this},d.Instance.prototype={on:function(a,b){var c=a.split(" ");return o.each(c,function(a){this.element.addEventListener(a,b,!1),this.eventHandlers.push({gesture:a,handler:b})},this),this},off:function(a,b){var c,d,e=a.split(" ");return o.each(e,function(a){for(this.element.removeEventListener(a,b,!1),c=-1;d=this.eventHandlers[++c];)d.gesture===a&&d.handler===b&&this.eventHandlers.splice(c,1)},this),this},trigger:function(a,b){b||(b={});var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return o.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this},dispose:function(){var a,b;for(this.options.stop_browser_behavior&&o.toggleDefaultBehavior(this.element,this.options.stop_browser_behavior,!0),a=-1;b=this.eventHandlers[++a];)this.element.removeEventListener(b.gesture,b.handler,!1);return this.eventHandlers=[],s.unbindDom(this.element,d.EVENT_TYPES[l],this.eventStartHandler),null}};var p=null,q=!1,r=!1,s=d.event={bindDom:function(a,b,c){var d=b.split(" ");o.each(d,function(b){a.addEventListener(b,c,!1)})},unbindDom:function(a,b,c){var d=b.split(" ");o.each(d,function(b){a.removeEventListener(b,c,!1)})},onTouch:function(a,b,c){var e=this,f=function(f){var g=f.type.toLowerCase();if(!g.match(/mouse/)||!r){g.match(/touch/)||g.match(/pointerdown/)||g.match(/mouse/)&&1===f.which?q=!0:g.match(/mouse/)&&!f.which&&(q=!1),g.match(/touch|pointer/)&&(r=!0);var h=0;q&&(d.HAS_POINTEREVENTS&&b!=n?h=t.updatePointer(b,f):g.match(/touch/)?h=f.touches.length:r||(h=g.match(/up/)?0:1),h>0&&b==n?b=m:h||(b=n),(h||null===p)&&(p=f),c.call(u,e.collectEventData(a,b,e.getTouchList(p,b),f)),d.HAS_POINTEREVENTS&&b==n&&(h=t.updatePointer(b,f))),h||(p=null,q=!1,r=!1,t.reset())}};return this.bindDom(a,d.EVENT_TYPES[b],f),f},determineEventTypes:function(){var a;a=d.HAS_POINTEREVENTS?t.getEvents():d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],d.EVENT_TYPES[l]=a[0],d.EVENT_TYPES[m]=a[1],d.EVENT_TYPES[n]=a[2]},getTouchList:function(a){return d.HAS_POINTEREVENTS?t.getTouchList():a.touches?a.touches:(a.identifier=1,[a])},collectEventData:function(a,b,c,d){var e=j;return(d.type.match(/mouse/)||t.matchType(i,d))&&(e=i),{center:o.getCenter(c),timeStamp:(new Date).getTime(),target:d.target,touches:c,eventType:b,pointerType:e,srcEvent:d,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return u.stopDetect()}}}},t=d.PointerEvent={pointers:{},getTouchList:function(){var a=[];return o.each(this.pointers,function(b){a.push(b)}),a},updatePointer:function(a,b){return a==n?delete this.pointers[b.pointerId]:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b),Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,d={};return d[i]=c===i,d[j]=c===j,d[k]=c===k,d[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},u=d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:o.extend({},b),lastEvent:!1,lastVelocityEvent:!1,velocity:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst.options;return o.each(this.gestures,function(c){return this.stopped||b[c.name]===!1||c.handler.call(c,a,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=a),a.eventType==n&&!a.touches.length-1&&this.stopDetect(),a}},stopDetect:function(){this.previous=o.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(a){var b=this.current,c=b.startEvent;(a.touches.length!=c.touches.length||a.touches===c.touches)&&(c.touches=[],o.each(a.touches,function(a){c.touches.push(o.extend({},a))}));var e,f,g=a.timeStamp-c.timeStamp,h=a.center.pageX-c.center.pageX,i=a.center.pageY-c.center.pageY,j=b.lastVelocityEvent,k=b.velocity;return j&&a.timeStamp-j.timeStamp>d.UPDATE_VELOCITY_INTERVAL?(k=o.getVelocity(a.timeStamp-j.timeStamp,a.center.pageX-j.center.pageX,a.center.pageY-j.center.pageY),b.lastVelocityEvent=a,b.velocity=k):b.velocity||(k=o.getVelocity(g,h,i),b.lastVelocityEvent=a,b.velocity=k),a.eventType==n?(e=b.lastEvent&&b.lastEvent.interimAngle,f=b.lastEvent&&b.lastEvent.interimDirection):(e=b.lastEvent&&o.getAngle(b.lastEvent.center,a.center),f=b.lastEvent&&o.getDirection(b.lastEvent.center,a.center)),o.extend(a,{deltaTime:g,deltaX:h,deltaY:i,velocityX:k.x,velocityY:k.y,distance:o.getDistance(c.center,a.center),angle:o.getAngle(c.center,a.center),interimAngle:e,direction:o.getDirection(c.center,a.center),interimDirection:f,scale:o.getScale(c.touches,a.touches),rotation:o.getRotation(c.touches,a.touches),startEvent:c}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),o.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}};d.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(a,b){if(u.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(b.options.drag_max_touches>0&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case l:this.triggered=!1;break;case m:if(a.distance<b.options.drag_min_distance&&u.current.name!=this.name)return;if(u.current.name!=this.name&&(u.current.name=this.name,b.options.correct_for_drag_min_distance&&a.distance>0)){var c=Math.abs(b.options.drag_min_distance/a.distance);u.current.startEvent.center.pageX+=a.deltaX*c,u.current.startEvent.center.pageY+=a.deltaY*c,a=u.extendEventData(a)}(u.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&b.options.drag_lock_min_distance<=a.distance)&&(a.drag_locked_to_axis=!0);var d=u.current.lastEvent.direction;a.drag_locked_to_axis&&d!==a.direction&&(a.direction=o.isVertical(d)?a.deltaY<0?g:e:a.deltaX<0?f:h),this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),b.trigger(this.name+a.direction,a);var i=o.isVertical(a.direction);(b.options.drag_block_vertical&&i||b.options.drag_block_horizontal&&!i)&&a.preventDefault();break;case n:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}},d.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case l:clearTimeout(this.timer),u.current.name=this.name,this.timer=setTimeout(function(){"hold"==u.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case m:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case n:clearTimeout(this.timer)}}},d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==n&&b.trigger(this.name,a)}},d.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){if(a.eventType==n){if(a.touches.length<b.options.swipe_min_touches||a.touches.length>b.options.swipe_max_touches)return;(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},d.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},has_moved:!1,handler:function(a,b){var c,d,e;a.eventType==l?this.has_moved=!1:a.eventType!=m||this.moved?a.eventType==n&&"touchcancel"!=a.srcEvent.type&&a.deltaTime<b.options.tap_max_touchtime&&!this.has_moved&&(c=u.previous,d=c&&c.lastEvent&&a.timeStamp-c.lastEvent.timeStamp,e=!1,c&&"tap"==c.name&&d&&d<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),e=!0),(!e||b.options.tap_always)&&(u.current.name="tap",b.trigger(u.current.name,a))):this.has_moved=a.distance>b.options.tap_max_distance}},d.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){return b.options.prevent_mouseevents&&a.pointerType==i?void a.stopDetect():(b.options.prevent_default&&a.preventDefault(),void(a.eventType==l&&b.trigger(this.name,a)))}},d.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1,transform_within_instance:!1},triggered:!1,handler:function(a,b){if(u.current.name!=this.name&&this.triggered)return b.trigger(this.name+"end",a),void(this.triggered=!1);if(!(a.touches.length<2)){if(b.options.transform_always_block&&a.preventDefault(),b.options.transform_within_instance)for(var c=-1;a.touches[++c];)if(!o.hasParent(a.touches[c].target,b.element))return;switch(a.eventType){case l:this.triggered=!1;break;case m:var d=Math.abs(1-a.scale),e=Math.abs(a.rotation);if(d<b.options.transform_min_scale&&e<b.options.transform_min_rotation)return;u.current.name=this.name,this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0),b.trigger(this.name,a),e>b.options.transform_min_rotation&&b.trigger("rotate",a),d>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(a.scale<1?"in":"out"),a));break;case n:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}}},"function"==typeof define&&define.amd?define(function(){return d}):"object"==typeof module&&module.exports?module.exports=d:a.Hammer=d}(window);

// document ready helper func, because this is included in the head when utility libraries like jquery are not loaded yet
function contentLoaded(win, fn) {
	var done = false, top = true,
		doc = win.document, root = doc.documentElement,
		add = doc.addEventListener ? 'addEventListener' : 'attachEvent',
		rem = doc.addEventListener ? 'removeEventListener' : 'detachEvent',
		pre = doc.addEventListener ? '' : 'on',
		init = function(e) {
			if (e.type == 'readystatechange' && doc.readyState != 'complete') return;
			(e.type == 'load' ? win : doc)[rem](pre + e.type, init, false);
			if (!done && (done = true)) fn.call(win, e.type || e);
		},
		poll = function() {
			try { root.doScroll('left'); } catch(e) { setTimeout(poll, 50); return; }
			init('poll');
		};
	if (doc.readyState == 'complete') fn.call(win, 'lazy');
	else {
		if (doc.createEventObject && root.doScroll) {
			try { top = !win.frameElement; } catch(e) { }
			if (top) poll();
		}
		doc[add](pre + 'DOMContentLoaded', init, false);
		doc[add](pre + 'readystatechange', init, false);
		win[add](pre + 'load', init, false);
	}
}

contentLoaded(window,function(){

	//if( !window.mediacube )
	//	return;

	var $container = $(window.cubeContainer ? '#'+window.cubeContainer : '#mediacube');
	if( !$container.length )
		return;

	if( (/windows phone/i.test(ua.os.name) && ua.os.version == "7.5")
		|| (/android/i.test(ua.os.name) && (/^2\.3/.test(ua.os.version || /^3\./.test(ua.os.version))) )
		|| (/symbian/i.test(ua.os.name) ) ) {
		performanceProfile.textureMappingQuality = 2;
		// or fallback to swipe carousel, or just return and do nothing
		//$container.text('android 2.3.x or 3.x or wp7.x');
	}

	// if older iphone or ipad reduce quality to get decent rendering
	if( (/iphone/i.test(ua.device.model) || /ipad/i.test(ua.device.model)) && !(window.devicePixelRatio > 1)  ) {
		performanceProfile.textureMappingQuality = 2;
	}

	// save battery by letting browser decide when to draw
	// shim layer with setTimeout fallback
	// http://caniuse.com/#feat=requestanimationframe
	window.requestAnimFrame = (function(){
		return window.requestAnimationFrame		||
			window.webkitRequestAnimationFrame	||
			window.mozRequestAnimationFrame		||
			window.oRequestAnimationFrame		||
			window.msRequestAnimationFrame		||
			function( callback ){
				window.setTimeout(callback,50);
			};
	})();

	var textures;
	THREE.ImageUtils.loadTexture(cubeImages[0],undefined,function(t1){
		THREE.ImageUtils.loadTexture(cubeImages[1],undefined,function(t2){
			THREE.ImageUtils.loadTexture(cubeImages[2],undefined,function(t3){
				THREE.ImageUtils.loadTexture(cubeImages[3],undefined,function(t4){

					// https://github.com/mrdoob/three.js/issues/1440
					// https://github.com/mrdoob/three.js/issues/1200
					// https://github.com/mrdoob/three.js/issues/1338
					t1.wrapS = t2.wrapS = t3.wrapS = t4.wrapS = t1.wrapT = t2.wrapT = t3.wrapT = t4.wrapT = THREE.RepeatWrapping;
					t1.repeat.set(1,1);
					t2.repeat.set(1,1);
					t3.repeat.set(1,1);
					t4.repeat.set(1,1);
					t1.anisotropy = t2.anisotropy = t3.anisotropy = t4.anisotropy = 1;
					textures = [t1,t2,null,null,t4,t3];
					setTimeout(function(){
						init();
						animate();
					});
				});
			});
		});
	});

	var mouseVector = new THREE.Vector3();
	var camera, scene, renderer;
	var cube;
	var omega = 0;

	function init() {

		camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
		camera.position.y = performanceProfile.cameraY;
		camera.position.z = performanceProfile.cameraZ;

		scene = new THREE.Scene();

		// overdraw needed here otherwise seams are drawn on top of textures
		var materials = [
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:false,ambient:0xffffff,map:textures[0]}),
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:false,ambient:0xffffff,map:textures[1]}),
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:true}),
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:true}),
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:false,ambient:0xffffff,map:textures[4]}),
			new THREE.MeshBasicMaterial({overdraw:0.5,wireframe:false,ambient:0xffffff,map:textures[5]})
		];

		// segments affect how well texture is mapped but affects the performace considerably
		var a = performanceProfile.cubeLength, b = performanceProfile.textureMappingQuality;
		cube = new THREE.Mesh(new THREE.CubeGeometry(a,a,a,b,b,b),new THREE.MeshFaceMaterial(materials) );
		cube.dynamic = true;
		cube.position.y = performanceProfile.cubeY;
		scene.add( cube );

		renderer = new THREE.CanvasRenderer();
		renderer.setClearColor(0xfffffe); // background color
		$container.append(renderer.domElement);
		//$(renderer.domElement).attr('touch-action',"none");
		$(window).on('resize orientationchange',resize);
		resize();
	}

	function resize() {
		var cw = $container.width(),ch = $container.height();
		var w = performanceProfile.canvasWidth, h = performanceProfile.canvasWidth;
		if( cw < performanceProfile.canvasWidth ) {
			w = h = cw;
		}
		$container.find('canvas').css({
			"margin-top" : (parseInt(ch - h)/2) + "px",
			"margin-left" : (parseInt(cw - h)/2) + "px"
		});
		camera.aspect = 1;
		camera.updateProjectionMatrix();
		renderer.setSize( w, h );
	}

	// http://www.jacklmoore.com/notes/mouse-position/
	// offsetX and Y are not standard, so calculate'em, x and y on canvas needed to raytrace to the cube face element
	function xy(e) {
		var target = e.target,
			rect = target.getBoundingClientRect(),
			offsetX = e.gesture.center.pageX - rect.left,
			offsetY = e.gesture.center.pageY - rect.top;
		var a = [offsetX, offsetY];
		//console.log(a);
		return a;
	};

	function openLink(url){
		if( /android/i.test(ua.os.name) ) {
			// http://stackoverflow.com/questions/6946162/window-open-mobile-devices-canvas-not-working
			// var options = "dialog=no,width=" + window.innerWidth + ",height=" + window.innerHeight;
			// window.open(cubeLinks[linkIndex],"_system"/*, options*/);
			setTimeout(function(){ window.open(url); },1);
		} else window.open(url);
	}

	var xybefore = null;
	function handleHammer(e) {
		// disable browser scrolling
		e.gesture.preventDefault();

		switch(e.type) {
			case 'dragright':
			case 'dragleft':
				omega = 0;
				//console.log('drag:'+e.gesture.deltaX+","+e.gesture.velocityX);
				//var c = xy(e);
				//console.log("angle between cube center and finger at "+parseInt(c[0])+" is " +parseInt(Math.atan((c[0]-150)/400)* (180/Math.PI) ));
				//cube.rotation.y = (cube.rotation.y%(Math.PI/2)) + Math.atan((c[0]-150)/400);
				var vx, xynow = xy(e);
				if( xybefore ) {
					vx = (xynow[0] - xybefore[0]) > 0 ? e.gesture.velocityX : -e.gesture.velocityX;
				}
				else vx = e.gesture.deltaX > 0 ? e.gesture.velocityX : -e.gesture.velocityX;
				omega += vx/10;
				omega = omega < 0 ? Math.max(-0.1,omega) : Math.min(0.1,omega);
				xybefore = xynow;
				break;
			/*case 'release':
				//console.log('release:'+e.gesture.deltaX+","+e.gesture.velocityX);
				var vx = e.gesture.deltaX > 0 ? e.gesture.velocityX : -e.gesture.velocityX;
				omega = vx/10;
				break;*/
			case 'tap':
				var projector = new THREE.Projector(),
					c = xy(e);
				// calculate normalized device coordinates
				mouseVector.x = (c[0]-150)/150;
				mouseVector.y = (c[1]-150)/150;
				//console.log('touch detected at '+mouseVector.x+','+mouseVector.y);
				var raycaster = projector.pickingRay( mouseVector.clone(), camera ),
					a = raycaster.intersectObjects( scene.children );
				if (a.length > 0) {
					var linkIndex = a[0].face.materialIndex;
					if( linkIndex == 5 ) linkIndex = 2;
					if( linkIndex == 4 ) linkIndex = 3;
					if( linkIndex >= 0 && linkIndex < cubeLinks.length) {
						openLink(cubeLinks[linkIndex]);
					}
					/*
					if( !$('#linkster').length ) {
						$('body').append('<div id="linkster" style="position:absolute; top:20px; left:20px; color:black; background: white;">'+cubeLinks[linkIndex]+'</div>');
					} else {
						$('#linkster').text(cubeLinks[linkIndex]);
					}*/
					//console.log(a[0].object.id + ', '+a[0].faceIndex+', '+a[0].face.materialIndex);
				}
				/*if( !$('#xy').length ) {
					$('body').append('<div id="xy" style="position:absolute; top:40px; left:40px; color:black; background: white;">'+parseInt(c[0])+','+parseInt(c[1])+'</div>');
				} else {
					$('#xy').text(parseInt(c[0])+','+parseInt(c[1]));
				}*/
				break;
		}
	}

	var roundTripDone = false;
	function initEvents() {
		var hammertime = new Hammer(renderer.domElement, { drag_lock_to_axis: true });
		hammertime.on("dragleft dragright tap", handleHammer);
	}

	function animate() {
		if( roundTripDone ) {
			cube.rotation.y += omega;
			if( omega > 0 )
				omega -= 0.001;
			if( omega < 0 )
				omega += 0.001;
			if( Math.abs(omega) <= 0.001 )
				omega = 0;
		} else {
			cube.rotation.y += 0.05;
			if( cube.rotation.y >= (Math.PI*2) ) {
				roundTripDone = true;
				initEvents();
			}
		}
		renderer.render(scene,camera);
		requestAnimFrame(animate);
	}

});

